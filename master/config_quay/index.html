<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" class="chrometwo"><head><title>Configure Red Hat Quay</title><link rel="stylesheet" type="text/css" href="Common_Content/css/default.css"/><meta name="generator" content="publican v4.3.4"/><meta name="description" content="Configure Red Hat Quay"/><link rel="next" href="#config-intro" title="Chapter 1. Getting started with Red Hat Quay configuration"/><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><script type="text/javascript" src="Common_Content/scripts/jquery-1.7.1.min.js"> </script><script type="text/javascript" src="Common_Content/scripts/utils.js"> </script><script type="text/javascript" src="Common_Content/scripts/highlight.js/highlight.pack.js"> </script></head><body><div id="chrometwo"><div id="main"><div xml:lang="en-US" class="book" id="idm45384243712720"><div class="titlepage"><div><div class="producttitle"><span class="productname">Red Hat Quay</span> <span class="productnumber">3.9</span></div><div><h1 class="title">Configure Red Hat Quay</h1></div><div><h2 class="subtitle">Customizing Red Hat Quay using configuration options</h2></div><div><div xml:lang="en-US" class="authorgroup"><span class="orgname">Red Hat OpenShift Documentation Team</span></div></div><div><a href="#idm45384242138000">Legal Notice</a></div><div><div class="abstract"><p class="title"><strong>Abstract</strong></p><div class="para">
				Configure Red Hat Quay
			</div></div></div></div><hr/></div><div class="toc"><ul class="toc"><li><span class="chapter"><a href="#config-intro">1. Getting started with Red Hat Quay configuration</a></span><ul><li><span class="section"><a href="#config-updates-38">1.1. Configuration updates for Quay 3.8</a></span></li><li><span class="section"><a href="#config-updates-37">1.2. Configuration updates for Quay 3.7</a></span><ul><li><span class="section"><a href="#new-configuration-fields-377">1.2.1. New configuration fields for Red Hat Quay 3.7.7</a></span></li><li><span class="section"><a href="#new-configuration-fields-37">1.2.2. New configuration fields</a></span></li></ul></li><li><span class="section"><a href="#config-updates-36">1.3. Configuration updates for Red Hat Quay 3.6</a></span><ul><li><span class="section"><a href="#new-configuration-fields-36">1.3.1. New configuration fields</a></span></li><li><span class="section"><a href="#deprecated-configuration-fields-36">1.3.2. Deprecated configuration fields</a></span></li></ul></li><li><span class="section"><a href="#editing-the-configuration-file">1.4. Editing the configuration file</a></span></li><li><span class="section"><a href="#config-file-location">1.5. Location of configuration file in a standalone deployment</a></span></li><li><span class="section"><a href="#config-file-minimal">1.6. Minimal configuration</a></span><ul><li><span class="section"><a href="#sample-config-file-minimal">1.6.1. Sample minimal configuration file</a></span></li><li><span class="section"><a href="#config-local-storage">1.6.2. Local storage</a></span></li><li><span class="section"><a href="#config-cloud-storage">1.6.3. Cloud storage</a></span></li></ul></li></ul></li><li><span class="chapter"><a href="#config-fields-intro">2. Configuration fields</a></span><ul><li><span class="section"><a href="#config-fields-required-intro">2.1. Required configuration fields</a></span></li><li><span class="section"><a href="#config-preconfigure-automation-intro">2.2. Automation options</a></span></li><li><span class="section"><a href="#config-fields-optional-intro">2.3. Optional configuration fields</a></span></li><li><span class="section"><a href="#config-fields-required-general">2.4. General required fields</a></span></li><li><span class="section"><a href="#config-fields-db">2.5. Database configuration</a></span><ul><li><span class="section"><a href="#database-uri">2.5.1. Database URI</a></span></li><li><span class="section"><a href="#database-connection-arguments">2.5.2. Database connection arguments</a></span></li></ul></li><li><span class="section"><a href="#config-fields-storage">2.6. Image storage</a></span><ul><li><span class="section"><a href="#config-fields-storage-features">2.6.1. Image storage features</a></span></li><li><span class="section"><a href="#config-fields-storage-fields">2.6.2. Image storage configuration fields</a></span></li><li><span class="section"><a href="#config-fields-storage-local">2.6.3. Local storage</a></span></li><li><span class="section"><a href="#config-fields-storage-noobaa">2.6.4. OCS/NooBaa</a></span></li><li><span class="section"><a href="#config-fields-storage-rados">2.6.5. Ceph / RadosGW Storage / Hitachi HCP</a></span></li><li><span class="section"><a href="#config-fields-storage-aws">2.6.6. AWS S3 storage</a></span></li><li><span class="section"><a href="#config-fields-storage-gcp">2.6.7. Google Cloud Storage</a></span></li><li><span class="section"><a href="#config-fields-storage-azure">2.6.8. Azure Storage</a></span></li><li><span class="section"><a href="#config-fields-storage-swift">2.6.9. Swift storage</a></span></li></ul></li><li><span class="section"><a href="#config-fields-redis">2.7. Redis configuration fields</a></span><ul><li><span class="section"><a href="#build_logs">2.7.1. Build logs</a></span></li><li><span class="section"><a href="#user-event-fields-redis">2.7.2. User events</a></span></li><li><span class="section"><a href="#example-redis-configuration">2.7.3. Example Redis configuration</a></span></li></ul></li><li><span class="section"><a href="#config-fields-modelcache">2.8. ModelCache configuration options</a></span><ul><li><span class="section"><a href="#config-fields-modelcache-memcache">2.8.1. Memcache configuration option</a></span></li><li><span class="section"><a href="#config-fields-modelcache-single-redis">2.8.2. Single Redis configuration option</a></span></li><li><span class="section"><a href="#config-fields-modelcache-clustered-redis">2.8.3. Clustered Redis configuration option</a></span></li></ul></li><li><span class="section"><a href="#config-fields-tag-expiration">2.9. Tag expiration configuration fields</a></span><ul><li><span class="section"><a href="#example-config-fields-tag-expiration">2.9.1. Example tag expiration configuration</a></span></li></ul></li><li><span class="section"><a href="#config-preconfigure-automation">2.10. Pre-configuring Red Hat Quay for automation</a></span><ul><li><span class="section"><a href="#allowing-the-api-to-create-first-user">2.10.1. Allowing the API to create the first user</a></span></li><li><span class="section"><a href="#enabling-general-api-access">2.10.2. Enabling general API access</a></span></li><li><span class="section"><a href="#adding-super-user">2.10.3. Adding a superuser</a></span></li><li><span class="section"><a href="#restricting-user-creation">2.10.4. Restricting user creation</a></span></li><li><span class="section"><a href="#enabling-new-functionality-38">2.10.5. Enabling new functionality</a></span></li><li><span class="section"><a href="#enabling-new-functionality-37">2.10.6. Enabling new functionality</a></span></li><li><span class="section"><a href="#suggested-configuration-for-automation">2.10.7. Suggested configuration for automation</a></span></li><li><span class="section"><a href="#deploying-the-operator-using-initial-configuration">2.10.8. Deploying the Red Hat Quay Operator using the initial configuration</a></span></li><li><span class="section"><a href="#deploy-quay-api">2.10.9. Using the API to deploy Red Hat Quay</a></span></li></ul></li><li><span class="section"><a href="#config-fields-basic">2.11. Basic configuration fields</a></span></li><li><span class="section"><a href="#config-fields-ssl">2.12. SSL configuration fields</a></span><ul><li><span class="section"><a href="#configuring_ssl">2.12.1. Configuring SSL</a></span></li></ul></li><li><span class="section"><a href="#config-custom-ssl-certs-manual">2.13. Adding TLS Certificates to the Red Hat Quay Container</a></span><ul><li><span class="section"><a href="#add-certificates-to-quay-container">2.13.1. Add TLS certificates to Red Hat Quay</a></span></li></ul></li><li><span class="section"><a href="#config-fields-ldap">2.14. LDAP configuration fields</a></span><ul><li><span class="section"><a href="#ldap-config-field-reference">2.14.1. LDAP configuration field references</a></span></li></ul></li><li><span class="section"><a href="#config-fields-mirroring">2.15. Mirroring configuration fields</a></span></li><li><span class="section"><a href="#config-fields-scanner">2.16. Security scanner configuration fields</a></span></li><li><span class="section"><a href="#config-fields-helm-oci">2.17. OCI and Helm configuration fields</a></span></li><li><span class="section"><a href="#config-fields-actionlog">2.18. Action log configuration fields</a></span><ul><li><span class="section"><a href="#action_log_storage_configuration">2.18.1. Action log storage configuration</a></span></li><li><span class="section"><a href="#action_log_rotation_and_archiving_configuration">2.18.2. Action log rotation and archiving configuration</a></span></li></ul></li><li><span class="section"><a href="#config-fields-build-logs">2.19. Build logs configuration fields</a></span></li><li><span class="section"><a href="#config-fields-dockerfile-build">2.20. Dockerfile build triggers fields</a></span><ul><li><span class="section"><a href="#github_build_triggers">2.20.1. GitHub build triggers</a></span></li><li><span class="section"><a href="#bitbucket_build_triggers">2.20.2. BitBucket build triggers</a></span></li><li><span class="section"><a href="#gitlab_build_triggers">2.20.3. GitLab build triggers</a></span></li></ul></li><li><span class="section"><a href="#config-fields-oauth">2.21. OAuth configuration fields</a></span><ul><li><span class="section"><a href="#github_oauth_configuration_fields">2.21.1. GitHub OAuth configuration fields</a></span></li><li><span class="section"><a href="#google_oauth_configuration_fields">2.21.2. Google OAuth configuration fields</a></span></li></ul></li><li><span class="section"><a href="#config-fields-nested-repositories">2.22. Nested repositories configuration fields</a></span></li><li><span class="section"><a href="#other-oci-artifacts-with-quay">2.23. Adding other OCI media types to Quay</a></span></li><li><span class="section"><a href="#config-fields-mail">2.24. Mail configuration fields</a></span></li><li><span class="section"><a href="#config-fields-user">2.25. User configuration fields</a></span><ul><li><span class="section"><a href="#user-config-field-reference">2.25.1. User configuration fields references</a></span></li></ul></li><li><span class="section"><a href="#config-fields-recaptcha">2.26. Recaptcha configuration fields</a></span></li><li><span class="section"><a href="#config-fields-aci">2.27. ACI configuration fields</a></span></li><li><span class="section"><a href="#config-fields-jwt">2.28. JWT configuration fields</a></span></li><li><span class="section"><a href="#config-fields-app-tokens">2.29. App tokens configuration fields</a></span></li><li><span class="section"><a href="#config-fields-misc">2.30. Miscellaneous configuration fields</a></span><ul><li><span class="section"><a href="#miscellaneous-config-field-reference">2.30.1. Miscellaneous configuration field references</a></span></li></ul></li><li><span class="section"><a href="#config-fields-legacy">2.31. Legacy configuration fields</a></span></li><li><span class="section"><a href="#config-fields-v2-ui">2.32. User interface v2 configuration field</a></span></li><li><span class="section"><a href="#config-fields-ipv6">2.33. IPv6 configuration field</a></span></li><li><span class="section"><a href="#config-fields-branding">2.34. Branding configuration fields</a></span><ul><li><span class="section"><a href="#example-config-fields-branding">2.34.1. Example configuration for Red Hat Quay branding</a></span></li></ul></li></ul></li><li><span class="chapter"><a href="#config-envar-intro">3. Environment variables</a></span><ul><li><span class="section"><a href="#config-envvar-georepl">3.1. Geo-replication</a></span></li><li><span class="section"><a href="#config-envvar-dbpool">3.2. Database connection pooling</a></span></li><li><span class="section"><a href="#config-envvar-worker-connection">3.3. HTTP connection counts</a></span></li><li><span class="section"><a href="#config-envvar-worker-count">3.4. Worker count variables</a></span></li></ul></li><li><span class="chapter"><a href="#operator-config-ui">4. Using the config tool to reconfigure Quay on OpenShift</a></span><ul><li><span class="section"><a href="#operator-config-ui-access">4.1. Accessing the config editor</a></span><ul><li><span class="section"><a href="#retrieving_the_config_editor_credentials">4.1.1. Retrieving the config editor credentials</a></span></li><li><span class="section"><a href="#logging_in_to_the_config_editor">4.1.2. Logging in to the config editor</a></span></li><li><span class="section"><a href="#operator-config-ui-change">4.1.3. Changing configuration</a></span></li></ul></li><li><span class="section"><a href="#operator-config-ui-monitoring">4.2. Monitoring reconfiguration in the UI</a></span><ul><li><span class="section"><a href="#quayregistry_resource">4.2.1. QuayRegistry resource</a></span></li><li><span class="section"><a href="#events">4.2.2. Events</a></span></li></ul></li><li><span class="section"><a href="#operator-config-ui-updated">4.3. Accessing updated information after reconfiguration</a></span><ul><li><span class="section"><a href="#accessing_the_updated_config_tool_credentials_in_the_ui">4.3.1. Accessing the updated config tool credentials in the UI</a></span></li><li><span class="section"><a href="#accessing_the_updated_config_yaml_in_the_ui">4.3.2. Accessing the updated config.yaml in the UI</a></span></li></ul></li></ul></li><li><span class="chapter"><a href="#operator-components-intro">5. Quay Operator components</a></span><ul><li><span class="section"><a href="#operator-components-managed">5.1. Using managed components</a></span></li><li><span class="section"><a href="#operator-components-unmanaged">5.2. Using unmanaged components for dependencies</a></span><ul><li><span class="section"><a href="#operator-unmanaged-postgres">5.2.1. Using an existing Postgres database</a></span></li><li><span class="section"><a href="#operator-unmanaged-storage-noobaa">5.2.2. NooBaa unmanaged storage</a></span></li><li><span class="section"><a href="#operator-unmanaged-hpa">5.2.3. Disabling the Horizontal Pod Autoscaler</a></span></li></ul></li><li><span class="section"><a href="#config-custom-ssl-cert-kubernetes">5.3. Add certs when deployed on Kubernetes</a></span></li><li><span class="section"><a href="#operator-helm-oci">5.4. Configuring OCI and Helm with the Operator</a></span></li><li><span class="section"><a href="#operator-volume-size-overrides">5.5. Volume size overrides</a></span></li></ul></li><li><span class="chapter"><a href="#clair-vulnerability-scanner">6. Clair for Red Hat Quay</a></span><ul><li><span class="section"><a href="#config-fields-overview">6.1. Clair configuration overview</a></span><ul><li><span class="section"><a href="#config-fields-clair-reference">6.1.1. Clair configuration reference</a></span></li><li><span class="section"><a href="#config-fields-required-clair">6.1.2. Clair general fields</a></span></li><li><span class="section"><a href="#config-fields-clair-indexer">6.1.3. Clair indexer configuration fields</a></span></li><li><span class="section"><a href="#config-fields-clair-matcher">6.1.4. Clair matcher configuration fields</a></span></li><li><span class="section"><a href="#config-fields-clair-matchers">6.1.5. Clair matchers configuration fields</a></span></li><li><span class="section"><a href="#config-fields-clair-updaters">6.1.6. Clair updaters configuration fields</a></span></li><li><span class="section"><a href="#config-fields-clair-notifiers">6.1.7. Clair notifier configuration fields</a></span></li><li><span class="section"><a href="#config-fields-clair-auth">6.1.8. Clair authorization configuration fields</a></span></li><li><span class="section"><a href="#config-fields-clair-trace">6.1.9. Clair trace configuration fields</a></span></li><li><span class="section"><a href="#config-fields-clair-metrics">6.1.10. Clair metrics configuration fields</a></span></li></ul></li></ul></li><li><span class="chapter"><a href="#container-security-operator-setup">7. Scanning pod images with the Container Security Operator</a></span><ul><li><span class="section"><a href="#running-cso-openshift">7.1. Downloading and running the Container Security Operator in OpenShift Container Platform</a></span></li><li><span class="section"><a href="#query_image_vulnerabilities_from_the_cli">7.2. Query image vulnerabilities from the CLI</a></span></li></ul></li></ul></div><section class="chapter" id="config-intro"><div class="titlepage"><div><div><h1 class="title">Chapter 1. Getting started with Red Hat Quay configuration</h1></div></div></div><p>
			Red Hat Quay can be deployed by an independent, standalone configuration, or by using the OpenShift Container Platform Red Hat Quay Operator.
		</p><p>
			How you create, retrieve, update, and validate the Red Hat Quay configuration varies depending on the type of deployment you are using. However, the core configuration options are the same for either deployment type. Core configuration can be set by one of the following options:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					Directly, by editing the <code class="literal">config.yaml</code> file. See "Editing the configuration file" for more information.
				</li><li class="listitem">
					Programmatically, by using the configuration API. See "Using the configuration API" for more information.
				</li><li class="listitem">
					Visually, by using the configuration tool UI. See "Using the configuration tool" for more information.
				</li></ul></div><p>
			For standalone deployments of Red Hat Quay, you must supply the minimum required configuration parameters before the registry can be started. The minimum requirements to start a Red Hat Quay registry can be found in the "Retrieving the current configuration" section.
		</p><p>
			If you install Red Hat Quay on OpenShift Container Platform using the Red Hat Quay Operator, you do not need to supply configuration parameters because the Red Hat Quay Operator supplies default information to deploy the registry.
		</p><p>
			After you have deployed Red Hat Quay with the desired configuration, you should retrieve, and save, the full configuration from your deployment. The full configuration contains additional generated values that you might need when restarting or upgrading your system.
		</p><section class="section" id="config-updates-38"><div class="titlepage"><div><div><h2 class="title">1.1. Configuration updates for Quay 3.8</h2></div></div></div><p>
				The following configuration fields have been introduced with Red Hat Quay 3.8:
			</p><div class="table" id="idm45384250771200"><p class="title"><strong>Table 1.1. Red Hat Quay 3.8 configuration fields</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 40%; " class="col_1"/><col style="width: 20%; " class="col_2"/><col style="width: 40%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45384251351856" scope="col">Field</th><th align="left" valign="top" id="idm45384250203024" scope="col">Type</th><th align="left" valign="top" id="idm45384250201936" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45384251351856">
							<p>
								<a class="link" href="#reference-miscellaneous-v2-ui" title="2.30.1.1. v2 user interface configuration"><span class="strong strong"><strong>FEATURE_UI_V2</strong></span></a>
							</p>
							</td><td align="left" valign="top" headers="idm45384250203024">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45384250201936">
							<p>
								When set, allows users to try the beta UI environment.
							</p>
							<p>
								<span class="strong strong"><strong>Default:</strong></span> <code class="literal">False</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384251351856">
							<p>
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_quay/3.8/html-single/manage_red_hat_quay/index#proc_manage-ipv6-dual-stack"><span class="strong strong"><strong>FEATURE_LISTEN_IP_VERSION</strong></span></a>
							</p>
							</td><td align="left" valign="top" headers="idm45384250203024">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384250201936">
							<p>
								Enables IPv4, IPv6, or dual-stack protocol family. This configuration field must be properly set, otherwise Red Hat Quay fails to start.
							</p>
							<p>
								<span class="strong strong"><strong>Default:</strong></span> <code class="literal">IPv4</code>
							</p>
							<p>
								<span class="strong strong"><strong>Additional configurations:</strong></span> <code class="literal">IPv6</code>, <code class="literal">dual-stack</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384251351856">
							<p>
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_quay/3.8/html-single/manage_red_hat_quay/index#ldap-super-users-enabling"><span class="strong strong"><strong>LDAP_SUPERUSER_FILTER</strong></span></a>
							</p>
							</td><td align="left" valign="top" headers="idm45384250203024">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384250201936">
							<p>
								Subset of the <code class="literal">LDAP_USER_FILTER</code> configuration field. When configured, allows Red Hat Quay administrators the ability to configure Lightweight Directory Access Protocol (LDAP) users as superusers when Red Hat Quay uses LDAP as its authentication provider.
							</p>
							<p>
								With this field, administrators can add or remove superusers without having to update the Red Hat Quay configuration file and restart their deployment.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384251351856">
							<p>
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_quay/3.8/html-single/manage_red_hat_quay/index#ldap-restricted-users-enabling"><span class="strong strong"><strong>LDAP_RESTRICTED_USER_FILTER</strong></span></a>
							</p>
							</td><td align="left" valign="top" headers="idm45384250203024">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384250201936">
							<p>
								Subset of the <code class="literal">LDAP_USER_FILTER</code> configuration field. When configured, allows Red Hat Quay administrators the ability to configure Lightweight Directory Access Protocol (LDAP) users as restricted users when Red Hat Quay uses LDAP as its authentication provider.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384251351856">
							<p>
								<a class="link" href="#configuring-superusers-full-access" title="2.25.1.1. FEATURE_SUPERUSERS_FULL_ACCESS configuration reference"><span class="strong strong"><strong>FEATURE_SUPERUSERS_FULL_ACCESS</strong></span></a>
							</p>
							</td><td align="left" valign="top" headers="idm45384250203024">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45384250201936">
							<p>
								Grants superusers the ability to read, write, and delete content from other repositories in namespaces that they do not own or have explicit permissions for.
							</p>
							<p>
								<span class="strong strong"><strong>Default:</strong></span> <code class="literal">False</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384251351856">
							<p>
								<a class="link" href="#configuring-global-readonly-super-users" title="2.25.1.2. GLOBAL_READONLY_SUPER_USERS configuration reference"><span class="strong strong"><strong>GLOBAL_READONLY_SUPER_USERS</strong></span></a>
							</p>
							</td><td align="left" valign="top" headers="idm45384250203024">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384250201936">
							<p>
								When set, grants users of this list read access to all repositories, regardless of whether they are public repositories.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384251351856">
							<p>
								<a class="link" href="#configuring-feature-restricted-users" title="2.25.1.3. FEATURE_RESTRICTED_USERS configuration reference"><span class="strong strong"><strong>FEATURE_RESTRICTED_USERS</strong></span></a>
							</p>
							</td><td align="left" valign="top" headers="idm45384250203024">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45384250201936">
							<p>
								When set with <code class="literal">RESTRICTED_USERS_WHITELIST</code>, restricted users cannot create organizations or content in their own namespace. Normal permissions apply for an organization’s membership, for example, a restricted user will still have normal permissions in organizations based on the teams that they are members of.
							</p>
							<p>
								<span class="strong strong"><strong>Default:</strong></span> <code class="literal">False</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384251351856">
							<p>
								<a class="link" href="#configuring-restricted-users-whitelist" title="2.25.1.4. RESTRICTED_USERS_WHITELIST configuration reference"><span class="strong strong"><strong>RESTRICTED_USERS_WHITELIST</strong></span></a>
							</p>
							</td><td align="left" valign="top" headers="idm45384250203024">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384250201936">
							<p>
								When set with <code class="literal">FEATURE_RESTRICTED_USERS: true</code>, specific users are excluded from the <code class="literal">FEATURE_RESTRICTED_USERS</code> setting.
							</p>
							</td></tr></tbody></table></div></div></section><section class="section" id="config-updates-37"><div class="titlepage"><div><div><h2 class="title">1.2. Configuration updates for Quay 3.7</h2></div></div></div><section class="section" id="new-configuration-fields-377"><div class="titlepage"><div><div><h3 class="title">1.2.1. New configuration fields for Red Hat Quay 3.7.7</h3></div></div></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"/><col style="width: 33%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45384251784864" scope="col">Field</th><th align="left" valign="top" id="idm45384251783776" scope="col">Type</th><th align="left" valign="top" id="idm45384251782688" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45384251784864">
								<p>
									<span class="strong strong"><strong>REPO_MIRROR_ROLLBACK</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384251783776">
								<p>
									Boolean
								</p>
								</td><td align="left" valign="top" headers="idm45384251782688">
								<p>
									When set to <code class="literal">true</code>, the repository rolls back after a failed mirror attempt.
								</p>
								<p>
									<span class="strong strong"><strong>Default</strong></span>: <code class="literal">false</code>
								</p>
								</td></tr></tbody></table></div></section><section class="section" id="new-configuration-fields-37"><div class="titlepage"><div><div><h3 class="title">1.2.2. New configuration fields</h3></div></div></div><p>
					The following configuration fields have been introduced with Red Hat Quay 3.7:
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 50%; " class="col_2"/></colgroup><thead><tr><th align="left" valign="top" id="idm45384249639120" scope="col">Parameter</th><th align="left" valign="top" id="idm45384249638032" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45384249639120">
								<p>
									<span class="strong strong"><strong>FEATURE_QUOTA_MANAGEMENT</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384249638032">
								<p>
									Quota management is now supported. With this feature, users have the ability to report storage consumption and to contain registry growth by establishing configured storage quota limits. For more information about quota management, see <a class="link" href="https://access.redhat.com//documentation/en-us/red_hat_quay/3.7/html-single/use_red_hat_quay#red-hat-quay-quota-management-and-enforcement">Red Hat Quay Quota management and enforcement</a>.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384249639120">
								<p>
									<span class="strong strong"><strong>DEFAULT_SYSTEM_REJECT_QUOTA_BYTES</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384249638032">
								<p>
									The quota size to apply to all organizations and users. For more information about quota management, see <a class="link" href="https://access.redhat.com//documentation/en-us/red_hat_quay/3.7/html-single/use_red_hat_quay#red-hat-quay-quota-management-and-enforcement">Red Hat Quay Quota management and enforcement</a>.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384249639120">
								<p>
									<span class="strong strong"><strong>FEATURE_PROXY_CACHE</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384249638032">
								<p>
									Using Red Hat Quay to proxy a remote organization is now supported. With this feature, Red Hat Quay will act as a proxy cache to circumvent pull-rate limitations from upstream registries. For more information about quota management, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_quay/3.7/html-single/use_red_hat_quay#quay-as-cache-proxy">Red Hat Quay as proxy cache for upstream registries</a>.
								</p>
								</td></tr></tbody></table></div></section></section><section class="section" id="config-updates-36"><div class="titlepage"><div><div><h2 class="title">1.3. Configuration updates for Red Hat Quay 3.6</h2></div></div></div><section class="section" id="new-configuration-fields-36"><div class="titlepage"><div><div><h3 class="title">1.3.1. New configuration fields</h3></div></div></div><p>
					The following configuration fields have been introduced with Red Hat Quay 3.6:
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 50%; " class="col_2"/></colgroup><thead><tr><th align="left" valign="top" id="idm45384254024688" scope="col">Parameter</th><th align="left" valign="top" id="idm45384244602448" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45384254024688">
								<p>
									<span class="strong strong"><strong>FEATURE_EXTENDED_REPOSITORY_NAMES</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384244602448">
								<p>
									Support for nested repositories and extended repository names has been added. This change allows the use of <code class="literal">/</code> in repository names needed for certain OpenShift Container Platform use cases. For more information, see <a class="link" href="#config-fields-nested-repositories" title="2.22. Nested repositories configuration fields">Configuring nested repositories</a>.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384254024688">
								<p>
									<span class="strong strong"><strong>FEATURE_USER_INITIALIZE</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384244602448">
								<p>
									If set to true, the first <code class="literal">User</code> account can be created by the API <code class="literal">/api/v1/user/initialize</code>. For more information, see <a class="link" href="#config-preconfigure-automation" title="2.10. Pre-configuring Red Hat Quay for automation">Pre-configuring Red Hat Quay for automation</a>.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384254024688">
								<p>
									<span class="strong strong"><strong>ALLOWED_OCI_ARTIFACT_TYPES</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384244602448">
								<p>
									Helm, cosign, and ztsd compression scheme artifacts are built into Red Hat Quay 3.6 by default. For any other Open Container Initiative (OCI) media types that are not supported by default, you can add them to the <code class="literal">ALLOWED_OCI_ARTIFACT_TYPES</code> configuration in Quay’s <code class="literal">config.yaml</code> For more information, see <a class="link" href="#other-oci-artifacts-with-quay" title="2.23. Adding other OCI media types to Quay">Adding other OCI media types to Quay</a>.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384254024688">
								<p>
									<span class="strong strong"><strong>CREATE_PRIVATE_REPO_ON_PUSH</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384244602448">
								<p>
									Registry users now have the option to set <code class="literal">CREATE_PRIVATE_REPO_ON_PUSH</code> in their <code class="literal">config.yaml</code> to <code class="literal">True</code> or <code class="literal">False</code> depending on their security needs.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384254024688">
								<p>
									<span class="strong strong"><strong>CREATE_NAMESPACE_ON_PUSH</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384244602448">
								<p>
									Pushing to a non-existent organization can now be configured to automatically create the organization.
								</p>
								</td></tr></tbody></table></div></section><section class="section" id="deprecated-configuration-fields-36"><div class="titlepage"><div><div><h3 class="title">1.3.2. Deprecated configuration fields</h3></div></div></div><p>
					The following configuration fields have been deprecated with Red Hat Quay 3.6:
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 50%; " class="col_2"/></colgroup><thead><tr><th align="left" valign="top" id="idm45384251010336" scope="col">Parameter</th><th align="left" valign="top" id="idm45384251009248" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45384251010336">
								<p>
									<span class="strong strong"><strong>FEATURE_HELM_OCI_SUPPORT</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384251009248">
								<p>
									This option has been deprecated and will be removed in a future version of Red Hat Quay. In Red Hat Quay 3.6, Helm artifacts are supported by default and included under the <code class="literal">FEATURE_GENERAL_OCI_SUPPORT</code> property. Users are no longer required to update their <code class="literal">config.yaml</code> files to enable support.
								</p>
								</td></tr></tbody></table></div></section></section><section class="section" id="editing-the-configuration-file"><div class="titlepage"><div><div><h2 class="title">1.4. Editing the configuration file</h2></div></div></div><p>
				To deploy a standalone instance of Red Hat Quay, you must provide the minimal configuration information. The requirements for a minimal configuration can be found in "Red Hat Quay minimal configuration."
			</p><p>
				After supplying the required fields, you can validate your configuration. If there are any issues, they will be highlighted.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					It is possible to use the configuration API to validate the configuration, but this requires starting the Quay container in configuration mode. For more information, see "Using the configuration tool."
				</p></div></div><p>
				For changes to take effect, the registry must be restarted.
			</p></section><section class="section" id="config-file-location"><div class="titlepage"><div><div><h2 class="title">1.5. Location of configuration file in a standalone deployment</h2></div></div></div><p>
				For standalone deployments of Red Hat Quay, the <code class="literal">config.yaml</code> file must be specified when starting the Red Hat Quay registry. This file is located in the configuration volume. For example, the configuration file is located at <code class="literal">$QUAY/config/config.yaml</code> when deploying Red Hat Quay by the following command:
			</p><pre class="screen">$ sudo podman run -d --rm -p 80:8080 -p 443:8443 \
   --name=quay \
   -v $QUAY/config:/conf/stack:Z \
   -v $QUAY/storage:/datastorage:Z \
   registry.redhat.io/quay/quay-rhel8:v3.9.0</pre></section><section class="section" id="config-file-minimal"><div class="titlepage"><div><div><h2 class="title">1.6. Minimal configuration</h2></div></div></div><p>
				The following configuration options are required for a standalone deployment of Red Hat Quay:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Server hostname
					</li><li class="listitem">
						HTTP or HTTPS
					</li><li class="listitem">
						Authentication type, for example, Database or Lightweight Directory Access Protocol (LDAP)
					</li><li class="listitem">
						Secret keys for encrypting data
					</li><li class="listitem">
						Storage for images
					</li><li class="listitem">
						Database for metadata
					</li><li class="listitem">
						Redis for build logs and user events
					</li><li class="listitem">
						Tag expiration options
					</li></ul></div><section class="section" id="sample-config-file-minimal"><div class="titlepage"><div><div><h3 class="title">1.6.1. Sample minimal configuration file</h3></div></div></div><p>
					The following example shows a sample minimal configuration file that uses local storage for images:
				</p><pre class="programlisting language-yaml">AUTHENTICATION_TYPE: Database
BUILDLOGS_REDIS:
    host: quay-server.example.com
    password: strongpassword
    port: 6379
    ssl: false
DATABASE_SECRET_KEY: 0ce4f796-c295-415b-bf9d-b315114704b8
DB_URI: postgresql://quayuser:quaypass@quay-server.example.com:5432/quay
DEFAULT_TAG_EXPIRATION: 2w
DISTRIBUTED_STORAGE_CONFIG:
    default:
        - LocalStorage
        - storage_path: /datastorage/registry
DISTRIBUTED_STORAGE_DEFAULT_LOCATIONS: []
DISTRIBUTED_STORAGE_PREFERENCE:
    - default
PREFERRED_URL_SCHEME: http
SECRET_KEY: e8f9fe68-1f84-48a8-a05f-02d72e6eccba
SERVER_HOSTNAME: quay-server.example.com
SETUP_COMPLETE: true
TAG_EXPIRATION_OPTIONS:
    - 0s
    - 1d
    - 1w
    - 2w
    - 4w
USER_EVENTS_REDIS:
    host: quay-server.example.com
    port: 6379
    ssl: false</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						The <code class="literal">SETUP_COMPLETE</code> field indicates that the configuration has been validated. You should use the configuration editor tool to validate your configuration before starting the registry.
					</p></div></div></section><section class="section" id="config-local-storage"><div class="titlepage"><div><div><h3 class="title">1.6.2. Local storage</h3></div></div></div><p>
					Using local storage for images is only recommended when deploying a registry for proof of concept purposes.
				</p><p>
					When configuring local storage, storage is specified on the command line when starting the registry. The following command maps a local directory, <code class="literal">$QUAY/storage</code> to the <code class="literal">datastorage</code> path in the container:
				</p><pre class="screen">$ sudo podman run -d --rm -p 80:8080 -p 443:8443 \
   --name=quay \
   -v $QUAY/config:/conf/stack:Z \
   -v $QUAY/storage:/datastorage:Z \
   registry.redhat.io/quay/quay-rhel8:v3.9.0</pre></section><section class="section" id="config-cloud-storage"><div class="titlepage"><div><div><h3 class="title">1.6.3. Cloud storage</h3></div></div></div><p>
					Storage configuration is detailed in the <a class="link" href="#config-fields-storage" title="2.6. Image storage">Image storage</a> section. For some users, it might be useful to compare the difference between Google Cloud Platform and local storage configurations. For example, the following YAML presents a Google Cloud Platform storage configuration:
				</p><div class="formalpara"><p class="title"><strong>$QUAY/config/config.yaml</strong></p><p>
						
<pre class="programlisting language-yaml">DISTRIBUTED_STORAGE_CONFIG:
    default:
        - GoogleCloudStorage
        - access_key: GOOGQIMFB3ABCDEFGHIJKLMN
          bucket_name: quay_bucket
          secret_key: FhDAYe2HeuAKfvZCAGyOioNaaRABCDEFGHIJKLMN
          storage_path: /datastorage/registry
DISTRIBUTED_STORAGE_DEFAULT_LOCATIONS: []
DISTRIBUTED_STORAGE_PREFERENCE:
    - default</pre>
					</p></div><p>
					When starting the registry using cloud storage, no configuration is required on the command line. For example:
				</p><pre class="screen">$ sudo podman run -d --rm -p 80:8080 -p 443:8443 \
   --name=quay \
   -v $QUAY/config:/conf/stack:Z \
   registry.redhat.io/quay/quay-rhel8:v3.9.0</pre></section></section></section><section class="chapter" id="config-fields-intro"><div class="titlepage"><div><div><h1 class="title">Chapter 2. Configuration fields</h1></div></div></div><p>
			This section describes the both required and optional configuration fields when deploying Red Hat Quay.
		</p><section class="section" id="config-fields-required-intro"><div class="titlepage"><div><div><h2 class="title">2.1. Required configuration fields</h2></div></div></div><p>
				The fields required to configure Red Hat Quay are covered in the following sections:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#config-fields-required-general" title="2.4. General required fields">General required fields</a>
					</li><li class="listitem">
						<a class="link" href="#config-fields-redis" title="2.7. Redis configuration fields">Storage for images</a>
					</li><li class="listitem">
						<a class="link" href="#config-fields-db" title="2.5. Database configuration">Database for metadata</a>
					</li><li class="listitem">
						<a class="link" href="#config-fields-redis" title="2.7. Redis configuration fields">Redis for build logs and user events</a>
					</li><li class="listitem">
						<a class="link" href="#config-fields-tag-expiration" title="2.9. Tag expiration configuration fields">Tag expiration options</a>
					</li></ul></div></section><section class="section" id="config-preconfigure-automation-intro"><div class="titlepage"><div><div><h2 class="title">2.2. Automation options</h2></div></div></div><p>
				The following sections describe the available automation options for Red Hat Quay deployments:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#config-preconfigure-automation" title="2.10. Pre-configuring Red Hat Quay for automation">Pre-configuring Red Hat Quay for automation</a>
					</li><li class="listitem">
						<a class="link" href="#using-the-api-to-create-first-user" title="2.10.9.1. Using the API to create the first user">Using the API to create the first user</a>
					</li></ul></div></section><section class="section" id="config-fields-optional-intro"><div class="titlepage"><div><div><h2 class="title">2.3. Optional configuration fields</h2></div></div></div><p>
				Optional fields for Red Hat Quay can be found in the following sections:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#config-fields-basic" title="2.11. Basic configuration fields">Basic configuration</a>
					</li><li class="listitem">
						<a class="link" href="#config-fields-ssl" title="2.12. SSL configuration fields">SSL</a>
					</li><li class="listitem">
						<a class="link" href="#config-fields-ldap" title="2.14. LDAP configuration fields">LDAP</a>
					</li><li class="listitem">
						<a class="link" href="#config-fields-mirroring" title="2.15. Mirroring configuration fields">Repository mirroring</a>
					</li><li class="listitem">
						<a class="link" href="#config-fields-scanner" title="2.16. Security scanner configuration fields">Security scanner</a>
					</li><li class="listitem">
						<a class="link" href="#config-fields-helm-oci" title="2.17. OCI and Helm configuration fields">OCI and Helm</a>
					</li><li class="listitem">
						<a class="link" href="#config-fields-actionlog" title="2.18. Action log configuration fields">Action log</a>
					</li><li class="listitem">
						<a class="link" href="#config-fields-build-logs" title="2.19. Build logs configuration fields">Build logs</a>
					</li><li class="listitem">
						<a class="link" href="#config-fields-dockerfile-build" title="2.20. Dockerfile build triggers fields">Dockerfile build</a>
					</li><li class="listitem">
						<a class="link" href="#config-fields-oauth" title="2.21. OAuth configuration fields">OAuth</a>
					</li><li class="listitem">
						<a class="link" href="#config-fields-nested-repositories" title="2.22. Nested repositories configuration fields">Configuring nested repositories</a>
					</li><li class="listitem">
						<a class="link" href="#other-oci-artifacts-with-quay" title="2.23. Adding other OCI media types to Quay">Adding other OCI media types to Quay</a>
					</li><li class="listitem">
						<a class="link" href="#config-fields-mail" title="2.24. Mail configuration fields">Mail</a>
					</li><li class="listitem">
						<a class="link" href="#config-fields-user" title="2.25. User configuration fields">User</a>
					</li><li class="listitem">
						<a class="link" href="#config-fields-recaptcha" title="2.26. Recaptcha configuration fields">Recaptcha</a>
					</li><li class="listitem">
						<a class="link" href="#config-fields-aci" title="2.27. ACI configuration fields">ACI</a>
					</li><li class="listitem">
						<a class="link" href="#config-fields-jwt" title="2.28. JWT configuration fields">JWT</a>
					</li><li class="listitem">
						<a class="link" href="#config-fields-app-tokens" title="2.29. App tokens configuration fields">App tokens</a>
					</li><li class="listitem">
						<a class="link" href="#config-fields-misc" title="2.30. Miscellaneous configuration fields">Miscellaneous</a>
					</li><li class="listitem">
						<a class="link" href="#config-fields-legacy" title="2.31. Legacy configuration fields">Legacy options</a>
					</li><li class="listitem">
						<a class="link" href="#config-fields-v2-ui" title="2.32. User interface v2 configuration field">User interface v2</a>
					</li><li class="listitem">
						<a class="link" href="#config-fields-ipv6" title="2.33. IPv6 configuration field">IPv6 configuration field</a>
					</li></ul></div></section><section class="section" id="config-fields-required-general"><div class="titlepage"><div><div><h2 class="title">2.4. General required fields</h2></div></div></div><p>
				The following table describes the required configuration fields for a Red Hat Quay deployment:
			</p><div class="table" id="idm45384252122512"><p class="title"><strong>Table 2.1. General required fields</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45384250732864" scope="col">Field</th><th align="left" valign="top" id="idm45384250731776" scope="col">Type</th><th align="left" valign="top" id="idm45384250730688" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45384250732864">
							<p>
								<span class="strong strong"><strong>AUTHENTICATION_TYPE</strong></span><br/> (Required)
							</p>
							</td><td align="left" valign="top" headers="idm45384250731776">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384250730688">
							<p>
								The authentication engine to use for credential authentication.<br/><br/><span class="strong strong"><strong>Values:</strong></span><br/> One of <code class="literal">Database</code>, <code class="literal">LDAP</code>, <code class="literal">JWT</code>, <code class="literal">Keystone</code>, <code class="literal">OIDC</code><br/><br/><span class="strong strong"><strong>Default:</strong></span> <code class="literal">Database</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384250732864">
							<p>
								<span class="strong strong"><strong>PREFERRED_URL_SCHEME</strong></span><br/> (Required)
							</p>
							</td><td align="left" valign="top" headers="idm45384250731776">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384250730688">
							<p>
								The URL scheme to use when accessing Red Hat Quay.<br/><br/><span class="strong strong"><strong>Values:</strong></span><br/> One of <code class="literal">http</code>, <code class="literal">https</code><br/><br/><span class="strong strong"><strong>Default:</strong></span> <code class="literal">http</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384250732864">
							<p>
								<span class="strong strong"><strong>SERVER_HOSTNAME</strong></span> <br/> (Required)
							</p>
							</td><td align="left" valign="top" headers="idm45384250731776">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384250730688">
							<p>
								The URL at which Red Hat Quay is accessible, without the scheme.<br/><br/><span class="strong strong"><strong>Example:</strong></span><br/><code class="literal">quay-server.example.com</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384250732864">
							<p>
								<span class="strong strong"><strong>DATABASE_SECRET_KEY</strong></span> <br/> (Required)
							</p>
							</td><td align="left" valign="top" headers="idm45384250731776">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384250730688">
							<p>
								Key used to encrypt sensitive fields within the database. This value should never be changed once set, otherwise all reliant fields, for example, repository mirror username and password configurations, are invalidated.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384250732864">
							<p>
								<span class="strong strong"><strong>SECRET_KEY</strong></span><br/> (Required)
							</p>
							</td><td align="left" valign="top" headers="idm45384250731776">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384250730688">
							<p>
								Key used to encrypt sensitive fields within the database and at run time. This value should never be changed once set, otherwise all reliant fields, for example, encrypted password credentials, are invalidated.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384250732864">
							<p>
								<span class="strong strong"><strong>SETUP_COMPLETE</strong></span> <br/> (Required)
							</p>
							</td><td align="left" valign="top" headers="idm45384250731776">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45384250730688">
							<p>
								This is an artefact left over from earlier versions of the software and currently it <span class="strong strong"><strong>must</strong></span> be specified with a value of <code class="literal">true</code>.
							</p>
							</td></tr></tbody></table></div></div></section><section class="section" id="config-fields-db"><div class="titlepage"><div><div><h2 class="title">2.5. Database configuration</h2></div></div></div><p>
				This section describes the database configuration fields available for Red Hat Quay deployments.
			</p><section class="section" id="database-uri"><div class="titlepage"><div><div><h3 class="title">2.5.1. Database URI</h3></div></div></div><p>
					With Red Hat Quay, connection to the database is configured by using the required <code class="literal">DB_URI</code> field.
				</p><p>
					The following table describes the <code class="literal">DB_URI</code> configuration field:
				</p><div class="table" id="idm45384248353264"><p class="title"><strong>Table 2.2. Database URI</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45384249931216" scope="col">Field</th><th align="left" valign="top" id="idm45384249930128" scope="col">Type</th><th align="left" valign="top" id="idm45384249929040" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45384249931216">
								<p>
									<span class="strong strong"><strong>DB_URI</strong></span><br/> (Required)
								</p>
								</td><td align="left" valign="top" headers="idm45384249930128">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384249929040">
								<p>
									The URI for accessing the database, including any credentials.
								</p>
								<p>
									Example <code class="literal">DB_URI</code> field:
								</p>
								<p>
									<span class="strong strong"><strong>postgresql://quayuser:quaypass@quay-server.example.com:5432/quay</strong></span>
								</p>
								</td></tr></tbody></table></div></div></section><section class="section" id="database-connection-arguments"><div class="titlepage"><div><div><h3 class="title">2.5.2. Database connection arguments</h3></div></div></div><p>
					Optional connection arguments are configured by the <code class="literal">DB_CONNECTION_ARGS</code> parameter. Some of the key-value pairs defined under <code class="literal">DB_CONNECTION_ARGS</code> are generic, while others are database specific.
				</p><p>
					The following table describes database connection arguments:
				</p><div class="table" id="idm45384249391920"><p class="title"><strong>Table 2.3. Database connection arguments</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45384250096256" scope="col">Field</th><th align="left" valign="top" id="idm45384250095168" scope="col">Type</th><th align="left" valign="top" id="idm45384250094080" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45384250096256">
								<p>
									<span class="strong strong"><strong>DB_CONNECTION_ARGS</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384250095168">
								<p>
									Object
								</p>
								</td><td align="left" valign="top" headers="idm45384250094080">
								<p>
									Optional connection arguments for the database, such as timeouts and SSL.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384250096256">
								<p>
									<span class="strong strong"><strong>.autorollback</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384250095168">
								<p>
									Boolean
								</p>
								</td><td align="left" valign="top" headers="idm45384250094080">
								<p>
									Whether to use thread-local connections.<br/> Should always be <code class="literal">true</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384250096256">
								<p>
									<span class="strong strong"><strong>.threadlocals</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384250095168">
								<p>
									Boolean
								</p>
								</td><td align="left" valign="top" headers="idm45384250094080">
								<p>
									Whether to use auto-rollback connections.<br/> Should always be <code class="literal">true</code>
								</p>
								</td></tr></tbody></table></div></div><section class="section" id="config-fields-postgres"><div class="titlepage"><div><div><h4 class="title">2.5.2.1. PostgreSQL SSL connection arguments</h4></div></div></div><p>
						With SSL, configuration depends on the database you are deploying. The following example shows a PostgreSQL SSL configuration:
					</p><pre class="programlisting language-yaml">DB_CONNECTION_ARGS:
  sslmode: verify-ca
  sslrootcert: /path/to/cacert</pre><p>
						The <code class="literal">sslmode</code> option determines whether, or with, what priority a secure SSL TCP/IP connection will be negotiated with the server. There are six modes:
					</p><div class="table" id="idm45384252020192"><p class="title"><strong>Table 2.4. SSL options</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 50%; " class="col_2"/></colgroup><thead><tr><th align="left" valign="top" id="idm45384249789456" scope="col">Mode</th><th align="left" valign="top" id="idm45384249788368" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45384249789456">
									<p>
										<span class="strong strong"><strong>disable</strong></span>
									</p>
									</td><td align="left" valign="top" headers="idm45384249788368">
									<p>
										Your configuration only tries non-SSL connections.
									</p>
									</td></tr><tr><td align="left" valign="top" headers="idm45384249789456">
									<p>
										<span class="strong strong"><strong>allow</strong></span>
									</p>
									</td><td align="left" valign="top" headers="idm45384249788368">
									<p>
										Your configuration first tries a non-SSL connection. Upon failure, tries an SSL connection.
									</p>
									</td></tr><tr><td align="left" valign="top" headers="idm45384249789456">
									<p>
										<span class="strong strong"><strong>prefer</strong></span><br/> (Default)
									</p>
									</td><td align="left" valign="top" headers="idm45384249788368">
									<p>
										Your configuration first tries an SSL connection. Upon failure, tries a non-SSL connection.
									</p>
									</td></tr><tr><td align="left" valign="top" headers="idm45384249789456">
									<p>
										<span class="strong strong"><strong>require</strong></span>
									</p>
									</td><td align="left" valign="top" headers="idm45384249788368">
									<p>
										Your configuration only tries an SSL connection. If a root CA file is present, it verifies the certificate in the same way as if verify-ca was specified.
									</p>
									</td></tr><tr><td align="left" valign="top" headers="idm45384249789456">
									<p>
										<span class="strong strong"><strong>verify-ca</strong></span>
									</p>
									</td><td align="left" valign="top" headers="idm45384249788368">
									<p>
										Your configuration only tries an SSL connection, and verifies that the server certificate is issued by a trusted certificate authority (CA).
									</p>
									</td></tr><tr><td align="left" valign="top" headers="idm45384249789456">
									<p>
										<span class="strong strong"><strong>verify-full</strong></span>
									</p>
									</td><td align="left" valign="top" headers="idm45384249788368">
									<p>
										Only tries an SSL connection, and verifies that the server certificate is issued by a trusted CA and that the requested server host name matches that in the certificate.
									</p>
									</td></tr></tbody></table></div></div><p>
						For more information on the valid arguments for PostgreSQL, see <a class="link" href="https://www.postgresql.org/docs/current/libpq-connect.html">Database Connection Control Functions</a>.
					</p></section><section class="section" id="mysql-ssl-connection-arguments"><div class="titlepage"><div><div><h4 class="title">2.5.2.2. MySQL SSL connection arguments</h4></div></div></div><p>
						The following example shows a sample MySQL SSL configuration:
					</p><pre class="screen yaml yaml">DB_CONNECTION_ARGS:
  ssl:
    ca: /path/to/cacert</pre><p>
						Information on the valid connection arguments for MySQL is available at <a class="link" href="https://dev.mysql.com/doc/refman/8.0/en/connecting-using-uri-or-key-value-pairs.html">Connecting to the Server Using URI-Like Strings or Key-Value Pairs</a>.
					</p></section></section></section><section class="section" id="config-fields-storage"><div class="titlepage"><div><div><h2 class="title">2.6. Image storage</h2></div></div></div><p>
				This section details the image storage features and configuration fields that are available with Red Hat Quay.
			</p><section class="section" id="config-fields-storage-features"><div class="titlepage"><div><div><h3 class="title">2.6.1. Image storage features</h3></div></div></div><p>
					The following table describes the image storage features for Red Hat Quay:
				</p><div class="table" id="idm45384249757792"><p class="title"><strong>Table 2.5. Storage config features</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45384249708208" scope="col">Field</th><th align="left" valign="top" id="idm45384249707120" scope="col">Type</th><th align="left" valign="top" id="idm45384249706032" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45384249708208">
								<p>
									<span class="strong strong"><strong>FEATURE_REPO_MIRROR</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384249707120">
								<p>
									Boolean
								</p>
								</td><td align="left" valign="top" headers="idm45384249706032">
								<p>
									If set to true, enables repository mirroring. <br/><br/><span class="strong strong"><strong>Default:</strong></span> <code class="literal">false</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384249708208">
								<p>
									<span class="strong strong"><strong>FEATURE_PROXY_STORAGE</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384249707120">
								<p>
									Boolean
								</p>
								</td><td align="left" valign="top" headers="idm45384249706032">
								<p>
									Whether to proxy all direct download URLs in storage through NGINX. <br/><br/><span class="strong strong"><strong>Default:</strong></span> <code class="literal">false</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384249708208">
								<p>
									<span class="strong strong"><strong>FEATURE_STORAGE_REPLICATION</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384249707120">
								<p>
									Boolean
								</p>
								</td><td align="left" valign="top" headers="idm45384249706032">
								<p>
									Whether to automatically replicate between storage engines.<br/><br/><span class="strong strong"><strong>Default:</strong></span> <code class="literal">false</code>
								</p>
								</td></tr></tbody></table></div></div></section><section class="section" id="config-fields-storage-fields"><div class="titlepage"><div><div><h3 class="title">2.6.2. Image storage configuration fields</h3></div></div></div><p>
					The following table describes the image storage configuration fields for Red Hat Quay:
				</p><div class="table" id="idm45384250632656"><p class="title"><strong>Table 2.6. Storage config fields</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45384249651552" scope="col">Field</th><th align="left" valign="top" id="idm45384249650464" scope="col">Type</th><th align="left" valign="top" id="idm45384249649376" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45384249651552">
								<p>
									<span class="strong strong"><strong>DISTRIBUTED_STORAGE_CONFIG</strong></span><br/> (Required)
								</p>
								</td><td align="left" valign="top" headers="idm45384249650464">
								<p>
									Object
								</p>
								</td><td align="left" valign="top" headers="idm45384249649376">
								<p>
									Configuration for storage engine(s) to use in Red Hat Quay. Each key represents an unique identifier for a storage engine. The value consists of a tuple of (key, value) forming an object describing the storage engine parameters.<br/><br/> <span class="strong strong"><strong>Default:</strong></span> <code class="literal">[]</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384249651552">
								<p>
									<span class="strong strong"><strong>DISTRIBUTED_STORAGE_DEFAULT_LOCATIONS</strong></span><br/> (Required)
								</p>
								</td><td align="left" valign="top" headers="idm45384249650464">
								<p>
									Array of string
								</p>
								</td><td align="left" valign="top" headers="idm45384249649376">
								<p>
									The list of storage engine(s) (by ID in <code class="literal">DISTRIBUTED_STORAGE_CONFIG</code>) whose images should be fully replicated, by default, to all other storage engines.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384249651552">
								<p>
									<span class="strong strong"><strong>DISTRIBUTED_STORAGE_PREFERENCE</strong></span><br/> (Required)
								</p>
								</td><td align="left" valign="top" headers="idm45384249650464">
								<p>
									Array of string
								</p>
								</td><td align="left" valign="top" headers="idm45384249649376">
								<p>
									The preferred storage engine(s) (by ID in <code class="literal">DISTRIBUTED_STORAGE_CONFIG</code>) to use. A preferred engine means it is first checked for pulling and images are pushed to it.<br/><br/> <span class="strong strong"><strong>Default:</strong></span> <code class="literal">false</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384249651552">
								<p>
									<span class="strong strong"><strong>MAXIMUM_LAYER_SIZE</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384249650464">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384249649376">
								<p>
									Maximum allowed size of an image layer.<br/><br/><span class="strong strong"><strong>Pattern</strong></span>: <code class="literal">^[0-9]+(G|M)$</code><br/><br/><span class="strong strong"><strong>Example</strong></span>: <code class="literal">100G</code><br/><br/><span class="strong strong"><strong>Default:</strong></span> <code class="literal">20G</code>
								</p>
								</td></tr></tbody></table></div></div></section><section class="section" id="config-fields-storage-local"><div class="titlepage"><div><div><h3 class="title">2.6.3. Local storage</h3></div></div></div><p>
					The following YAML shows a sample configuration using local storage:
				</p><pre class="programlisting language-yaml">DISTRIBUTED_STORAGE_CONFIG:
  default:
    - LocalStorage
    - storage_path: /datastorage/registry
DISTRIBUTED_STORAGE_DEFAULT_LOCATIONS: []
DISTRIBUTED_STORAGE_PREFERENCE:
    - default</pre></section><section class="section" id="config-fields-storage-noobaa"><div class="titlepage"><div><div><h3 class="title">2.6.4. OCS/NooBaa</h3></div></div></div><p>
					The following YAML shows a sample configuration using an Open Container Storage/NooBaa instance:
				</p><pre class="programlisting language-yaml">DISTRIBUTED_STORAGE_CONFIG:
  rhocsStorage:
    - RHOCSStorage
    - access_key: access_key_here
      secret_key: secret_key_here
      bucket_name: quay-datastore-9b2108a3-29f5-43f2-a9d5-2872174f9a56
      hostname: s3.openshift-storage.svc.cluster.local
      is_secure: 'true'
      port: '443'
      storage_path: /datastorage/registry</pre></section><section class="section" id="config-fields-storage-rados"><div class="titlepage"><div><div><h3 class="title">2.6.5. Ceph / RadosGW Storage / Hitachi HCP</h3></div></div></div><p>
					The following YAML shows a sample configuration using Ceph/RadosGW and Hitachi HCP storage:
				</p><pre class="programlisting language-yaml">DISTRIBUTED_STORAGE_CONFIG:
  radosGWStorage:
    - RadosGWStorage
    - access_key: access_key_here
      secret_key: secret_key_here
      bucket_name: bucket_name_here
      hostname: hostname_here
      is_secure: 'true'
      port: '443'
      storage_path: /datastorage/registry
DISTRIBUTED_STORAGE_DEFAULT_LOCATIONS: []
DISTRIBUTED_STORAGE_PREFERENCE:
    - default</pre></section><section class="section" id="config-fields-storage-aws"><div class="titlepage"><div><div><h3 class="title">2.6.6. AWS S3 storage</h3></div></div></div><p>
					The following YAML shows a sample configuration using AWS S3 storage:
				</p><pre class="programlisting language-yaml">DISTRIBUTED_STORAGE_CONFIG:
  s3Storage:
    - S3Storage
    - host: s3.us-east-2.amazonaws.com
      s3_access_key: ABCDEFGHIJKLMN
      s3_secret_key: OL3ABCDEFGHIJKLMN
      s3_bucket: quay_bucket
      storage_path: /datastorage/registry
DISTRIBUTED_STORAGE_DEFAULT_LOCATIONS: []
DISTRIBUTED_STORAGE_PREFERENCE:
    - s3Storage</pre></section><section class="section" id="config-fields-storage-gcp"><div class="titlepage"><div><div><h3 class="title">2.6.7. Google Cloud Storage</h3></div></div></div><p>
					The following YAML shows a sample configuration using Google Cloud Storage:
				</p><pre class="programlisting language-yaml">DISTRIBUTED_STORAGE_CONFIG:
    googleCloudStorage:
        - GoogleCloudStorage
        - access_key: GOOGQIMFB3ABCDEFGHIJKLMN
          bucket_name: quay-bucket
          secret_key: FhDAYe2HeuAKfvZCAGyOioNaaRABCDEFGHIJKLMN
          storage_path: /datastorage/registry
DISTRIBUTED_STORAGE_DEFAULT_LOCATIONS: []
DISTRIBUTED_STORAGE_PREFERENCE:
    - googleCloudStorage</pre></section><section class="section" id="config-fields-storage-azure"><div class="titlepage"><div><div><h3 class="title">2.6.8. Azure Storage</h3></div></div></div><p>
					The following YAML shows a sample configuration using Azure Storage:
				</p><pre class="programlisting language-yaml">DISTRIBUTED_STORAGE_CONFIG:
  azureStorage:
    - AzureStorage
    - azure_account_name: azure_account_name_here
      azure_container: azure_container_here
      storage_path: /datastorage/registry
      azure_account_key: azure_account_key_here
      sas_token: some/path/
      endpoint_url: https://[account-name].blob.core.usgovcloudapi.net <span id="CO1-1"/><span class="callout">1</span>
DISTRIBUTED_STORAGE_DEFAULT_LOCATIONS: []
DISTRIBUTED_STORAGE_PREFERENCE:
    - azureStorage</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO1-1"><span class="callout">1</span></a> </dt><dd><div class="para">
							The <code class="literal">endpoint_url</code> parameter for Azure storage is optional and can be used with Microsoft Azure Government (MAG) endpoints. If left blank, the <code class="literal">endpoint_url</code> will connect to the normal Azure region.
						</div><p>
							As of Red Hat Quay 3.7, you must use the Primary endpoint of your MAG Blob service. Using the Secondary endpoint of your MAG Blob service will result in the following error: <code class="literal">AuthenticationErrorDetail:Cannot find the claimed account when trying to GetProperties for the account whusc8-secondary</code>.
						</p></dd></dl></div></section><section class="section" id="config-fields-storage-swift"><div class="titlepage"><div><div><h3 class="title">2.6.9. Swift storage</h3></div></div></div><p>
					The following YAML shows a sample configuration using Swift storage:
				</p><pre class="programlisting language-yaml">DISTRIBUTED_STORAGE_CONFIG:
  swiftStorage:
    - SwiftStorage
    - swift_user: swift_user_here
      swift_password: swift_password_here
      swift_container: swift_container_here
      auth_url: https://example.org/swift/v1/quay
      auth_version: 1
      ca_cert_path: /conf/stack/swift.cert"
      storage_path: /datastorage/registry
DISTRIBUTED_STORAGE_DEFAULT_LOCATIONS: []
DISTRIBUTED_STORAGE_PREFERENCE:
    - swiftStorage</pre></section></section><section class="section" id="config-fields-redis"><div class="titlepage"><div><div><h2 class="title">2.7. Redis configuration fields</h2></div></div></div><p>
				This section details the configuration fields available for Redis deployments.
			</p><section class="section" id="build_logs"><div class="titlepage"><div><div><h3 class="title">2.7.1. Build logs</h3></div></div></div><p>
					The following build logs configuration fields are available for Redis deployments:
				</p><div class="table" id="idm45384253830528"><p class="title"><strong>Table 2.7. Build logs configuration</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45384249578592" scope="col">Field</th><th align="left" valign="top" id="idm45384249577616" scope="col">Type</th><th align="left" valign="top" id="idm45384249576528" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45384249578592">
								<p>
									<span class="strong strong"><strong>BUILDLOGS_REDIS</strong></span><br/> (Required)
								</p>
								</td><td align="left" valign="top" headers="idm45384249577616">
								<p>
									Object
								</p>
								</td><td align="left" valign="top" headers="idm45384249576528">
								<p>
									Redis connection details for build logs caching.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384249578592">
								<p>
									<span class="strong strong"><strong>.host</strong></span> <br/> (Required)
								</p>
								</td><td align="left" valign="top" headers="idm45384249577616">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384249576528">
								<p>
									The hostname at which Redis is accessible.<br/><span class="strong strong"><strong>Example:</strong></span><br/><code class="literal">quay-server.example.com</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384249578592">
								<p>
									<span class="strong strong"><strong>.port</strong></span> <br/> (Required)
								</p>
								</td><td align="left" valign="top" headers="idm45384249577616">
								<p>
									Number
								</p>
								</td><td align="left" valign="top" headers="idm45384249576528">
								<p>
									The port at which Redis is accessible.<br/><span class="strong strong"><strong>Example:</strong></span><br/><code class="literal">6379</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384249578592">
								<p>
									<span class="strong strong"><strong>.password</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384249577616">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384249576528">
								<p>
									The password to connect to the Redis instance.<br/><span class="strong strong"><strong>Example:</strong></span><br/><code class="literal">strongpassword</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384249578592">
								<p>
									<span class="strong strong"><strong>.ssl</strong></span><br/> (Optional)
								</p>
								</td><td align="left" valign="top" headers="idm45384249577616">
								<p>
									Boolean
								</p>
								</td><td align="left" valign="top" headers="idm45384249576528">
								<p>
									Whether to enable TLS communication between Redis and Quay. Defaults to false.
								</p>
								</td></tr></tbody></table></div></div></section><section class="section" id="user-event-fields-redis"><div class="titlepage"><div><div><h3 class="title">2.7.2. User events</h3></div></div></div><p>
					The following user event fields are available for Redis deployments:
				</p><div class="table" id="idm45384249368336"><p class="title"><strong>Table 2.8. User events config</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45384249765600" scope="col">Field</th><th align="left" valign="top" id="idm45384249764512" scope="col">Type</th><th align="left" valign="top" id="idm45384249820048" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45384249765600">
								<p>
									<span class="strong strong"><strong>USER_EVENTS_REDIS</strong></span><br/> (Required)
								</p>
								</td><td align="left" valign="top" headers="idm45384249764512">
								<p>
									Object
								</p>
								</td><td align="left" valign="top" headers="idm45384249820048">
								<p>
									Redis connection details for user event handling.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384249765600">
								<p>
									<span class="strong strong"><strong>.host</strong></span> <br/> (Required)
								</p>
								</td><td align="left" valign="top" headers="idm45384249764512">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384249820048">
								<p>
									The hostname at which Redis is accessible.<br/><span class="strong strong"><strong>Example:</strong></span><br/><code class="literal">quay-server.example.com</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384249765600">
								<p>
									<span class="strong strong"><strong>.port</strong></span> <br/> (Required)
								</p>
								</td><td align="left" valign="top" headers="idm45384249764512">
								<p>
									Number
								</p>
								</td><td align="left" valign="top" headers="idm45384249820048">
								<p>
									The port at which Redis is accessible.<br/><span class="strong strong"><strong>Example:</strong></span><br/><code class="literal">6379</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384249765600">
								<p>
									<span class="strong strong"><strong>.password</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384249764512">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384249820048">
								<p>
									The password to connect to the Redis instance.<br/><span class="strong strong"><strong>Example:</strong></span><br/><code class="literal">strongpassword</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384249765600">
								<p>
									<span class="strong strong"><strong>.ssl</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384249764512">
								<p>
									Boolean
								</p>
								</td><td align="left" valign="top" headers="idm45384249820048">
								<p>
									Whether to enable TLS communication between Redis and Quay. Defaults to false.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384249765600">
								<p>
									<span class="strong strong"><strong>.ssl_keyfile</strong></span><br/> (Optional)
								</p>
								</td><td align="left" valign="top" headers="idm45384249764512">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384249820048">
								<p>
									The name of the key database file, which houses the client certificate to be used.<br/><span class="strong strong"><strong>Example:</strong></span><br/><code class="literal">ssl_keyfile: /path/to/server/privatekey.pem</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384249765600">
								<p>
									<span class="strong strong"><strong>.ssl_certfile</strong></span><br/> (Optional)
								</p>
								</td><td align="left" valign="top" headers="idm45384249764512">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384249820048">
								<p>
									Used for specifying the file path of the SSL certificate.<br/><span class="strong strong"><strong>Example:</strong></span><br/><code class="literal">ssl_certfile: /path/to/server/certificate.pem</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384249765600">
								<p>
									<span class="strong strong"><strong>.ssl_cert_reqs</strong></span><br/> (Optional)
								</p>
								</td><td align="left" valign="top" headers="idm45384249764512">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384249820048">
								<p>
									Used to specify the level of certificate validation to be performed during the SSL/TLS handshake.<br/><span class="strong strong"><strong>Example:</strong></span><br/><code class="literal">ssl_cert_reqs: CERT_REQUIRED</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384249765600">
								<p>
									<span class="strong strong"><strong>.ssl_ca_certs</strong></span><br/> (Optional)
								</p>
								</td><td align="left" valign="top" headers="idm45384249764512">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384249820048">
								<p>
									Used to specify the path to a file containing a list of trusted Certificate Authority (CA) certificates.<br/><span class="strong strong"><strong>Example:</strong></span><br/><code class="literal">ssl_ca_certs: /path/to/ca_certs.pem</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384249765600">
								<p>
									<span class="strong strong"><strong>.ssl_ca_data</strong></span><br/> (Optional)
								</p>
								</td><td align="left" valign="top" headers="idm45384249764512">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384249820048">
								<p>
									Used to specify a string containing the trusted CA certificates in PEM format.<br/><span class="strong strong"><strong>Example:</strong></span><br/><code class="literal">ssl_ca_data: &lt;certificate&gt;</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384249765600">
								<p>
									<span class="strong strong"><strong>.ssl_check_hostname </strong></span><br/> (Optional)
								</p>
								</td><td align="left" valign="top" headers="idm45384249764512">
								<p>
									Boolean
								</p>
								</td><td align="left" valign="top" headers="idm45384249820048">
								<p>
									Used when setting up an SSL/TLS connection to a server. It specifies whether the client should check that the hostname in the server’s SSL/TLS certificate matches the hostname of the server it is connecting to.<br/><span class="strong strong"><strong>Example:</strong></span><br/><code class="literal">ssl_check_hostname: true</code>
								</p>
								</td></tr></tbody></table></div></div></section><section class="section" id="example-redis-configuration"><div class="titlepage"><div><div><h3 class="title">2.7.3. Example Redis configuration</h3></div></div></div><p>
					The following YAML shows a sample configuration using Redis with optional SSL/TLS fields:
				</p><pre class="programlisting language-yaml">BUILDLOGS_REDIS:
  host: quay-server.example.com
  password: strongpassword
  port: 6379
  ssl: true


USER_EVENTS_REDIS:
  host: quay-server.example.com
  password: strongpassword
  port: 6379
  ssl: true
  ssl_*: &lt;path_location_or_certificate&gt;</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						If your deployment uses Azure Cache for Redis and <code class="literal">ssl</code> is set to <code class="literal">true</code>, the port defaults to <code class="literal">6380</code>.
					</p></div></div></section></section><section class="section" id="config-fields-modelcache"><div class="titlepage"><div><div><h2 class="title">2.8. ModelCache configuration options</h2></div></div></div><p>
				The following options are available on Red Hat Quay for configuring ModelCache.
			</p><section class="section" id="config-fields-modelcache-memcache"><div class="titlepage"><div><div><h3 class="title">2.8.1. Memcache configuration option</h3></div></div></div><p>
					Memcache is the default ModelCache configuration option. With Memcache, no additional configuration is necessary.
				</p></section><section class="section" id="config-fields-modelcache-single-redis"><div class="titlepage"><div><div><h3 class="title">2.8.2. Single Redis configuration option</h3></div></div></div><p>
					The following configuration is for a single Redis instance with optional read-only replicas:
				</p><pre class="programlisting language-yaml">    DATA_MODEL_CACHE_CONFIG:
      engine: redis
      redis_config:
        primary:
            host: &lt;host&gt;
            port: &lt;port&gt;
            password: &lt;password if ssl is true&gt;
           ssl: &lt;true | false &gt;
        replica:
            host: &lt;host&gt;
            port: &lt;port&gt;
            password: &lt;password if ssl is true&gt;
           ssl: &lt;true | false &gt;</pre></section><section class="section" id="config-fields-modelcache-clustered-redis"><div class="titlepage"><div><div><h3 class="title">2.8.3. Clustered Redis configuration option</h3></div></div></div><p>
					Use the following configuration for a clustered Redis instance:
				</p><pre class="programlisting language-yaml">    DATA_MODEL_CACHE_CONFIG:
      engine: rediscluster
      redis_config:
        startup_nodes:
          - host: &lt;cluster-host&gt;
            port: &lt;port&gt;
        password: &lt;password if ssl: true&gt;
        read_from_replicas: &lt;true|false&gt;
        skip_full_coverage_check: &lt;true | false&gt;
        ssl: &lt;true | false &gt;</pre></section></section><section class="section" id="config-fields-tag-expiration"><div class="titlepage"><div><div><h2 class="title">2.9. Tag expiration configuration fields</h2></div></div></div><p>
				The following tag expiration configuration fields are available with Red Hat Quay:
			</p><div class="table" id="idm45384251079424"><p class="title"><strong>Table 2.9. Tag expiration configuration fields</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45384244546720" scope="col">Field</th><th align="left" valign="top" id="idm45384244545632" scope="col">Type</th><th align="left" valign="top" id="idm45384244544544" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45384244546720">
							<p>
								<span class="strong strong"><strong>FEATURE_GARBAGE_COLLECTION</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384244545632">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45384244544544">
							<p>
								Whether garbage collection of repositories is enabled.<br/><br/><span class="strong strong"><strong>Default:</strong></span> True
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384244546720">
							<p>
								<span class="strong strong"><strong>TAG_EXPIRATION_OPTIONS</strong></span><br/> (Required)
							</p>
							</td><td align="left" valign="top" headers="idm45384244545632">
							<p>
								Array of string
							</p>
							</td><td align="left" valign="top" headers="idm45384244544544">
							<p>
								If enabled, the options that users can select for expiration of tags in their namespace.<br/><br/><span class="strong strong"><strong>Pattern:</strong></span><br/><code class="literal">^[0-9]+(w|m|d|h|s)$</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384244546720">
							<p>
								<span class="strong strong"><strong>DEFAULT_TAG_EXPIRATION</strong></span><br/> (Required)
							</p>
							</td><td align="left" valign="top" headers="idm45384244545632">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384244544544">
							<p>
								The default, configurable tag expiration time for time machine.<br/><br/><span class="strong strong"><strong>Pattern:</strong></span> <br/><code class="literal">^[0-9]+(w|m|d|h|s)$</code><br/><span class="strong strong"><strong>Default:</strong></span> <code class="literal">2w</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384244546720">
							<p>
								<span class="strong strong"><strong>FEATURE_CHANGE_TAG_EXPIRATION</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384244545632">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45384244544544">
							<p>
								Whether users and organizations are allowed to change the tag expiration for tags in their namespace.<br/><br/><span class="strong strong"><strong>Default:</strong></span> True
							</p>
							</td></tr></tbody></table></div></div><section class="section" id="example-config-fields-tag-expiration"><div class="titlepage"><div><div><h3 class="title">2.9.1. Example tag expiration configuration</h3></div></div></div><p>
					The following YAML shows a sample tag expiration configuration:
				</p><pre class="programlisting language-terminal">DEFAULT_TAG_EXPIRATION: 2w
TAG_EXPIRATION_OPTIONS:
    - 0s
    - 1d
    - 1w
    - 2w
    - 4w</pre></section></section><section class="section" id="config-preconfigure-automation"><div class="titlepage"><div><div><h2 class="title">2.10. Pre-configuring Red Hat Quay for automation</h2></div></div></div><p>
				Red Hat Quay has several configuration options that support automation. These options can be set before deployment to minimize the need to interact with the user interface.
			</p><section class="section" id="allowing-the-api-to-create-first-user"><div class="titlepage"><div><div><h3 class="title">2.10.1. Allowing the API to create the first user</h3></div></div></div><p>
					To create the first user using the <code class="literal">/api/v1/user/initialize</code> API, set the <code class="literal">FEATURE_USER_INITIALIZE</code> parameter to <code class="literal">true</code>. Unlike all other registry API calls which require an OAuth token that is generated by an OAuth application in an existing organization, the API endpoint does not require authentication.
				</p><p>
					After you have deployed Red Hat Quay, you can use the API to create a user, for example, <code class="literal">quayadmin</code>, assuming that no other users have already been created. For more information see <a class="link" href="#using-the-api-to-create-first-user" title="2.10.9.1. Using the API to create the first user">Using the API to create the first user</a>.
				</p></section><section class="section" id="enabling-general-api-access"><div class="titlepage"><div><div><h3 class="title">2.10.2. Enabling general API access</h3></div></div></div><p>
					Set the config option <code class="literal">BROWSER_API_CALLS_XHR_ONLY</code> to <code class="literal">false</code> to allow general access to the Red Hat Quay registry API.
				</p></section><section class="section" id="adding-super-user"><div class="titlepage"><div><div><h3 class="title">2.10.3. Adding a superuser</h3></div></div></div><p>
					After deploying Red Hat Quay, you can create a user. It is suggested that the first user be given administrator privileges with full permissions. Full permissions can be configured in advance by using the <code class="literal">SUPER_USER</code> configuration object. For example:
				</p><pre class="programlisting language-yaml">...
SERVER_HOSTNAME: quay-server.example.com
SETUP_COMPLETE: true
SUPER_USERS:
  - quayadmin
...</pre></section><section class="section" id="restricting-user-creation"><div class="titlepage"><div><div><h3 class="title">2.10.4. Restricting user creation</h3></div></div></div><p>
					After you have configured a super user, you can restrict the ability to create new users to the super user group. Set the <code class="literal">FEATURE_USER_CREATION</code> to <code class="literal">false</code> to restrict user creation. For example:
				</p><pre class="programlisting language-yaml">...
FEATURE_USER_INITIALIZE: true
BROWSER_API_CALLS_XHR_ONLY: false
SUPER_USERS:
- quayadmin
FEATURE_USER_CREATION: false
...</pre></section><section class="section" id="enabling-new-functionality-38"><div class="titlepage"><div><div><h3 class="title">2.10.5. Enabling new functionality</h3></div></div></div><p>
					To use new Red Hat Quay 3.8 functionality, enable some or all of the following features:
				</p><pre class="programlisting language-yaml">...
FEATURE_UI_V2: true
FEATURE_LISTEN_IP_VERSION:
FEATURE_SUPERUSERS_FULL_ACCESS: true
GLOBAL_READONLY_SUPER_USERS:
      -
FEATURE_RESTRICTED_USERS: true
RESTRICTED_USERS_WHITELIST:
      -
...</pre></section><section class="section" id="enabling-new-functionality-37"><div class="titlepage"><div><div><h3 class="title">2.10.6. Enabling new functionality</h3></div></div></div><p>
					To use new Red Hat Quay 3.7 functionality, enable some or all of the following features:
				</p><pre class="programlisting language-yaml">...
FEATURE_QUOTA_MANAGEMENT: true
FEATURE_BUILD_SUPPORT: true
FEATURE_PROXY_CACHE: true
FEATURE_STORAGE_REPLICATION: true
DEFAULT_SYSTEM_REJECT_QUOTA_BYTES: 102400000
...</pre></section><section class="section" id="suggested-configuration-for-automation"><div class="titlepage"><div><div><h3 class="title">2.10.7. Suggested configuration for automation</h3></div></div></div><p>
					The following <code class="literal">config.yaml</code> parameters are suggested for automation:
				</p><pre class="programlisting language-yaml">...
FEATURE_USER_INITIALIZE: true
BROWSER_API_CALLS_XHR_ONLY: false
SUPER_USERS:
- quayadmin
FEATURE_USER_CREATION: false
...</pre></section><section class="section" id="deploying-the-operator-using-initial-configuration"><div class="titlepage"><div><div><h3 class="title">2.10.8. Deploying the Red Hat Quay Operator using the initial configuration</h3></div></div></div><p>
					Use the following procedure to deploy Red Hat Quay on OpenShift Container Platform using the initial configuration.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have installed the <code class="literal">oc</code> CLI.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create a secret using the configuration file:
						</p><pre class="programlisting language-terminal">$ oc create secret generic -n quay-enterprise --from-file config.yaml=./config.yaml init-config-bundle-secret</pre></li><li class="listitem"><p class="simpara">
							Create a <code class="literal">quayregistry.yaml</code> file. Identify the unmanaged components and reference the created secret, for example:
						</p><pre class="programlisting language-yaml">apiVersion: quay.redhat.com/v1
kind: QuayRegistry
metadata:
  name: example-registry
  namespace: quay-enterprise
spec:
  configBundleSecret: init-config-bundle-secret</pre></li><li class="listitem"><p class="simpara">
							Deploy the Red Hat Quay registry:
						</p><pre class="programlisting language-terminal">$ oc create -n quay-enterprise -f quayregistry.yaml</pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Next Steps</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="#using-the-api-to-create-first-user" title="2.10.9.1. Using the API to create the first user">Using the API to create the first user</a>
						</li></ul></div></section><section class="section" id="deploy-quay-api"><div class="titlepage"><div><div><h3 class="title">2.10.9. Using the API to deploy Red Hat Quay</h3></div></div></div><p>
					This section introduces using the API to deploy Red Hat Quay.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							The config option <code class="literal">FEATURE_USER_INITIALIZE</code> must be set to <code class="literal">true</code>.
						</li><li class="listitem">
							No users can already exist in the database.
						</li></ul></div><p>
					For more information on pre-configuring your Red Hat Quay deployment, see the section <a class="link" href="#config-preconfigure-automation" title="2.10. Pre-configuring Red Hat Quay for automation">Pre-configuring Red Hat Quay for automation</a>
				</p><section class="section" id="using-the-api-to-create-first-user"><div class="titlepage"><div><div><h4 class="title">2.10.9.1. Using the API to create the first user</h4></div></div></div><p>
						Use the following procedure to create the first user in your Red Hat Quay organization.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							This procedure requests an OAuth token by specifying <code class="literal">"access_token": true</code>.
						</p></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								As the root user, install <code class="literal">python39</code> by entering the following command:
							</p><pre class="programlisting language-terminal">$ sudo yum install python39</pre></li><li class="listitem"><p class="simpara">
								Upgrade the <code class="literal">pip</code> package manager for Python 3.9:
							</p><pre class="programlisting language-terminal">$ python3.9 -m pip install --upgrade pip</pre></li><li class="listitem"><p class="simpara">
								Use the <code class="literal">pip</code> package manager to install the <code class="literal">bcrypt</code> package:
							</p><pre class="programlisting language-terminal">$ pip install bcrypt</pre></li><li class="listitem"><p class="simpara">
								Generate a secure, hashed password using the <code class="literal">bcrypt</code> package in Python 3.9 by entering the following command:
							</p><pre class="programlisting language-terminal">$ python3.9 -c 'import bcrypt; print(bcrypt.hashpw(b"subquay12345", bcrypt.gensalt(12)).decode("utf-8"))'</pre></li><li class="listitem"><p class="simpara">
								Open your Red Hat Quay configuration file and update the following configuration fields:
							</p><pre class="programlisting language-yaml">FEATURE_USER_INITIALIZE: true
SUPER_USERS:
     -  quayadmin</pre></li><li class="listitem"><p class="simpara">
								Stop the Red Hat Quay service by entering the following command:
							</p><pre class="programlisting language-terminal">$ sudo podman stop quay</pre></li><li class="listitem"><p class="simpara">
								Start the Red Hat Quay service by entering the following command:
							</p><pre class="programlisting language-terminal">$ sudo podman run -d -p 80:8080 -p 443:8443 --name=quay -v $QUAY/config:/conf/stack:Z  -v $QUAY/storage:/datastorage:Z {productrepo}/{quayimage}:{productminv}</pre></li><li class="listitem"><p class="simpara">
								Run the following <code class="literal">CURL</code> command to generate a new user with a username, password, email, and access token:
							</p><pre class="programlisting language-terminal">$ curl -X POST -k  http://quay-server.example.com/api/v1/user/initialize --header 'Content-Type: application/json' --data '{ "username": "quayadmin", "password":"quaypass12345", "email": "quayadmin@example.com", "access_token": true}'</pre><p class="simpara">
								If successful, the command returns an object with the username, email, and encrypted password. For example:
							</p><pre class="programlisting language-yaml">{"access_token":"6B4QTRSTSD1HMIG915VPX7BMEZBVB9GPNY2FC2ED", "email":"quayadmin@example.com","encrypted_password":"1nZMLH57RIE5UGdL/yYpDOHLqiNCgimb6W9kfF8MjZ1xrfDpRyRs9NUnUuNuAitW","username":"quayadmin"}</pre><p class="simpara">
								If a user already exists in the database, an error is returned:
							</p><pre class="programlisting language-terminal">{"message":"Cannot initialize user in a non-empty database"}</pre><p class="simpara">
								If your password is not at least eight characters or contains whitespace, an error is returned:
							</p><pre class="programlisting language-terminal">{"message":"Failed to initialize user: Invalid password, password must be at least 8 characters and contain no whitespace."}</pre></li><li class="listitem"><p class="simpara">
								Log in to your Red Hat Quay deployment by entering the following command:
							</p><pre class="programlisting language-terminal">$ sudo podman login -u quayadmin -p quaypass12345 http://quay-server.example.com --tls-verify=false</pre><div class="formalpara"><p class="title"><strong>Example output</strong></p><p>
									
<pre class="programlisting language-terminal">Login Succeeded!</pre>
								</p></div></li></ol></div></section><section class="section" id="using-the-oauth-token"><div class="titlepage"><div><div><h4 class="title">2.10.9.2. Using the OAuth token</h4></div></div></div><p>
						After invoking the API, you can call out the rest of the Red Hat Quay API by specifying the returned OAuth code.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								You have invoked the <code class="literal">/api/v1/user/initialize</code> API, and passed in the username, password, and email address.
							</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Obtain the list of current users by entering the following command:
							</p><pre class="programlisting language-terminal">$ curl -X GET -k -H "Authorization: Bearer 6B4QTRSTSD1HMIG915VPX7BMEZBVB9GPNY2FC2ED" https://example-registry-quay-quay-enterprise.apps.docs.quayteam.org/api/v1/superuser/users/</pre><p class="simpara">
								Example output:
							</p><pre class="programlisting language-yaml">{
    "users": [
        {
            "kind": "user",
            "name": "quayadmin",
            "username": "quayadmin",
            "email": "quayadmin@example.com",
            "verified": true,
            "avatar": {
                "name": "quayadmin",
                "hash": "3e82e9cbf62d25dec0ed1b4c66ca7c5d47ab9f1f271958298dea856fb26adc4c",
                "color": "#e7ba52",
                "kind": "user"
            },
            "super_user": true,
            "enabled": true
        }
    ]
}</pre><p class="simpara">
								In this instance, the details for the <code class="literal">quayadmin</code> user are returned as it is the only user that has been created so far.
							</p></li></ul></div></section><section class="section" id="using-the-api-to-create-an-organization"><div class="titlepage"><div><div><h4 class="title">2.10.9.3. Using the API to create an organization</h4></div></div></div><p>
						The following procedure details how to use the API to create a Red Hat Quay organization.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								You have invoked the <code class="literal">/api/v1/user/initialize</code> API, and passed in the username, password, and email address.
							</li><li class="listitem">
								You have called out the rest of the Red Hat Quay API by specifying the returned OAuth code.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								To create an organization, use a POST call to <code class="literal">api/v1/organization/</code> endpoint:
							</p><pre class="programlisting language-terminal">$ curl -X POST -k --header 'Content-Type: application/json' -H "Authorization: Bearer 6B4QTRSTSD1HMIG915VPX7BMEZBVB9GPNY2FC2ED" https://example-registry-quay-quay-enterprise.apps.docs.quayteam.org/api/v1/organization/ --data '{"name": "testorg", "email": "testorg@example.com"}'</pre><p class="simpara">
								Example output:
							</p><pre class="programlisting language-yaml">"Created"</pre></li><li class="listitem"><p class="simpara">
								You can retrieve the details of the organization you created by entering the following command:
							</p><pre class="programlisting language-terminal">$ curl -X GET -k --header 'Content-Type: application/json' -H "Authorization: Bearer 6B4QTRSTSD1HMIG915VPX7BMEZBVB9GPNY2FC2ED" https://min-registry-quay-quay-enterprise.apps.docs.quayteam.org/api/v1/organization/testorg</pre><p class="simpara">
								Example output:
							</p><pre class="programlisting language-terminal">{
    "name": "testorg",
    "email": "testorg@example.com",
    "avatar": {
        "name": "testorg",
        "hash": "5f113632ad532fc78215c9258a4fb60606d1fa386c91b141116a1317bf9c53c8",
        "color": "#a55194",
        "kind": "user"
    },
    "is_admin": true,
    "is_member": true,
    "teams": {
        "owners": {
            "name": "owners",
            "description": "",
            "role": "admin",
            "avatar": {
                "name": "owners",
                "hash": "6f0e3a8c0eb46e8834b43b03374ece43a030621d92a7437beb48f871e90f8d90",
                "color": "#c7c7c7",
                "kind": "team"
            },
            "can_view": true,
            "repo_count": 0,
            "member_count": 1,
            "is_synced": false
        }
    },
    "ordered_teams": [
        "owners"
    ],
    "invoice_email": false,
    "invoice_email_address": null,
    "tag_expiration_s": 1209600,
    "is_free_account": true
}</pre></li></ol></div></section></section></section><section class="section" id="config-fields-basic"><div class="titlepage"><div><div><h2 class="title">2.11. Basic configuration fields</h2></div></div></div><div class="table" id="idm45384246646992"><p class="title"><strong>Table 2.10. Basic configuration</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45384250860032" scope="col">Field</th><th align="left" valign="top" id="idm45384250858944" scope="col">Type</th><th align="left" valign="top" id="idm45384250857856" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45384250860032">
							<p>
								<span class="strong strong"><strong>REGISTRY_TITLE</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384250858944">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384250857856">
							<p>
								If specified, the long-form title for the registry. Displayed in frontend of your Red Hat Quay deployment, for example, at the sign in page of your organization. Should not exceed 35 characters. <br/><span class="strong strong"><strong>Default:</strong></span><br/><code class="literal">Red Hat Quay</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384250860032">
							<p>
								<span class="strong strong"><strong>REGISTRY_TITLE_SHORT</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384250858944">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384250857856">
							<p>
								If specified, the short-form title for the registry. Title is displayed on various pages of your organization, for example, as the title of the tutorial on your organization’s <span class="strong strong"><strong>Tutorial</strong></span> page. <br/><span class="strong strong"><strong>Default:</strong></span><br/><code class="literal">Red Hat Quay</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384250860032">
							<p>
								<span class="strong strong"><strong>CONTACT_INFO</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384250858944">
							<p>
								Array of String
							</p>
							</td><td align="left" valign="top" headers="idm45384250857856">
							<p>
								If specified, contact information to display on the contact page. If only a single piece of contact information is specified, the contact footer will link directly.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384250860032">
							<p>
								<span class="strong strong"><strong>[0]</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384250858944">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384250857856">
							<p>
								Adds a link to send an e-mail.<br/><br/><span class="strong strong"><strong>Pattern:</strong></span><br/><code class="literal">^mailto:(.)+$</code><br/><span class="strong strong"><strong>Example:</strong></span><br/><code class="literal">mailto:support@quay.io</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384250860032">
							<p>
								<span class="strong strong"><strong>[1]</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384250858944">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384250857856">
							<p>
								Adds a link to visit an IRC chat room.<br/><br/><span class="strong strong"><strong>Pattern:</strong></span><br/><code class="literal">^irc://(.)+$</code><br/><span class="strong strong"><strong>Example:</strong></span><br/><code class="literal"><a class="link" href="irc://chat.freenode.net:6665/quay">irc://chat.freenode.net:6665/quay</a></code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384250860032">
							<p>
								<span class="strong strong"><strong>[2]</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384250858944">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384250857856">
							<p>
								Adds a link to call a phone number.+ <br/><span class="strong strong"><strong>Pattern:</strong></span><br/><code class="literal">^tel:(.)+$</code><br/><span class="strong strong"><strong>Example:</strong></span><br/><code class="literal">tel:+1-888-930-3475</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384250860032">
							<p>
								<span class="strong strong"><strong>[3]</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384250858944">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384250857856">
							<p>
								Adds a link to a defined URL.<br/><br/><span class="strong strong"><strong>Pattern:</strong></span><br/><code class="literal">^http(s)?://(.)+$</code><br/><span class="strong strong"><strong>Example:</strong></span><br/><code class="literal"><a class="link" href="https://twitter.com/quayio">https://twitter.com/quayio</a></code>
							</p>
							</td></tr></tbody></table></div></div></section><section class="section" id="config-fields-ssl"><div class="titlepage"><div><div><h2 class="title">2.12. SSL configuration fields</h2></div></div></div><div class="table" id="idm45384245541424"><p class="title"><strong>Table 2.11. SSL configuration</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45384245535664" scope="col">Field</th><th align="left" valign="top" id="idm45384245534576" scope="col">Type</th><th align="left" valign="top" id="idm45384245533488" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45384245535664">
							<p>
								<span class="strong strong"><strong>PREFERRED_URL_SCHEME</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384245534576">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384245533488">
							<p>
								One of <code class="literal">http</code> or <code class="literal">https</code>. Note that users only set their <code class="literal">PREFERRED_URL_SCHEME</code> to <code class="literal">http</code> when there is no TLS encryption in the communication path from the client to Quay.
							</p>
							<p>
								+ Users must set their <code class="literal">PREFERRED_URL_SCHEME`to `https</code> when using a TLS-terminating load balancer, a reverse proxy (for example, Nginx), or when using Quay with custom SSL certificates directly. In most cases, the <code class="literal">PREFERRED_URL_SCHEME</code> should be <code class="literal">https</code>. <br/> <span class="strong strong"><strong>Default:</strong></span> <code class="literal">http</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384245535664">
							<p>
								<span class="strong strong"><strong>SERVER_HOSTNAME</strong></span> <br/> (Required)
							</p>
							</td><td align="left" valign="top" headers="idm45384245534576">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384245533488">
							<p>
								The URL at which Red Hat Quay is accessible, without the scheme<br/><br/><span class="strong strong"><strong>Example:</strong></span><br/><code class="literal">quay-server.example.com</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384245535664">
							<p>
								<span class="strong strong"><strong>SSL_CIPHERS</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384245534576">
							<p>
								Array of String
							</p>
							</td><td align="left" valign="top" headers="idm45384245533488">
							<p>
								If specified, the nginx-defined list of SSL ciphers to enabled and disabled<br/><br/><span class="strong strong"><strong>Example:</strong></span><br/> [<code class="literal">CAMELLIA</code>, <code class="literal">!3DES</code>]
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384245535664">
							<p>
								<span class="strong strong"><strong>SSL_PROTOCOLS</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384245534576">
							<p>
								Array of String
							</p>
							</td><td align="left" valign="top" headers="idm45384245533488">
							<p>
								If specified, nginx is configured to enabled a list of SSL protocols defined in the list. Removing an SSL protocol from the list disables the protocol during Red Hat Quay startup.<br/><br/><span class="strong strong"><strong>Example:</strong></span><br/><code class="literal">['TLSv1','TLSv1.1','TLSv1.2', `TLSv1.3</code>]`
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384245535664">
							<p>
								<span class="strong strong"><strong>SESSION_COOKIE_SECURE</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384245534576">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45384245533488">
							<p>
								Whether the <code class="literal">secure</code> property should be set on session cookies<br/><br/><span class="strong strong"><strong>Default:</strong></span><br/> False<br/><br/><span class="strong strong"><strong>Recommendation:</strong></span><br/> Set to True for all installations using SSL
							</p>
							</td></tr></tbody></table></div></div><section class="section" id="configuring_ssl"><div class="titlepage"><div><div><h3 class="title">2.12.1. Configuring SSL</h3></div></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Copy the certificate file and primary key file to your configuration directory, ensuring they are named <code class="literal">ssl.cert</code> and <code class="literal">ssl.key</code> respectively:
						</p><pre class="screen">$ cp ~/ssl.cert $QUAY/config
$ cp ~/ssl.key $QUAY/config
$ cd $QUAY/config</pre></li><li class="listitem"><p class="simpara">
							Edit the <code class="literal">config.yaml</code> file and specify that you want Quay to handle TLS:
						</p><div class="formalpara"><p class="title"><strong>config.yaml</strong></p><p>
								
<pre class="programlisting language-yaml">...
SERVER_HOSTNAME: quay-server.example.com
...
PREFERRED_URL_SCHEME: https
...</pre>
							</p></div></li><li class="listitem">
							Stop the <code class="literal">Quay</code> container and restart the registry
						</li></ol></div></section></section><section class="section" id="config-custom-ssl-certs-manual"><div class="titlepage"><div><div><h2 class="title">2.13. Adding TLS Certificates to the Red Hat Quay Container</h2></div></div></div><p>
				To add custom TLS certificates to Red Hat Quay, create a new directory named <code class="literal">extra_ca_certs/</code> beneath the Red Hat Quay config directory. Copy any required site-specific TLS certificates to this new directory.
			</p><section class="section" id="add-certificates-to-quay-container"><div class="titlepage"><div><div><h3 class="title">2.13.1. Add TLS certificates to Red Hat Quay</h3></div></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							View certificate to be added to the container
						</p><pre class="screen">$ cat storage.crt
-----BEGIN CERTIFICATE-----
MIIDTTCCAjWgAwIBAgIJAMVr9ngjJhzbMA0GCSqGSIb3DQEBCwUAMD0xCzAJBgNV
[...]
-----END CERTIFICATE-----</pre></li><li class="listitem"><p class="simpara">
							Create certs directory and copy certificate there
						</p><pre class="screen">$ mkdir -p quay/config/extra_ca_certs
$ cp storage.crt quay/config/extra_ca_certs/
$ tree quay/config/
├── config.yaml
├── extra_ca_certs
│   ├── storage.crt</pre></li><li class="listitem"><p class="simpara">
							Obtain the <code class="literal">Quay</code> container’s <code class="literal">CONTAINER ID</code> with <code class="literal">podman ps</code>:
						</p><pre class="screen">$ sudo podman ps
CONTAINER ID        IMAGE                                COMMAND                  CREATED             STATUS              PORTS
5a3e82c4a75f        &lt;registry&gt;/&lt;repo&gt;/quay:v3.9.0 "/sbin/my_init"          24 hours ago        Up 18 hours         0.0.0.0:80-&gt;80/tcp, 0.0.0.0:443-&gt;443/tcp, 443/tcp   grave_keller</pre></li><li class="listitem"><p class="simpara">
							Restart the container with that ID:
						</p><pre class="screen">$ sudo podman restart 5a3e82c4a75f</pre></li><li class="listitem"><p class="simpara">
							Examine the certificate copied into the container namespace:
						</p><pre class="screen">$ sudo podman exec -it 5a3e82c4a75f cat /etc/ssl/certs/storage.pem
-----BEGIN CERTIFICATE-----
MIIDTTCCAjWgAwIBAgIJAMVr9ngjJhzbMA0GCSqGSIb3DQEBCwUAMD0xCzAJBgNV</pre></li></ol></div></section></section><section class="section" id="config-fields-ldap"><div class="titlepage"><div><div><h2 class="title">2.14. LDAP configuration fields</h2></div></div></div><div class="table" id="idm45384241691296"><p class="title"><strong>Table 2.12. LDAP configuration</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45384241685536" scope="col">Field</th><th align="left" valign="top" id="idm45384241684448" scope="col">Type</th><th align="left" valign="top" id="idm45384242759600" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45384241685536">
							<p>
								<span class="strong strong"><strong>AUTHENTICATION_TYPE</strong></span><br/> (Required)
							</p>
							</td><td align="left" valign="top" headers="idm45384241684448">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384242759600">
							<p>
								Must be set to <code class="literal">LDAP</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384241685536">
							<p>
								<span class="strong strong"><strong>FEATURE_TEAM_SYNCING</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384241684448">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45384242759600">
							<p>
								Whether to allow for team membership to be synced from a backing group in the authentication engine (LDAP or Keystone)<br/><br/><span class="strong strong"><strong>Default:</strong></span> <code class="literal">true</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384241685536">
							<p>
								<span class="strong strong"><strong>FEATURE_NONSUPERUSER_TEAM_SYNCING_SETUP</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384241684448">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45384242759600">
							<p>
								If enabled, non-superusers can setup syncing on teams using LDAP<br/><br/><span class="strong strong"><strong>Default:</strong></span> <code class="literal">false</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384241685536">
							<p>
								<span class="strong strong"><strong>LDAP_ADMIN_DN</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384241684448">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384242759600">
							<p>
								The admin DN for LDAP authentication.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384241685536">
							<p>
								<span class="strong strong"><strong>LDAP_ADMIN_PASSWD</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384241684448">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384242759600">
							<p>
								The admin password for LDAP authentication.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384241685536">
							<p>
								<span class="strong strong"><strong>LDAP_ALLOW_INSECURE_FALLBACK</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384241684448">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45384242759600">
							<p>
								Whether or not to allow SSL insecure fallback for LDAP authentication.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384241685536">
							<p>
								<span class="strong strong"><strong>LDAP_BASE_DN</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384241684448">
							<p>
								Array of String
							</p>
							</td><td align="left" valign="top" headers="idm45384242759600">
							<p>
								The base DN for LDAP authentication.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384241685536">
							<p>
								<span class="strong strong"><strong>LDAP_EMAIL_ATTR</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384241684448">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384242759600">
							<p>
								The email attribute for LDAP authentication.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384241685536">
							<p>
								<span class="strong strong"><strong>LDAP_UID_ATTR</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384241684448">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384242759600">
							<p>
								The uid attribute for LDAP authentication.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384241685536">
							<p>
								<span class="strong strong"><strong>LDAP_URI</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384241684448">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384242759600">
							<p>
								The LDAP URI.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384241685536">
							<p>
								<span class="strong strong"><strong>LDAP_USER_FILTER</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384241684448">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384242759600">
							<p>
								The user filter for LDAP authentication.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384241685536">
							<p>
								<span class="strong strong"><strong>LDAP_USER_RDN</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384241684448">
							<p>
								Array of String
							</p>
							</td><td align="left" valign="top" headers="idm45384242759600">
							<p>
								The user RDN for LDAP authentication.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384241685536">
							<p>
								<span class="strong strong"><strong>TEAM_RESYNC_STALE_TIME</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384241684448">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384242759600">
							<p>
								If team syncing is enabled for a team, how often to check its membership and resync if necessary<br/><br/><span class="strong strong"><strong>Pattern:</strong></span><br/><code class="literal">^[0-9]+(w|m|d|h|s)$</code><br/><span class="strong strong"><strong>Example:</strong></span><br/><code class="literal">2h</code><br/><span class="strong strong"><strong>Default:</strong></span><br/><code class="literal">30m</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384241685536">
							<p>
								<span class="strong strong"><strong>LDAP_SUPERUSER_FILTER</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384241684448">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384242759600">
							<p>
								Subset of the <code class="literal">LDAP_USER_FILTER</code> configuration field. When configured, allows Red Hat Quay administrators the ability to configure Lightweight Directory Access Protocol (LDAP) users as superusers when Red Hat Quay uses LDAP as its authentication provider.
							</p>
							<p>
								With this field, administrators can add or remove superusers without having to update the Red Hat Quay configuration file and restart their deployment.
							</p>
							<p>
								This field requires that your <code class="literal">AUTHENTICATION_TYPE</code> is set to <code class="literal">LDAP</code>.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384241685536">
							<p>
								<span class="strong strong"><strong>LDAP_RESTRICTED_USER_FILTER</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384241684448">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384242759600">
							<p>
								Subset of the <code class="literal">LDAP_USER_FILTER</code> configuration field. When configured, allows Red Hat Quay administrators the ability to configure Lightweight Directory Access Protocol (LDAP) users as restricted users when Red Hat Quay uses LDAP as its authentication provider.
							</p>
							<p>
								This field requires that your <code class="literal">AUTHENTICATION_TYPE</code> is set to <code class="literal">LDAP</code>.
							</p>
							</td></tr></tbody></table></div></div><section class="section" id="ldap-config-field-reference"><div class="titlepage"><div><div><h3 class="title">2.14.1. LDAP configuration field references</h3></div></div></div><p>
					Use the following references to update your <code class="literal">config.yaml</code> file with the desired configuration field.
				</p><section class="section" id="reference-ldap-user"><div class="titlepage"><div><div><h4 class="title">2.14.1.1. Basic LDAP user configuration</h4></div></div></div><pre class="programlisting language-yaml">---
AUTHENTICATION_TYPE: LDAP
---
LDAP_ADMIN_DN: uid=testuser,ou=Users,o=orgid,dc=jumpexamplecloud,dc=com
LDAP_ADMIN_PASSWD: samplepassword
LDAP_ALLOW_INSECURE_FALLBACK: false
LDAP_BASE_DN:
    - o=orgid
    - dc=example
    - dc=com
LDAP_EMAIL_ATTR: mail
LDAP_UID_ATTR: uid
LDAP_URI: ldap://ldap.example.com:389
LDAP_USER_RDN:
    - ou=Users</pre></section><section class="section" id="reference-ldap-restricted-user"><div class="titlepage"><div><div><h4 class="title">2.14.1.2. LDAP restricted user configuration</h4></div></div></div><pre class="programlisting language-yaml">---
AUTHENTICATION_TYPE: LDAP
---
LDAP_ADMIN_DN: uid=&lt;name&gt;,ou=Users,o=&lt;organization_id&gt;,dc=&lt;example_domain_component&gt;,dc=com
LDAP_ADMIN_PASSWD: ABC123
LDAP_ALLOW_INSECURE_FALLBACK: false
LDAP_BASE_DN:
    - o=&lt;organization_id&gt;
    - dc=&lt;example_domain_component&gt;
    - dc=com
LDAP_EMAIL_ATTR: mail
LDAP_UID_ATTR: uid
LDAP_URI: ldap://&lt;example_url&gt;.com
LDAP_USER_FILTER: (memberof=cn=developers,ou=Users,o=&lt;example_organization_unit&gt;,dc=&lt;example_domain_component&gt;,dc=com)
LDAP_RESTRICTED_USER_FILTER: (&lt;filterField&gt;=&lt;value&gt;)
LDAP_USER_RDN:
    - ou=&lt;example_organization_unit&gt;
    - o=&lt;organization_id&gt;
    - dc=&lt;example_domain_component&gt;
    - dc=com
---</pre></section><section class="section" id="reference-ldap-super-user"><div class="titlepage"><div><div><h4 class="title">2.14.1.3. LDAP superuser configuration reference</h4></div></div></div><pre class="programlisting language-yaml">---
AUTHENTICATION_TYPE: LDAP
---
LDAP_ADMIN_DN: uid=&lt;name&gt;,ou=Users,o=&lt;organization_id&gt;,dc=&lt;example_domain_component&gt;,dc=com
LDAP_ADMIN_PASSWD: ABC123
LDAP_ALLOW_INSECURE_FALLBACK: false
LDAP_BASE_DN:
    - o=&lt;organization_id&gt;
    - dc=&lt;example_domain_component&gt;
    - dc=com
LDAP_EMAIL_ATTR: mail
LDAP_UID_ATTR: uid
LDAP_URI: ldap://&lt;example_url&gt;.com
LDAP_USER_FILTER: (memberof=cn=developers,ou=Users,o=&lt;example_organization_unit&gt;,dc=&lt;example_domain_component&gt;,dc=com)
LDAP_SUPERUSER_FILTER: (&lt;filterField&gt;=&lt;value&gt;)
LDAP_USER_RDN:
    - ou=&lt;example_organization_unit&gt;
    - o=&lt;organization_id&gt;
    - dc=&lt;example_domain_component&gt;
    - dc=com</pre></section></section></section><section class="section" id="config-fields-mirroring"><div class="titlepage"><div><div><h2 class="title">2.15. Mirroring configuration fields</h2></div></div></div><div class="table" id="idm45384244034416"><p class="title"><strong>Table 2.13. Mirroring configuration</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45384244028656" scope="col">Field</th><th align="left" valign="top" id="idm45384246587600" scope="col">Type</th><th align="left" valign="top" id="idm45384246586512" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45384244028656">
							<p>
								<span class="strong strong"><strong>FEATURE_REPO_MIRROR</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384246587600">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45384246586512">
							<p>
								Enable or disable repository mirroring<br/><br/> <span class="strong strong"><strong>Default:</strong></span> <code class="literal">false</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384244028656">
							<p>
								<span class="strong strong"><strong>REPO_MIRROR_INTERVAL</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384246587600">
							<p>
								Number
							</p>
							</td><td align="left" valign="top" headers="idm45384246586512">
							<p>
								The number of seconds between checking for repository mirror candidates<br/><br/><span class="strong strong"><strong>Default:</strong></span> 30
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384244028656">
							<p>
								<span class="strong strong"><strong>REPO_MIRROR_SERVER_HOSTNAME</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384246587600">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384246586512">
							<p>
								Replaces the <code class="literal">SERVER_HOSTNAME</code> as the destination for mirroring. <br/><br/><span class="strong strong"><strong>Default:</strong></span> None<br/><br/><span class="strong strong"><strong>Example</strong></span>:<br/><code class="literal">openshift-quay-service</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384244028656">
							<p>
								<span class="strong strong"><strong>REPO_MIRROR_TLS_VERIFY</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384246587600">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45384246586512">
							<p>
								Require HTTPS and verify certificates of Quay registry during mirror.<br/><br/> <span class="strong strong"><strong>Default:</strong></span> <code class="literal">false</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384244028656">
							<p>
								<span class="strong strong"><strong>REPO_MIRROR_ROLLBACK</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384246587600">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45384246586512">
							<p>
								When set to <code class="literal">true</code>, the repository rolls back after a failed mirror attempt.
							</p>
							<p>
								<span class="strong strong"><strong>Default</strong></span>: <code class="literal">false</code>
							</p>
							</td></tr></tbody></table></div></div></section><section class="section" id="config-fields-scanner"><div class="titlepage"><div><div><h2 class="title">2.16. Security scanner configuration fields</h2></div></div></div><div class="table" id="idm45384244563248"><p class="title"><strong>Table 2.14. Security scanner configuration</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45384244557472" scope="col">Field</th><th align="left" valign="top" id="idm45384244556384" scope="col">Type</th><th align="left" valign="top" id="idm45384248431296" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45384244557472">
							<p>
								<span class="strong strong"><strong>FEATURE_SECURITY_SCANNER</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384244556384">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45384248431296">
							<p>
								Enable or disable the security scanner<br/><br/> <span class="strong strong"><strong>Default:</strong></span> <code class="literal">false</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384244557472">
							<p>
								<span class="strong strong"><strong>FEATURE_SECURITY_NOTIFICATIONS</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384244556384">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45384248431296">
							<p>
								If the security scanner is enabled, turn on or turn off security notifications<br/><br/> <span class="strong strong"><strong>Default:</strong></span> <code class="literal">false</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384244557472">
							<p>
								<span class="strong strong"><strong>SECURITY_SCANNER_V4_REINDEX_THRESHOLD</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384244556384">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384248431296">
							<p>
								This parameter is used to determine the minimum time, in seconds, to wait before re-indexing a manifest that has either previously failed or has changed states since the last indexing. The data is calculated from the <code class="literal">last_indexed datetime</code> in the <span class="strong strong"><strong>manifestsecuritystatus</strong></span> table. This parameter is used to avoid trying to re-index every failed manifest on every indexing run. The default time to re-index is 300 seconds.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384244557472">
							<p>
								<span class="strong strong"><strong>SECURITY_SCANNER_V4_ENDPOINT</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384244556384">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384248431296">
							<p>
								The endpoint for the V4 security scanner<br/><br/><span class="strong strong"><strong>Pattern:</strong></span><br/><code class="literal">^http(s)?://(.)+$</code><br/><br/><span class="strong strong"><strong>Example:</strong></span><br/><code class="literal"><a class="link" href="http://192.168.99.101:6060">http://192.168.99.101:6060</a></code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384244557472">
							<p>
								<span class="strong strong"><strong>SECURITY_SCANNER_V4_PSK</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384244556384">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384248431296">
							<p>
								The generated pre-shared key (PSK) for Clair
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384244557472">
							<p>
								<span class="strong strong"><strong>SECURITY_SCANNER_INDEXING_INTERVAL</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384244556384">
							<p>
								Number
							</p>
							</td><td align="left" valign="top" headers="idm45384248431296">
							<p>
								The number of seconds between indexing intervals in the security scanner<br/><br/><span class="strong strong"><strong>Default:</strong></span> 30
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384244557472">
							<p>
								<span class="strong strong"><strong>SECURITY_SCANNER_ENDPOINT</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384244556384">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384248431296">
							<p>
								The endpoint for the V2 security scanner<br/><br/><span class="strong strong"><strong>Pattern:</strong></span><br/><code class="literal">^http(s)?://(.)+$</code><br/><br/><span class="strong strong"><strong>Example:</strong></span><br/><code class="literal"><a class="link" href="http://192.168.99.100:6060">http://192.168.99.100:6060</a></code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384244557472">
							<p>
								<span class="strong strong"><strong>SECURITY_SCANNER_INDEXING_INTERVAL</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384244556384">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384248431296">
							<p>
								This parameter is used to determine the number of seconds between indexing intervals in the security scanner. When indexing is triggered, Red Hat Quay will query its database for manifests that must be indexed by Clair. These include manifests that have not yet been indexed and manifests that previously failed indexing.
							</p>
							</td></tr></tbody></table></div></div><p>
				The following is a special case for re-indexing:
			</p><p>
				When Clair v4 indexes a manifest, the result should be deterministic. For example, the same manifest should produce the same index report. This is true until the scanners are changed, as using different scanners will produce different information relating to a specific manifest to be returned in the report. Because of this, Clair v4 exposes a state representation of the indexing engine (<code class="literal">/indexer/api/v1/index_state</code>) to determine whether the scanner configuration has been changed.
			</p><p>
				Red Hat Quay leverages this index state by saving it to the index report when parsing to Quay’s database. If this state has changed since the manifest was previously scanned, Quay will attempt to re-index that manifest during the periodic indexing process.
			</p><p>
				By default this parameter is set to 30 seconds. Users might decrease the time if they want the indexing process to run more frequently, for example, if they did not want to wait 30 seconds to see security scan results in the UI after pushing a new tag. Users can also change the parameter if they want more control over the request pattern to Clair and the pattern of database operations being performed on the Quay database.
			</p></section><section class="section" id="config-fields-helm-oci"><div class="titlepage"><div><div><h2 class="title">2.17. OCI and Helm configuration fields</h2></div></div></div><p>
				Support for Helm is now supported under the <code class="literal">FEATURE_GENERAL_OCI_SUPPORT</code> property. If you need to explicitly enable the feature, for example, if it has previously been disabled or if you have upgraded from a version where it is not enabled by default, you need to add two properties in the Quay configuration to enable the use of OCI artifacts:
			</p><pre class="programlisting language-yaml">FEATURE_GENERAL_OCI_SUPPORT: true
FEATURE_HELM_OCI_SUPPORT: true</pre><div class="table" id="idm45384244631232"><p class="title"><strong>Table 2.15. OCI and Helm configuration fields</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45384244625456" scope="col">Field</th><th align="left" valign="top" id="idm45384244624368" scope="col">Type</th><th align="left" valign="top" id="idm45384244623280" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45384244625456">
							<p>
								<span class="strong strong"><strong>FEATURE_GENERAL_OCI_SUPPORT</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384244624368">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45384244623280">
							<p>
								Enable support for OCI artifacts<br/><br/><span class="strong strong"><strong>Default:</strong></span> True
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384244625456">
							<p>
								<span class="strong strong"><strong>FEATURE_HELM_OCI_SUPPORT</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384244624368">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45384244623280">
							<p>
								Enable support for Helm artifacts<br/><br/><span class="strong strong"><strong>Default:</strong></span> True
							</p>
							</td></tr></tbody></table></div></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					As of Red Hat Quay 3.6, <code class="literal">FEATURE_HELM_OCI_SUPPORT</code> has been deprecated and will be removed in a future version of Red Hat Quay. In Red Hat Quay 3.6, Helm artifacts are supported by default and included under the <code class="literal">FEATURE_GENERAL_OCI_SUPPORT</code> property. Users are no longer required to update their config.yaml files to enable support.
				</p></div></div></section><section class="section" id="config-fields-actionlog"><div class="titlepage"><div><div><h2 class="title">2.18. Action log configuration fields</h2></div></div></div><section class="section" id="action_log_storage_configuration"><div class="titlepage"><div><div><h3 class="title">2.18.1. Action log storage configuration</h3></div></div></div><div class="table" id="idm45384242958192"><p class="title"><strong>Table 2.16. Action log storage configuration</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45384242952416" scope="col">Field</th><th align="left" valign="top" id="idm45384242951328" scope="col">Type</th><th align="left" valign="top" id="idm45384242950240" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45384242952416">
								<p>
									<span class="strong strong"><strong>FEATURE_LOG_EXPORT</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384242951328">
								<p>
									Boolean
								</p>
								</td><td align="left" valign="top" headers="idm45384242950240">
								<p>
									Whether to allow exporting of action logs<br/><br/><span class="strong strong"><strong>Default:</strong></span> <code class="literal">True</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384242952416">
								<p>
									<span class="strong strong"><strong>LOGS_MODEL</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384242951328">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384242950240">
								<p>
									Enable or disable the security scanner<br/><br/><span class="strong strong"><strong>Values:</strong></span> One of <code class="literal">database</code>, <code class="literal">transition_reads_both_writes_es</code>, <code class="literal">elasticsearch</code><br/><span class="strong strong"><strong>Default:</strong></span> <code class="literal">database</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384242952416">
								<p>
									<span class="strong strong"><strong>LOGS_MODEL_CONFIG</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384242951328">
								<p>
									Object
								</p>
								</td><td align="left" valign="top" headers="idm45384242950240">
								<p>
									Logs model config for action logs
								</p>
								</td></tr></tbody></table></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							<span class="strong strong"><strong>LOGS_MODEL_CONFIG</strong></span> [object]: Logs model config for action logs
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p class="simpara">
									<span class="strong strong"><strong>elasticsearch_config</strong></span> [object]: Elasticsearch cluster configuration
								</p><div class="itemizedlist"><ul class="itemizedlist" type="square"><li class="listitem"><p class="simpara">
											<span class="strong strong"><strong>access_key</strong></span> [string]: Elasticsearch user (or IAM key for AWS ES)
										</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
													<span class="strong strong"><strong>Example</strong></span>: <code class="literal">some_string</code>
												</li></ul></div></li><li class="listitem"><p class="simpara">
											<span class="strong strong"><strong>host</strong></span> [string]: Elasticsearch cluster endpoint
										</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
													<span class="strong strong"><strong>Example</strong></span>: <code class="literal">host.elasticsearch.example</code>
												</li></ul></div></li><li class="listitem"><p class="simpara">
											<span class="strong strong"><strong>index_prefix</strong></span> [string]: Elasticsearch’s index prefix
										</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
													<span class="strong strong"><strong>Example</strong></span>: <code class="literal">logentry_</code>
												</li></ul></div></li><li class="listitem">
											<span class="strong strong"><strong>index_settings</strong></span> [object]: Elasticsearch’s index settings
										</li><li class="listitem"><p class="simpara">
											<span class="strong strong"><strong>use_ssl</strong></span> [boolean]: Use ssl for Elasticsearch. Defaults to True
										</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
													<span class="strong strong"><strong>Example</strong></span>: <code class="literal">True</code>
												</li></ul></div></li><li class="listitem"><p class="simpara">
											<span class="strong strong"><strong>secret_key</strong></span> [string]: Elasticsearch password (or IAM secret for AWS ES)
										</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
													<span class="strong strong"><strong>Example</strong></span>: <code class="literal">some_secret_string</code>
												</li></ul></div></li><li class="listitem"><p class="simpara">
											<span class="strong strong"><strong>aws_region</strong></span> [string]: Amazon web service region
										</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
													<span class="strong strong"><strong>Example</strong></span>: <code class="literal">us-east-1</code>
												</li></ul></div></li><li class="listitem"><p class="simpara">
											<span class="strong strong"><strong>port</strong></span> [number]: Elasticsearch cluster endpoint port
										</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
													<span class="strong strong"><strong>Example</strong></span>: <code class="literal">1234</code>
												</li></ul></div></li></ul></div></li><li class="listitem"><p class="simpara">
									<span class="strong strong"><strong>kinesis_stream_config</strong></span> [object]: AWS Kinesis Stream configuration
								</p><div class="itemizedlist"><ul class="itemizedlist" type="square"><li class="listitem"><p class="simpara">
											<span class="strong strong"><strong>aws_secret_key</strong></span> [string]: AWS secret key
										</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
													<span class="strong strong"><strong>Example</strong></span>: <code class="literal">some_secret_key</code>
												</li></ul></div></li><li class="listitem"><p class="simpara">
											<span class="strong strong"><strong>stream_name</strong></span> [string]: Kinesis stream to send action logs to
										</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
													<span class="strong strong"><strong>Example</strong></span>: <code class="literal">logentry-kinesis-stream</code>
												</li></ul></div></li><li class="listitem"><p class="simpara">
											<span class="strong strong"><strong>aws_access_key</strong></span> [string]: AWS access key
										</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
													<span class="strong strong"><strong>Example</strong></span>: <code class="literal">some_access_key</code>
												</li></ul></div></li><li class="listitem"><p class="simpara">
											<span class="strong strong"><strong>retries</strong></span> [number]: Max number of attempts made on a single request
										</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
													<span class="strong strong"><strong>Example</strong></span>: <code class="literal">5</code>
												</li></ul></div></li><li class="listitem"><p class="simpara">
											<span class="strong strong"><strong>read_timeout</strong></span> [number]: Number of seconds before timeout when reading from a connection
										</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
													<span class="strong strong"><strong>Example</strong></span>: <code class="literal">5</code>
												</li></ul></div></li><li class="listitem"><p class="simpara">
											<span class="strong strong"><strong>max_pool_connections</strong></span> [number]: The maximum number of connections to keep in a connection pool
										</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
													<span class="strong strong"><strong>Example</strong></span>: <code class="literal">10</code>
												</li></ul></div></li><li class="listitem"><p class="simpara">
											<span class="strong strong"><strong>aws_region</strong></span> [string]: AWS region
										</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
													<span class="strong strong"><strong>Example</strong></span>: <code class="literal">us-east-1</code>
												</li></ul></div></li><li class="listitem"><p class="simpara">
											<span class="strong strong"><strong>connect_timeout</strong></span> [number]: Number of seconds before timeout when attempting to make a connection
										</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
													<span class="strong strong"><strong>Example</strong></span>: <code class="literal">5</code>
												</li></ul></div></li></ul></div></li><li class="listitem"><p class="simpara">
									<span class="strong strong"><strong>producer</strong></span> [string]: Logs producer if logging to Elasticsearch
								</p><div class="itemizedlist"><ul class="itemizedlist" type="square"><li class="listitem">
											<span class="strong strong"><strong>enum</strong></span>: kafka, elasticsearch, kinesis_stream
										</li><li class="listitem">
											<span class="strong strong"><strong>Example</strong></span>: <code class="literal">kafka</code>
										</li></ul></div></li><li class="listitem"><p class="simpara">
									<span class="strong strong"><strong>kafka_config</strong></span> [object]: Kafka cluster configuration
								</p><div class="itemizedlist"><ul class="itemizedlist" type="square"><li class="listitem"><p class="simpara">
											<span class="strong strong"><strong>topic</strong></span> [string]: Kafka topic to publish log entries to
										</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
													<span class="strong strong"><strong>Example</strong></span>: <code class="literal">logentry</code>
												</li></ul></div></li><li class="listitem">
											<span class="strong strong"><strong>bootstrap_servers</strong></span> [array]: List of Kafka brokers to bootstrap the client from
										</li><li class="listitem"><p class="simpara">
											<span class="strong strong"><strong>max_block_seconds</strong></span> [number]: Max number of seconds to block during a <code class="literal">send()</code>, either because the buffer is full or metadata unavailable
										</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
													<span class="strong strong"><strong>Example</strong></span>: <code class="literal">10</code>
												</li></ul></div></li></ul></div></li></ul></div></li></ul></div></section><section class="section" id="action_log_rotation_and_archiving_configuration"><div class="titlepage"><div><div><h3 class="title">2.18.2. Action log rotation and archiving configuration</h3></div></div></div><div class="table" id="idm45384241658240"><p class="title"><strong>Table 2.17. Action log rotation and archiving configuration</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45384241652448" scope="col">Field</th><th align="left" valign="top" id="idm45384241651360" scope="col">Type</th><th align="left" valign="top" id="idm45384241650272" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45384241652448">
								<p>
									<span class="strong strong"><strong>FEATURE_ACTION_LOG_ROTATION</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384241651360">
								<p>
									Boolean
								</p>
								</td><td align="left" valign="top" headers="idm45384241650272">
								<p>
									Enabling log rotation and archival will move all logs older than 30 days to storage<br/><br/><span class="strong strong"><strong>Default:</strong></span> <code class="literal">false</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384241652448">
								<p>
									<span class="strong strong"><strong>ACTION_LOG_ARCHIVE_LOCATION</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384241651360">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384241650272">
								<p>
									If action log archiving is enabled, the storage engine in which to place the archived data<br/><br/><span class="strong strong"><strong>Example:</strong></span>: <code class="literal">s3_us_east</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384241652448">
								<p>
									<span class="strong strong"><strong>ACTION_LOG_ARCHIVE_PATH</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384241651360">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384241650272">
								<p>
									If action log archiving is enabled, the path in storage in which to place the archived data<br/><br/><span class="strong strong"><strong>Example:</strong></span> <code class="literal">archives/actionlogs</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384241652448">
								<p>
									<span class="strong strong"><strong>ACTION_LOG_ROTATION_THRESHOLD</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384241651360">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384241650272">
								<p>
									The time interval after which to rotate logs<br/><br/><span class="strong strong"><strong>Example:</strong></span> <code class="literal">30d</code>
								</p>
								</td></tr></tbody></table></div></div></section></section><section class="section" id="config-fields-build-logs"><div class="titlepage"><div><div><h2 class="title">2.19. Build logs configuration fields</h2></div></div></div><div class="table" id="idm45384244402656"><p class="title"><strong>Table 2.18. Build logs configuration fields</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45384246467760" scope="col">Field</th><th align="left" valign="top" id="idm45384246466672" scope="col">Type</th><th align="left" valign="top" id="idm45384246465584" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45384246467760">
							<p>
								<span class="strong strong"><strong>FEATURE_READER_BUILD_LOGS</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384246466672">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45384246465584">
							<p>
								If set to true, build logs may be read by those with read access to the repo, rather than only write access or admin access.<br/><br/><span class="strong strong"><strong>Default:</strong></span> <code class="literal">False</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384246467760">
							<p>
								<span class="strong strong"><strong>LOG_ARCHIVE_LOCATION</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384246466672">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384246465584">
							<p>
								The storage location, defined in DISTRIBUTED_STORAGE_CONFIG, in which to place the archived build logs<br/><br/><span class="strong strong"><strong>Example:</strong></span> <code class="literal">s3_us_east</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384246467760">
							<p>
								<span class="strong strong"><strong>LOG_ARCHIVE_PATH</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384246466672">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384246465584">
							<p>
								The path under the configured storage engine in which to place the archived build logs in JSON form<br/><br/><span class="strong strong"><strong>Example:</strong></span> <code class="literal">archives/buildlogs</code>
							</p>
							</td></tr></tbody></table></div></div></section><section class="section" id="config-fields-dockerfile-build"><div class="titlepage"><div><div><h2 class="title">2.20. Dockerfile build triggers fields</h2></div></div></div><div class="table" id="idm45384246679840"><p class="title"><strong>Table 2.19. Dockerfile build support</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45384243731264" scope="col">Field</th><th align="left" valign="top" id="idm45384243730176" scope="col">Type</th><th align="left" valign="top" id="idm45384243729088" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45384243731264">
							<p>
								<span class="strong strong"><strong>FEATURE_BUILD_SUPPORT</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384243730176">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45384243729088">
							<p>
								Whether to support Dockerfile build. <br/><br/><span class="strong strong"><strong>Default:</strong></span> False
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384243731264">
							<p>
								<span class="strong strong"><strong>SUCCESSIVE_TRIGGER_FAILURE_DISABLE_THRESHOLD</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384243730176">
							<p>
								Number
							</p>
							</td><td align="left" valign="top" headers="idm45384243729088">
							<p>
								If not None, the number of successive failures that can occur before a build trigger is automatically disabled<br/><br/><span class="strong strong"><strong>Default:</strong></span> 100
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384243731264">
							<p>
								<span class="strong strong"><strong>SUCCESSIVE_TRIGGER_INTERNAL_ERROR_DISABLE_THRESHOLD</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384243730176">
							<p>
								Number
							</p>
							</td><td align="left" valign="top" headers="idm45384243729088">
							<p>
								If not None, the number of successive internal errors that can occur before a build trigger is automatically disabled<br/><br/><span class="strong strong"><strong>Default:</strong></span> 5
							</p>
							</td></tr></tbody></table></div></div><section class="section" id="github_build_triggers"><div class="titlepage"><div><div><h3 class="title">2.20.1. GitHub build triggers</h3></div></div></div><div class="table" id="idm45384245954880"><p class="title"><strong>Table 2.20. GitHub build triggers</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45384245949120" scope="col">Field</th><th align="left" valign="top" id="idm45384245948032" scope="col">Type</th><th align="left" valign="top" id="idm45384244319216" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45384245949120">
								<p>
									<span class="strong strong"><strong>FEATURE_GITHUB_BUILD</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384245948032">
								<p>
									Boolean
								</p>
								</td><td align="left" valign="top" headers="idm45384244319216">
								<p>
									Whether to support GitHub build triggers<br/><br/><span class="strong strong"><strong>Default:</strong></span> False
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384245949120">
								<p>
									 
								</p>
								</td><td align="left" valign="top" headers="idm45384245948032">
								<p>
									 
								</p>
								</td><td align="left" valign="top" headers="idm45384244319216">
								<p>
									 
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384245949120">
								<p>
									<span class="strong strong"><strong>GITHUB_TRIGGER_CONFIG</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384245948032">
								<p>
									Object
								</p>
								</td><td align="left" valign="top" headers="idm45384244319216">
								<p>
									Configuration for using GitHub (Enterprise) for build triggers
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384245949120">
								<p>
									   <span class="strong strong"><strong>.GITHUB_ENDPOINT</strong></span><br/>    (Required)
								</p>
								</td><td align="left" valign="top" headers="idm45384245948032">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384244319216">
								<p>
									The endpoint for GitHub (Enterprise)<br/><br/><span class="strong strong"><strong>Example:</strong></span> <code class="literal"><a class="link" href="https://github.com/">https://github.com/</a></code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384245949120">
								<p>
									   <span class="strong strong"><strong>.API_ENDPOINT</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384245948032">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384244319216">
								<p>
									The endpoint of the GitHub (Enterprise) API to use. Must be overridden for <code class="literal">github.com</code><br/><br/><span class="strong strong"><strong>Example</strong></span>: <code class="literal"><a class="link" href="https://api.github.com/">https://api.github.com/</a></code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384245949120">
								<p>
									   <span class="strong strong"><strong>.CLIENT_ID</strong></span> <br/>    (Required)
								</p>
								</td><td align="left" valign="top" headers="idm45384245948032">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384244319216">
								<p>
									The registered client ID for this Red Hat Quay instance; this cannot be shared with GITHUB_LOGIN_CONFIG.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384245949120">
								<p>
									   <span class="strong strong"><strong>.CLIENT_SECRET</strong></span><br/>    (Required)
								</p>
								</td><td align="left" valign="top" headers="idm45384245948032">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384244319216">
								<p>
									The registered client secret for this Red Hat Quay instance.
								</p>
								</td></tr></tbody></table></div></div></section><section class="section" id="bitbucket_build_triggers"><div class="titlepage"><div><div><h3 class="title">2.20.2. BitBucket build triggers</h3></div></div></div><div class="table" id="idm45384245258560"><p class="title"><strong>Table 2.21. BitBucket build triggers</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45384244904656" scope="col">Field</th><th align="left" valign="top" id="idm45384244903568" scope="col">Type</th><th align="left" valign="top" id="idm45384244902480" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45384244904656">
								<p>
									<span class="strong strong"><strong>FEATURE_BITBUCKET_BUILD</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384244903568">
								<p>
									Boolean
								</p>
								</td><td align="left" valign="top" headers="idm45384244902480">
								<p>
									Whether to support Bitbucket build triggers<br/><br/><span class="strong strong"><strong>Default:</strong></span> False
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384244904656">
								<p>
									 
								</p>
								</td><td align="left" valign="top" headers="idm45384244903568">
								<p>
									 
								</p>
								</td><td align="left" valign="top" headers="idm45384244902480">
								<p>
									 
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384244904656">
								<p>
									<span class="strong strong"><strong>BITBUCKET_TRIGGER_CONFIG</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384244903568">
								<p>
									Object
								</p>
								</td><td align="left" valign="top" headers="idm45384244902480">
								<p>
									Configuration for using BitBucket for build triggers
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384244904656">
								<p>
									   <span class="strong strong"><strong>.CONSUMER_KEY</strong></span><br/>    (Required)
								</p>
								</td><td align="left" valign="top" headers="idm45384244903568">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384244902480">
								<p>
									The registered consumer key (client ID) for this Quay instance
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384244904656">
								<p>
									   <span class="strong strong"><strong>.CONSUMER_SECRET</strong></span><br/>    (Required)
								</p>
								</td><td align="left" valign="top" headers="idm45384244903568">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384244902480">
								<p>
									The registered consumer secret (client secret) for this Quay instance
								</p>
								</td></tr></tbody></table></div></div></section><section class="section" id="gitlab_build_triggers"><div class="titlepage"><div><div><h3 class="title">2.20.3. GitLab build triggers</h3></div></div></div><div class="table" id="idm45384245930128"><p class="title"><strong>Table 2.22. GitLab build triggers</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45384246673856" scope="col">Field</th><th align="left" valign="top" id="idm45384246672768" scope="col">Type</th><th align="left" valign="top" id="idm45384246671680" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45384246673856">
								<p>
									<span class="strong strong"><strong>FEATURE_GITLAB_BUILD</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384246672768">
								<p>
									Boolean
								</p>
								</td><td align="left" valign="top" headers="idm45384246671680">
								<p>
									Whether to support GitLab build triggers<br/><br/><span class="strong strong"><strong>Default:</strong></span> False
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384246673856">
								<p>
									 
								</p>
								</td><td align="left" valign="top" headers="idm45384246672768">
								<p>
									 
								</p>
								</td><td align="left" valign="top" headers="idm45384246671680">
								<p>
									 
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384246673856">
								<p>
									<span class="strong strong"><strong>GITLAB_TRIGGER_CONFIG</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384246672768">
								<p>
									Object
								</p>
								</td><td align="left" valign="top" headers="idm45384246671680">
								<p>
									Configuration for using Gitlab for build triggers
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384246673856">
								<p>
									   <span class="strong strong"><strong>.GITLAB_ENDPOINT</strong></span><br/>    (Required)
								</p>
								</td><td align="left" valign="top" headers="idm45384246672768">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384246671680">
								<p>
									The endpoint at which Gitlab (Enterprise) is running
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384246673856">
								<p>
									   <span class="strong strong"><strong>.CLIENT_ID</strong></span><br/>    (Required)
								</p>
								</td><td align="left" valign="top" headers="idm45384246672768">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384246671680">
								<p>
									The registered client ID for this Quay instance
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384246673856">
								<p>
									   <span class="strong strong"><strong>.CLIENT_SECRET</strong></span><br/>    (Required)
								</p>
								</td><td align="left" valign="top" headers="idm45384246672768">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384246671680">
								<p>
									The registered client secret for this Quay instance
								</p>
								</td></tr></tbody></table></div></div></section></section><section class="section" id="config-fields-oauth"><div class="titlepage"><div><div><h2 class="title">2.21. OAuth configuration fields</h2></div></div></div><div class="table" id="idm45384246570144"><p class="title"><strong>Table 2.23. OAuth fields</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45384246564384" scope="col">Field</th><th align="left" valign="top" id="idm45384246563296" scope="col">Type</th><th align="left" valign="top" id="idm45384246562208" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45384246564384">
							<p>
								<span class="strong strong"><strong>DIRECT_OAUTH_CLIENTID_WHITELIST</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384246563296">
							<p>
								Array of String
							</p>
							</td><td align="left" valign="top" headers="idm45384246562208">
							<p>
								A list of client IDs for <span class="strong strong"><strong>Quay-managed</strong></span> applications that are allowed to perform direct OAuth approval without user approval.
							</p>
							</td></tr></tbody></table></div></div><section class="section" id="github_oauth_configuration_fields"><div class="titlepage"><div><div><h3 class="title">2.21.1. GitHub OAuth configuration fields</h3></div></div></div><div class="table" id="idm45384244341296"><p class="title"><strong>Table 2.24. GitHub OAuth fields</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45384244335536" scope="col">Field</th><th align="left" valign="top" id="idm45384244334448" scope="col">Type</th><th align="left" valign="top" id="idm45384244333360" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45384244335536">
								<p>
									<span class="strong strong"><strong>FEATURE_GITHUB_LOGIN</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384244334448">
								<p>
									Boolean
								</p>
								</td><td align="left" valign="top" headers="idm45384244333360">
								<p>
									Whether GitHub login is supported<br/><br/> **Default: <code class="literal">False</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384244335536">
								<p>
									<span class="strong strong"><strong>GITHUB_LOGIN_CONFIG</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384244334448">
								<p>
									Object
								</p>
								</td><td align="left" valign="top" headers="idm45384244333360">
								<p>
									Configuration for using GitHub (Enterprise) as an external login provider.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384244335536">
								<p>
									   <span class="strong strong"><strong>.ALLOWED_ORGANIZATIONS</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384244334448">
								<p>
									Array of String
								</p>
								</td><td align="left" valign="top" headers="idm45384244333360">
								<p>
									The names of the GitHub (Enterprise) organizations whitelisted to work with the ORG_RESTRICT option.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384244335536">
								<p>
									   <span class="strong strong"><strong>.API_ENDPOINT</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384244334448">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384244333360">
								<p>
									The endpoint of the GitHub (Enterprise) API to use. Must be overridden for github.com<br/><br/><span class="strong strong"><strong>Example:</strong></span> <code class="literal"><a class="link" href="https://api.github.com/">https://api.github.com/</a></code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384244335536">
								<p>
									   <span class="strong strong"><strong>.CLIENT_ID</strong></span><br/>    (Required)
								</p>
								</td><td align="left" valign="top" headers="idm45384244334448">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384244333360">
								<p>
									The registered client ID for this Red Hat Quay instance; cannot be shared with GITHUB_TRIGGER_CONFIG<br/><br/><span class="strong strong"><strong>Example:</strong></span> <code class="literal">0e8dbe15c4c7630b6780</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384244335536">
								<p>
									   <span class="strong strong"><strong>.CLIENT_SECRET</strong></span><br/>    (Required)
								</p>
								</td><td align="left" valign="top" headers="idm45384244334448">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384244333360">
								<p>
									The registered client secret for this Red Hat Quay instance<br/><br/><span class="strong strong"><strong>Example:</strong></span> <code class="literal">e4a58ddd3d7408b7aec109e85564a0d153d3e846</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384244335536">
								<p>
									   <span class="strong strong"><strong>.GITHUB_ENDPOINT</strong></span> <br/>    (Required)
								</p>
								</td><td align="left" valign="top" headers="idm45384244334448">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384244333360">
								<p>
									The endpoint for GitHub (Enterprise)<br/><br/><span class="strong strong"><strong>Example</strong></span>: <code class="literal"><a class="link" href="https://github.com/">https://github.com/</a></code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384244335536">
								<p>
									   <span class="strong strong"><strong>.ORG_RESTRICT</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384244334448">
								<p>
									Boolean
								</p>
								</td><td align="left" valign="top" headers="idm45384244333360">
								<p>
									If true, only users within the organization whitelist can login using this provider.
								</p>
								</td></tr></tbody></table></div></div></section><section class="section" id="google_oauth_configuration_fields"><div class="titlepage"><div><div><h3 class="title">2.21.2. Google OAuth configuration fields</h3></div></div></div><div class="table" id="idm45384243945376"><p class="title"><strong>Table 2.25. Google OAuth fields</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45384243939616" scope="col">Field</th><th align="left" valign="top" id="idm45384243938528" scope="col">Type</th><th align="left" valign="top" id="idm45384243937440" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45384243939616">
								<p>
									<span class="strong strong"><strong>FEATURE_GOOGLE_LOGIN</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384243938528">
								<p>
									Boolean
								</p>
								</td><td align="left" valign="top" headers="idm45384243937440">
								<p>
									Whether Google login is supported<br/><br/> **Default: <code class="literal">False</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384243939616">
								<p>
									<span class="strong strong"><strong>GOOGLE_LOGIN_CONFIG</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384243938528">
								<p>
									Object
								</p>
								</td><td align="left" valign="top" headers="idm45384243937440">
								<p>
									Configuration for using Google for external authentication
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384243939616">
								<p>
									   <span class="strong strong"><strong>.CLIENT_ID</strong></span><br/>    (Required)
								</p>
								</td><td align="left" valign="top" headers="idm45384243938528">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384243937440">
								<p>
									The registered client ID for this Red Hat Quay instance<br/><br/><span class="strong strong"><strong>Example:</strong></span> <code class="literal">0e8dbe15c4c7630b6780</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384243939616">
								<p>
									   <span class="strong strong"><strong>.CLIENT_SECRET</strong></span><br/>    (Required)
								</p>
								</td><td align="left" valign="top" headers="idm45384243938528">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384243937440">
								<p>
									The registered client secret for this Red Hat Quay instance<br/><br/><span class="strong strong"><strong>Example:</strong></span> e4a58ddd3d7408b7aec109e85564a0d153d3e846
								</p>
								</td></tr></tbody></table></div></div></section></section><section class="section" id="config-fields-nested-repositories"><div class="titlepage"><div><div><h2 class="title">2.22. Nested repositories configuration fields</h2></div></div></div><p>
				With Red Hat Quay 3.6, support for nested repository path names has been added under the <code class="literal">FEATURE_EXTENDED_REPOSITORY_NAMES</code> property. This optional configuration is added to the config.yaml by default. Enablement allows the use of <code class="literal">/</code> in repository names.
			</p><pre class="programlisting language-yaml">FEATURE_EXTENDED_REPOSITORY_NAMES: true</pre><div class="table" id="idm45384245086288"><p class="title"><strong>Table 2.26. OCI and nested repositories configuration fields</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45384245080496" scope="col">Field</th><th align="left" valign="top" id="idm45384245079408" scope="col">Type</th><th align="left" valign="top" id="idm45384245078320" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45384245080496">
							<p>
								<span class="strong strong"><strong>FEATURE_EXTENDED_REPOSITORY_NAMES</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384245079408">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45384245078320">
							<p>
								Enable support for nested repositories<br/><br/><span class="strong strong"><strong>Default:</strong></span> True
							</p>
							</td></tr></tbody></table></div></div></section><section class="section" id="other-oci-artifacts-with-quay"><div class="titlepage"><div><div><h2 class="title">2.23. Adding other OCI media types to Quay</h2></div></div></div><p>
				Helm, cosign, and ztsd compression scheme artifacts are built into Red Hat Quay 3.6 by default. For any other OCI media type that is not supported by default, you can add them to the <code class="literal">ALLOWED_OCI_ARTIFACT_TYPES</code> configuration in Quay’s config.yaml using the following format:
			</p><pre class="literallayout">ALLOWED_OCI_ARTIFACT_TYPES:
  &lt;oci config type 1&gt;:
  - &lt;oci layer type 1&gt;
  - &lt;oci layer type 2&gt;

  &lt;oci config type 2&gt;:
  - &lt;oci layer type 3&gt;
  - &lt;oci layer type 4&gt;
...</pre><p>
				For example, you can add Singularity (SIF) support by adding the following to your config.yaml:
			</p><pre class="literallayout">...
ALLOWED_OCI_ARTIFACT_TYPES:
  application/vnd.oci.image.config.v1+json:
  - application/vnd.dev.cosign.simplesigning.v1+json
  application/vnd.cncf.helm.config.v1+json:
  - application/tar+gzip
  application/vnd.sylabs.sif.config.v1+json:
  - application/vnd.sylabs.sif.layer.v1+tar
...</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					When adding OCI media types that are not configured by default, users will also need to manually add support for cosign and Helm if desired. The ztsd compression scheme is supported by default, so users will not need to add that OCI media type to their config.yaml to enable support.
				</p></div></div></section><section class="section" id="config-fields-mail"><div class="titlepage"><div><div><h2 class="title">2.24. Mail configuration fields</h2></div></div></div><div class="table" id="idm45384248396896"><p class="title"><strong>Table 2.27. Mail configuration fields</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45384248391120" scope="col">Field</th><th align="left" valign="top" id="idm45384248390032" scope="col">Type</th><th align="left" valign="top" id="idm45384248388944" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45384248391120">
							<p>
								<span class="strong strong"><strong>FEATURE_MAILING</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384248390032">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45384248388944">
							<p>
								Whether emails are enabled<br/><br/><span class="strong strong"><strong>Default:</strong></span> <code class="literal">False</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384248391120">
							<p>
								<span class="strong strong"><strong>MAIL_DEFAULT_SENDER</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384248390032">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384248388944">
							<p>
								If specified, the e-mail address used as the <code class="literal">from</code> when Red Hat Quay sends e-mails. If none, defaults to <code class="literal">support@quay.io</code><br/><br/><span class="strong strong"><strong>Example:</strong></span> <code class="literal">support@example.com</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384248391120">
							<p>
								<span class="strong strong"><strong>MAIL_PASSWORD</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384248390032">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384248388944">
							<p>
								The SMTP password to use when sending e-mails
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384248391120">
							<p>
								<span class="strong strong"><strong>MAIL_PORT</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384248390032">
							<p>
								Number
							</p>
							</td><td align="left" valign="top" headers="idm45384248388944">
							<p>
								The SMTP port to use. If not specified, defaults to 587.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384248391120">
							<p>
								<span class="strong strong"><strong>MAIL_SERVER</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384248390032">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384248388944">
							<p>
								The SMTP server to use for sending e-mails. Only required if FEATURE_MAILING is set to true.<br/><br/><span class="strong strong"><strong>Example:</strong></span> <code class="literal">smtp.example.com</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384248391120">
							<p>
								<span class="strong strong"><strong>MAIL_USERNAME</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384248390032">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384248388944">
							<p>
								The SMTP username to use when sending e-mails
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384248391120">
							<p>
								<span class="strong strong"><strong>MAIL_USE_TLS</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384248390032">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45384248388944">
							<p>
								If specified, whether to use TLS for sending e-mails<br/><br/><span class="strong strong"><strong>Default:</strong></span> <code class="literal">True</code>
							</p>
							</td></tr></tbody></table></div></div></section><section class="section" id="config-fields-user"><div class="titlepage"><div><div><h2 class="title">2.25. User configuration fields</h2></div></div></div><div class="table" id="idm45384243158960"><p class="title"><strong>Table 2.28. User configuration fields</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45384248343904" scope="col">Field</th><th align="left" valign="top" id="idm45384248342816" scope="col">Type</th><th align="left" valign="top" id="idm45384248341728" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45384248343904">
							<p>
								<span class="strong strong"><strong>FEATURE_SUPER_USERS</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384248342816">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45384248341728">
							<p>
								Whether superusers are supported<br/><br/><span class="strong strong"><strong>Default:</strong></span> <code class="literal">true</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384248343904">
							<p>
								<span class="strong strong"><strong>FEATURE_USER_CREATION</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384248342816">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45384248341728">
							<p>
								Whether users can be created (by non-superusers)<br/><br/> <span class="strong strong"><strong>Default:</strong></span> <code class="literal">true</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384248343904">
							<p>
								<span class="strong strong"><strong>FEATURE_USER_LAST_ACCESSED</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384248342816">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45384248341728">
							<p>
								Whether to record the last time a user was accessed<br/><br/><span class="strong strong"><strong>Default:</strong></span> <code class="literal">true</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384248343904">
							<p>
								<span class="strong strong"><strong>FEATURE_USER_LOG_ACCESS</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384248342816">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45384248341728">
							<p>
								If set to true, users will have access to audit logs for their namespace<br/><br/><span class="strong strong"><strong>Default:</strong></span> <code class="literal">false</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384248343904">
							<p>
								<span class="strong strong"><strong>FEATURE_USER_METADATA</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384248342816">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45384248341728">
							<p>
								Whether to collect and support user metadata<br/><br/><span class="strong strong"><strong>Default:</strong></span> <code class="literal">false</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384248343904">
							<p>
								<span class="strong strong"><strong>FEATURE_USERNAME_CONFIRMATION</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384248342816">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45384248341728">
							<p>
								If set to true, users can confirm and modify their initial usernames when logging in via OpenID Connect (OIDC) or a non-database internal authentication provider like LDAP. <br/><span class="strong strong"><strong>Default:</strong></span> <code class="literal">true</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384248343904">
							<p>
								<span class="strong strong"><strong>FEATURE_USER_RENAME</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384248342816">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45384248341728">
							<p>
								If set to true, users can rename their own namespace<br/><br/><span class="strong strong"><strong>Default:</strong></span> <code class="literal">false</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384248343904">
							<p>
								<span class="strong strong"><strong>FEATURE_INVITE_ONLY_USER_CREATION</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384248342816">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45384248341728">
							<p>
								Whether users being created must be invited by another user<br/><br/><span class="strong strong"><strong>Default:</strong></span> <code class="literal">false</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384248343904">
							<p>
								<span class="strong strong"><strong>FRESH_LOGIN_TIMEOUT</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384248342816">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384248341728">
							<p>
								The time after which a fresh login requires users to re-enter their password<br/><br/><span class="strong strong"><strong>Example</strong></span>: <code class="literal">5m</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384248343904">
							<p>
								<span class="strong strong"><strong>USERFILES_LOCATION</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384248342816">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384248341728">
							<p>
								ID of the storage engine in which to place user-uploaded files<br/><br/><span class="strong strong"><strong>Example</strong></span>: <code class="literal">s3_us_east</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384248343904">
							<p>
								<span class="strong strong"><strong>USERFILES_PATH</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384248342816">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384248341728">
							<p>
								Path under storage in which to place user-uploaded files<br/><br/><span class="strong strong"><strong>Example</strong></span>: <code class="literal">userfiles</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384248343904">
							<p>
								<span class="strong strong"><strong>USER_RECOVERY_TOKEN_LIFETIME</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384248342816">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384248341728">
							<p>
								The length of time a token for recovering a user accounts is valid<br/><br/><span class="strong strong"><strong>Pattern</strong></span>: <code class="literal">^[0-9]+(w|m|d|h|s)$</code><br/><span class="strong strong"><strong>Default</strong></span>: <code class="literal">30m</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384248343904">
							<p>
								<span class="strong strong"><strong>FEATURE_SUPERUSERS_FULL_ACCESS</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384248342816">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45384248341728">
							<p>
								Grants superusers the ability to read, write, and delete content from other repositories in namespaces that they do not own or have explicit permissions for.
							</p>
							<p>
								<span class="strong strong"><strong>Default:</strong></span> <code class="literal">False</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384248343904">
							<p>
								<span class="strong strong"><strong>FEATURE_RESTRICTED_USERS</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384248342816">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45384248341728">
							<p>
								When set with <code class="literal">RESTRICTED_USERS_WHITELIST</code>, restricted users cannot create organizations or content in their own namespace. Normal permissions apply for an organization’s membership, for example, a restricted user will still have normal permissions in organizations based on the teams that they are members of.
							</p>
							<p>
								<span class="strong strong"><strong>Default:</strong></span> <code class="literal">False</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384248343904">
							<p>
								<span class="strong strong"><strong>RESTRICTED_USERS_WHITELIST</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384248342816">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384248341728">
							<p>
								When set with <code class="literal">FEATURE_RESTRICTED_USERS: true</code>, specific users are excluded from the <code class="literal">FEATURE_RESTRICTED_USERS</code> setting.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384248343904">
							<p>
								<span class="strong strong"><strong>GLOBAL_READONLY_SUPER_USERS</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384248342816">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384248341728">
							<p>
								When set, grants users of this list read access to all repositories, regardless of whether they are public repositories.
							</p>
							</td></tr></tbody></table></div></div><section class="section" id="user-config-field-reference"><div class="titlepage"><div><div><h3 class="title">2.25.1. User configuration fields references</h3></div></div></div><p>
					Use the following references to update your <code class="literal">config.yaml</code> file with the desired configuration field.
				</p><section class="section" id="configuring-superusers-full-access"><div class="titlepage"><div><div><h4 class="title">2.25.1.1. FEATURE_SUPERUSERS_FULL_ACCESS configuration reference</h4></div></div></div><pre class="programlisting language-yaml">---
SUPER_USERS:
- quayadmin
FEATURE_SUPERUSERS_FULL_ACCESS: True
---</pre></section><section class="section" id="configuring-global-readonly-super-users"><div class="titlepage"><div><div><h4 class="title">2.25.1.2. GLOBAL_READONLY_SUPER_USERS configuration reference</h4></div></div></div><pre class="programlisting language-yaml">---
GLOBAL_READONLY_SUPER_USERS:
      - user1
---</pre></section><section class="section" id="configuring-feature-restricted-users"><div class="titlepage"><div><div><h4 class="title">2.25.1.3. FEATURE_RESTRICTED_USERS configuration reference</h4></div></div></div><pre class="programlisting language-yaml">---
AUTHENTICATION_TYPE: Database
---
---
FEATURE_RESTRICTED_USERS: true
---</pre></section><section class="section" id="configuring-restricted-users-whitelist"><div class="titlepage"><div><div><h4 class="title">2.25.1.4. RESTRICTED_USERS_WHITELIST configuration reference</h4></div></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								<code class="literal">FEATURE_RESTRICTED_USERS</code> is set to <code class="literal">true</code> in your <code class="literal">config.yaml</code> file.
							</li></ul></div><pre class="programlisting language-yaml">---
AUTHENTICATION_TYPE: Database
---
---
FEATURE_RESTRICTED_USERS: true
RESTRICTED_USERS_WHITELIST:
      - user1
---</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							When this field is set, whitelisted users can create organizations, or read or write content from the repository even if <code class="literal">FEATURE_RESTRICTED_USERS</code> is set to <code class="literal">true</code>. Other users, for example, <code class="literal">user2</code>, <code class="literal">user3</code>, and <code class="literal">user4</code> are restricted from creating organizations, reading, or writing content
						</p></div></div></section></section></section><section class="section" id="config-fields-recaptcha"><div class="titlepage"><div><div><h2 class="title">2.26. Recaptcha configuration fields</h2></div></div></div><div class="table" id="idm45384246606144"><p class="title"><strong>Table 2.29. Recaptcha configuration fields</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45384246600368" scope="col">Field</th><th align="left" valign="top" id="idm45384246599280" scope="col">Type</th><th align="left" valign="top" id="idm45384246598192" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45384246600368">
							<p>
								<span class="strong strong"><strong>FEATURE_RECAPTCHA</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384246599280">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45384246598192">
							<p>
								Whether Recaptcha is necessary for user login and recovery<br/><br/> <span class="strong strong"><strong>Default:</strong></span> False
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384246600368">
							<p>
								<span class="strong strong"><strong>RECAPTCHA_SECRET_KEY</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384246599280">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384246598192">
							<p>
								If recaptcha is enabled, the secret key for the Recaptcha service
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384246600368">
							<p>
								<span class="strong strong"><strong>RECAPTCHA_SITE_KEY</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384246599280">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384246598192">
							<p>
								If recaptcha is enabled, the site key for the Recaptcha service
							</p>
							</td></tr></tbody></table></div></div></section><section class="section" id="config-fields-aci"><div class="titlepage"><div><div><h2 class="title">2.27. ACI configuration fields</h2></div></div></div><div class="table" id="idm45384241359328"><p class="title"><strong>Table 2.30. ACI configuration fields</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45384241353552" scope="col">Field</th><th align="left" valign="top" id="idm45384241352464" scope="col">Type</th><th align="left" valign="top" id="idm45384242333184" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45384241353552">
							<p>
								<span class="strong strong"><strong>FEATURE_ACI_CONVERSION</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384241352464">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45384242333184">
							<p>
								Whether to enable conversion to ACIs <br/> <br/><span class="strong strong"><strong>Default:</strong></span> False
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384241353552">
							<p>
								<span class="strong strong"><strong>GPG2_PRIVATE_KEY_FILENAME</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384241352464">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384242333184">
							<p>
								The filename of the private key used to decrypte ACIs
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384241353552">
							<p>
								<span class="strong strong"><strong>GPG2_PRIVATE_KEY_NAME</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384241352464">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384242333184">
							<p>
								The name of the private key used to sign ACIs
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384241353552">
							<p>
								<span class="strong strong"><strong>GPG2_PUBLIC_KEY_FILENAME</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384241352464">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384242333184">
							<p>
								The filename of the public key used to encrypt ACIs
							</p>
							</td></tr></tbody></table></div></div></section><section class="section" id="config-fields-jwt"><div class="titlepage"><div><div><h2 class="title">2.28. JWT configuration fields</h2></div></div></div><div class="table" id="idm45384244925872"><p class="title"><strong>Table 2.31. JWT configuration fields</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45384244920096" scope="col">Field</th><th align="left" valign="top" id="idm45384244919008" scope="col">Type</th><th align="left" valign="top" id="idm45384244917920" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45384244920096">
							<p>
								<span class="strong strong"><strong>JWT_AUTH_ISSUER</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384244919008">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384244917920">
							<p>
								The endpoint for JWT users<br/><br/><span class="strong strong"><strong>Pattern</strong></span>: <code class="literal">^http(s)?://(.)+$</code><br/><span class="strong strong"><strong>Example</strong></span>: <code class="literal"><a class="link" href="http://192.168.99.101:6060">http://192.168.99.101:6060</a></code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384244920096">
							<p>
								<span class="strong strong"><strong>JWT_GETUSER_ENDPOINT</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384244919008">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384244917920">
							<p>
								The endpoint for JWT users<br/><span class="strong strong"><strong>Pattern</strong></span>: <code class="literal">^http(s)?://(.)+$</code><br/><span class="strong strong"><strong>Example</strong></span>: <code class="literal"><a class="link" href="http://192.168.99.101:6060">http://192.168.99.101:6060</a></code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384244920096">
							<p>
								<span class="strong strong"><strong>JWT_QUERY_ENDPOINT</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384244919008">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384244917920">
							<p>
								The endpoint for JWT queries<br/><br/><span class="strong strong"><strong>Pattern</strong></span>: <code class="literal">^http(s)?://(.)+$</code><br/><span class="strong strong"><strong>Example</strong></span>: <code class="literal"><a class="link" href="http://192.168.99.101:6060">http://192.168.99.101:6060</a></code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384244920096">
							<p>
								<span class="strong strong"><strong>JWT_VERIFY_ENDPOINT</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384244919008">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384244917920">
							<p>
								The endpoint for JWT verification<br/><br/><span class="strong strong"><strong>Pattern</strong></span>: <code class="literal">^http(s)?://(.)+$</code><br/><span class="strong strong"><strong>Example</strong></span>: <code class="literal"><a class="link" href="http://192.168.99.101:6060">http://192.168.99.101:6060</a></code>
							</p>
							</td></tr></tbody></table></div></div></section><section class="section" id="config-fields-app-tokens"><div class="titlepage"><div><div><h2 class="title">2.29. App tokens configuration fields</h2></div></div></div><div class="table" id="idm45384245110224"><p class="title"><strong>Table 2.32. App tokens configuration fields</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45384245104448" scope="col">Field</th><th align="left" valign="top" id="idm45384245103360" scope="col">Type</th><th align="left" valign="top" id="idm45384245102272" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45384245104448">
							<p>
								<span class="strong strong"><strong>FEATURE_APP_SPECIFIC_TOKENS</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384245103360">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45384245102272">
							<p>
								If enabled, users can create tokens for use by the Docker CLI<br/> <br/><span class="strong strong"><strong>Default:</strong></span> True
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384245104448">
							<p>
								<span class="strong strong"><strong>APP_SPECIFIC_TOKEN_EXPIRATION</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384245103360">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384245102272">
							<p>
								The expiration for external app tokens.<br/><br/><span class="strong strong"><strong>Default</strong></span> None<br/><span class="strong strong"><strong>Pattern:</strong></span> <code class="literal">^[0-9]+(w|m|d|h|s)$</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384245104448">
							<p>
								<span class="strong strong"><strong>EXPIRED_APP_SPECIFIC_TOKEN_GC</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384245103360">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384245102272">
							<p>
								Duration of time expired external app tokens will remain before being garbage collected<br/><br/><span class="strong strong"><strong>Default:</strong></span> 1d
							</p>
							</td></tr></tbody></table></div></div></section><section class="section" id="config-fields-misc"><div class="titlepage"><div><div><h2 class="title">2.30. Miscellaneous configuration fields</h2></div></div></div><div class="table" id="idm45384242716704"><p class="title"><strong>Table 2.33. Miscellaneous configuration fields</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45384242710928" scope="col">Field</th><th align="left" valign="top" id="idm45384242709840" scope="col">Type</th><th align="left" valign="top" id="idm45384242708752" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45384242710928">
							<p>
								<span class="strong strong"><strong>ALLOW_PULLS_WITHOUT_STRICT_LOGGING</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384242709840">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384242708752">
							<p>
								If true, pulls will still succeed even if the pull audit log entry cannot be written . This is useful if the database is in a read-only state and it is desired for pulls to continue during that time.<br/><br/> <span class="strong strong"><strong>Default:</strong></span> False
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384242710928">
							<p>
								<span class="strong strong"><strong>AVATAR_KIND</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384242709840">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384242708752">
							<p>
								The types of avatars to display, either generated inline (local) or Gravatar (gravatar)<br/><br/> <span class="strong strong"><strong>Values:</strong></span> local, gravatar
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384242710928">
							<p>
								<span class="strong strong"><strong>BROWSER_API_CALLS_XHR_ONLY</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384242709840">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45384242708752">
							<p>
								If enabled, only API calls marked as being made by an XHR will be allowed from browsers<br/><br/><span class="strong strong"><strong>Default:</strong></span> True
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384242710928">
							<p>
								<span class="strong strong"><strong>DEFAULT_NAMESPACE_MAXIMUM_BUILD_COUNT</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384242709840">
							<p>
								Number
							</p>
							</td><td align="left" valign="top" headers="idm45384242708752">
							<p>
								The default maximum number of builds that can be queued in a namespace.<br/><br/><span class="strong strong"><strong>Default:</strong></span> None
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384242710928">
							<p>
								<span class="strong strong"><strong>ENABLE_HEALTH_DEBUG_SECRET</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384242709840">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384242708752">
							<p>
								If specified, a secret that can be given to health endpoints to see full debug info when not authenticated as a superuser
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384242710928">
							<p>
								<span class="strong strong"><strong>EXTERNAL_TLS_TERMINATION</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384242709840">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45384242708752">
							<p>
								Set to <code class="literal">true</code> if TLS is supported, but terminated at a layer before Quay. Set to <code class="literal">false</code> when Quay is running with its own SSL certificates and receiving TLS traffic directly.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384242710928">
							<p>
								<span class="strong strong"><strong>FRESH_LOGIN_TIMEOUT</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384242709840">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384242708752">
							<p>
								The time after which a fresh login requires users to re-enter their password<br/><br/><span class="strong strong"><strong>Example:</strong></span> <code class="literal">5m</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384242710928">
							<p>
								<span class="strong strong"><strong>HEALTH_CHECKER</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384242709840">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384242708752">
							<p>
								The configured health check<br/><br/><span class="strong strong"><strong>Example:</strong></span> <code class="literal">('RDSAwareHealthCheck', {'access_key': 'foo', 'secret_key': 'bar'})</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384242710928">
							<p>
								<span class="strong strong"><strong>PROMETHEUS_NAMESPACE</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384242709840">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384242708752">
							<p>
								The prefix applied to all exposed Prometheus metrics<br/><br/><span class="strong strong"><strong>Default:</strong></span> <code class="literal">quay</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384242710928">
							<p>
								<span class="strong strong"><strong>PUBLIC_NAMESPACES</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384242709840">
							<p>
								Array of String
							</p>
							</td><td align="left" valign="top" headers="idm45384242708752">
							<p>
								If a namespace is defined in the public namespace list, then it will appear on <span class="strong strong"><strong>all</strong></span> users' repository list pages, regardless of whether the user is a member of the namespace. Typically, this is used by an enterprise customer in configuring a set of "well-known" namespaces.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384242710928">
							<p>
								<span class="strong strong"><strong>REGISTRY_STATE</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384242709840">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384242708752">
							<p>
								The state of the registry<br/><br/><span class="strong strong"><strong>Values:</strong></span> <code class="literal">normal</code> or <code class="literal">read-only</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384242710928">
							<p>
								<span class="strong strong"><strong>SEARCH_MAX_RESULT_PAGE_COUNT</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384242709840">
							<p>
								Number
							</p>
							</td><td align="left" valign="top" headers="idm45384242708752">
							<p>
								Maximum number of pages the user can paginate in search before they are limited<br/><br/><span class="strong strong"><strong>Default:</strong></span> 10
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384242710928">
							<p>
								<span class="strong strong"><strong>SEARCH_RESULTS_PER_PAGE</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384242709840">
							<p>
								Number
							</p>
							</td><td align="left" valign="top" headers="idm45384242708752">
							<p>
								Number of results returned per page by search page<br/><br/><span class="strong strong"><strong>Default:</strong></span> 10
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384242710928">
							<p>
								<span class="strong strong"><strong>V2_PAGINATION_SIZE</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384242709840">
							<p>
								Number
							</p>
							</td><td align="left" valign="top" headers="idm45384242708752">
							<p>
								The number of results returned per page in V2 registry APIs<br/><br/> <span class="strong strong"><strong>Default:</strong></span> 50
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384242710928">
							<p>
								<span class="strong strong"><strong>WEBHOOK_HOSTNAME_BLACKLIST</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384242709840">
							<p>
								Array of String
							</p>
							</td><td align="left" valign="top" headers="idm45384242708752">
							<p>
								The set of hostnames to disallow from webhooks when validating, beyond localhost
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384242710928">
							<p>
								<span class="strong strong"><strong>CREATE_PRIVATE_REPO_ON_PUSH</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384242709840">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45384242708752">
							<p>
								Whether new repositories created by push are set to private visibility<br/><br/><span class="strong strong"><strong>Default:</strong></span> True
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384242710928">
							<p>
								<span class="strong strong"><strong>CREATE_NAMESPACE_ON_PUSH</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384242709840">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45384242708752">
							<p>
								Whether new push to a non-existent organization creates it<br/><br/><span class="strong strong"><strong>Default:</strong></span> False
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384242710928">
							<p>
								<span class="strong strong"><strong>NON_RATE_LIMITED_NAMESPACES</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384242709840">
							<p>
								Array of String
							</p>
							</td><td align="left" valign="top" headers="idm45384242708752">
							<p>
								If rate limiting has been enabled using <code class="literal">FEATURE_RATE_LIMITS</code>, you can override it for specific namespace that require unlimited access.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384242710928">
							<p>
								<a class="link" href="#reference-miscellaneous-v2-ui" title="2.30.1.1. v2 user interface configuration"><span class="strong strong"><strong>FEATURE_UI_V2</strong></span></a>
							</p>
							</td><td align="left" valign="top" headers="idm45384242709840">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45384242708752">
							<p>
								When set, allows users to try the beta UI environment.
							</p>
							<p>
								<span class="strong strong"><strong>Default:</strong></span> <code class="literal">True</code>
							</p>
							</td></tr></tbody></table></div></div><section class="section" id="miscellaneous-config-field-reference"><div class="titlepage"><div><div><h3 class="title">2.30.1. Miscellaneous configuration field references</h3></div></div></div><p>
					Use the following references to update your <code class="literal">config.yaml</code> file with the desired configuration field.
				</p><section class="section" id="reference-miscellaneous-v2-ui"><div class="titlepage"><div><div><h4 class="title">2.30.1.1. v2 user interface configuration</h4></div></div></div><p>
						With <code class="literal">FEATURE_UI_V2</code> enabled, you can toggle between the current version of the user interface and the new version of the user interface.
					</p><div class="admonition important"><div class="admonition_header">Important</div><div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									This UI is currently in beta and subject to change. In its current state, users can only create, view, and delete organizations, repositories, and image tags.
								</li><li class="listitem">
									When running Red Hat Quay in the old UI, timed-out sessions would require that the user input their password again in the pop-up window. With the new UI, users are returned to the main page and required to input their username and password credentials. This is a known issue and will be fixed in a future version of the new UI.
								</li><li class="listitem">
									There is a discrepancy in how image manifest sizes are reported between the legacy UI and the new UI. In the legacy UI, image manifests were reported in mebibytes. In the new UI, Red Hat Quay uses the standard definition of megabyte (MB) to report image manifest sizes.
								</li></ul></div></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								In your deployment’s <code class="literal">config.yaml</code> file, add the <code class="literal">FEATURE_UI_V2</code> parameter and set it to <code class="literal">true</code>, for example:
							</p><pre class="programlisting language-yaml">---
FEATURE_TEAM_SYNCING: false
FEATURE_UI_V2: true
FEATURE_USER_CREATION: true
---</pre></li><li class="listitem">
								Log in to your Red Hat Quay deployment.
							</li><li class="listitem"><p class="simpara">
								In the navigation pane of your Red Hat Quay deployment, you are given the option to toggle between <span class="strong strong"><strong>Current UI</strong></span> and <span class="strong strong"><strong>New UI</strong></span>. Click the toggle button to set it to new UI, and then click <span class="strong strong"><strong>Use Beta Environment</strong></span>, for example:
							</p><p class="simpara">
								<span class="inlinemediaobject"><img src="images/38-ui-toggle.png" alt="Red Hat Quay 3.8 UI toggle"/></span>
							</p></li></ol></div><section class="section" id="creating-new-organization-v2-ui"><div class="titlepage"><div><div><h5 class="title">2.30.1.1.1. Creating a new organization in the Red Hat Quay 3.8 beta UI</h5></div></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
									You have toggled your Red Hat Quay deployment to use the 3.8 beta UI.
								</li></ul></div><p>
							Use the following procedure to create an organization using the Red Hat Quay 3.8 beta UI.
						</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
									Click <span class="strong strong"><strong>Organization</strong></span> in the navigation pane.
								</li><li class="listitem">
									Click <span class="strong strong"><strong>Create Organization</strong></span>.
								</li><li class="listitem">
									Enter an <span class="strong strong"><strong>Organization Name</strong></span>, for example, <code class="literal">testorg</code>.
								</li><li class="listitem">
									Click <span class="strong strong"><strong>Create</strong></span>.
								</li></ol></div><p>
							Now, your example organization should populate under the <span class="strong strong"><strong>Organizations</strong></span> page.
						</p></section><section class="section" id="deleting-organization-v2"><div class="titlepage"><div><div><h5 class="title">2.30.1.1.2. Deleting an organization using the Red Hat Quay 3.8 beta UI</h5></div></div></div><p>
							Use the following procedure to delete an organization using the Red Hat Quay 3.8 beta UI.
						</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
									On the <span class="strong strong"><strong>Organizations</strong></span> page, select the name of the organization you want to delete, for example, <code class="literal">testorg</code>.
								</li><li class="listitem">
									Click the <span class="strong strong"><strong>More Actions</strong></span> drop down menu.
								</li><li class="listitem"><p class="simpara">
									Click <span class="strong strong"><strong>Delete</strong></span>.
								</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
										On the <span class="strong strong"><strong>Delete</strong></span> page, there is a <span class="strong strong"><strong>Search</strong></span> input box. With this box, users can search for specific organizations to ensure that they are properly scheduled for deletion. For example, if a user is deleting 10 organizations and they want to ensure that a specific organization was deleted, they can use the <span class="strong strong"><strong>Search</strong></span> input box to confirm said organization is marked for deletion.
									</p></div></div></li><li class="listitem">
									Confirm that you want to permanently delete the organization by typing <span class="strong strong"><strong>confirm</strong></span> in the box.
								</li><li class="listitem">
									Click <span class="strong strong"><strong>Delete</strong></span>.
								</li></ol></div><p>
							After deletion, you are returned to the <span class="strong strong"><strong>Organizations</strong></span> page.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								You can delete more than one organization at a time by selecting multiple organizations, and then clicking <span class="strong strong"><strong>More Actions</strong></span> → <span class="strong strong"><strong>Delete</strong></span>.
							</p></div></div></section><section class="section" id="creating-new-repository-v2"><div class="titlepage"><div><div><h5 class="title">2.30.1.1.3. Creating a new repository using the Red Hat Quay 3.8 beta UI</h5></div></div></div><p>
							Use the following procedure to create a repository using the Red Hat Quay 3.8 beta UI.
						</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
									Click <span class="strong strong"><strong>Repositories</strong></span> on the navigation pane.
								</li><li class="listitem">
									Click <span class="strong strong"><strong>Create Repository</strong></span>.
								</li><li class="listitem">
									Select a namespace, for example, <span class="strong strong"><strong>quayadmin</strong></span>, and then enter a <span class="strong strong"><strong>Repository name</strong></span>, for example, <code class="literal">testrepo</code>.
								</li><li class="listitem">
									Click <span class="strong strong"><strong>Create</strong></span>.
								</li></ol></div><p>
							Now, your example repository should populate under the <span class="strong strong"><strong>Repositories</strong></span> page.
						</p></section><section class="section" id="deleting-repository-v2"><div class="titlepage"><div><div><h5 class="title">2.30.1.1.4. Deleting a repository using the Red Hat Quay 3.8 beta UI</h5></div></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
									You have created a repository.
								</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
									On the <span class="strong strong"><strong>Repositories</strong></span> page of the Red Hat Quay 3.8 beta UI, click the name of the image you want to delete, for example, <code class="literal">quay/admin/busybox</code>.
								</li><li class="listitem">
									Click the <span class="strong strong"><strong>More Actions</strong></span> drop-down menu.
								</li><li class="listitem"><p class="simpara">
									Click <span class="strong strong"><strong>Delete</strong></span>.
								</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
										If desired, you could click <span class="strong strong"><strong>Make Public</strong></span> or <span class="strong strong"><strong>Make Private</strong></span>.
									</p></div></div></li><li class="listitem">
									Type <span class="strong strong"><strong>confirm</strong></span> in the box, and then click <span class="strong strong"><strong>Delete</strong></span>.
								</li><li class="listitem">
									After deletion, you are returned to the <span class="strong strong"><strong>Repositories</strong></span> page.
								</li></ol></div></section><section class="section" id="pushing-image-v2"><div class="titlepage"><div><div><h5 class="title">2.30.1.1.5. Pushing an image to the Red Hat Quay 3.8 beta UI</h5></div></div></div><p>
							Use the following procedure to push an image to the Red Hat Quay 3.8 beta UI.
						</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
									Pull a sample image from an external registry:
								</p><pre class="programlisting language-terminal">$ podman pull busybox</pre></li><li class="listitem"><p class="simpara">
									Tag the image:
								</p><pre class="programlisting language-terminal">$ podman tag docker.io/library/busybox quay-server.example.com/quayadmin/busybox:test</pre></li><li class="listitem"><p class="simpara">
									Push the image to your Red Hat Quay registry:
								</p><pre class="programlisting language-terminal">$ podman push quay-server.example.com/quayadmin/busybox:test</pre></li><li class="listitem">
									Navigate to the <span class="strong strong"><strong>Repositories</strong></span> page on the Red Hat Quay UI and ensure that your image has been properly pushed.
								</li><li class="listitem">
									You can check the security details by selecting your image tag, and then navigating to the <span class="strong strong"><strong>Security Report</strong></span> page.
								</li></ol></div></section><section class="section" id="deleting-image-v2"><div class="titlepage"><div><div><h5 class="title">2.30.1.1.6. Deleting an image using the Red Hat Quay 3.8 beta UI</h5></div></div></div><p>
							Use the following procedure to delete an image using theRed Hat Quay 3.8 beta UI.
						</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
									You have pushed an image to your Red Hat Quay registry.
								</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
									On the <span class="strong strong"><strong>Repositories</strong></span> page of the Red Hat Quay 3.8 beta UI, click the name of the image you want to delete, for example, <code class="literal">quay/admin/busybox</code>.
								</li><li class="listitem">
									Click the <span class="strong strong"><strong>More Actions</strong></span> drop-down menu.
								</li><li class="listitem"><p class="simpara">
									Click <span class="strong strong"><strong>Delete</strong></span>.
								</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
										If desired, you could click <span class="strong strong"><strong>Make Public</strong></span> or <span class="strong strong"><strong>Make Private</strong></span>.
									</p></div></div></li><li class="listitem">
									Type <span class="strong strong"><strong>confirm</strong></span> in the box, and then click <span class="strong strong"><strong>Delete</strong></span>.
								</li><li class="listitem">
									After deletion, you are returned to the <span class="strong strong"><strong>Repositories</strong></span> page.
								</li></ol></div></section><section class="section" id="enabling-legacy-ui"><div class="titlepage"><div><div><h5 class="title">2.30.1.1.7. Enabling the Red Hat Quay legacy UI</h5></div></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
									In the navigation pane of your Red Hat Quay deployment, you are given the option to toggle between <span class="strong strong"><strong>Current UI</strong></span> and <span class="strong strong"><strong>New UI</strong></span>. Click the toggle button to set it to <span class="strong strong"><strong>Current UI</strong></span>.
								</p><p class="simpara">
									<span class="inlinemediaobject"><img src="images/38-ui-toggle.png" alt="Red Hat Quay 3.8 UI toggle"/></span>
								</p></li></ol></div></section></section></section></section><section class="section" id="config-fields-legacy"><div class="titlepage"><div><div><h2 class="title">2.31. Legacy configuration fields</h2></div></div></div><p>
				Some fields are deprecated or obsolete:
			</p><div class="table" id="idm45384242411152"><p class="title"><strong>Table 2.34. Legacy configuration fields</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45384244026624" scope="col">Field</th><th align="left" valign="top" id="idm45384244025648" scope="col">Type</th><th align="left" valign="top" id="idm45384244024560" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45384244026624">
							<p>
								<span class="strong strong"><strong>FEATURE_BLACKLISTED_EMAILS</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384244025648">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45384244024560">
							<p>
								If set to true, no new User accounts may be created if their email domain is blacklisted
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384244026624">
							<p>
								<span class="strong strong"><strong>BLACKLISTED_EMAIL_DOMAINS</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384244025648">
							<p>
								Array of String
							</p>
							</td><td align="left" valign="top" headers="idm45384244024560">
							<p>
								The list of email-address domains that is used if FEATURE_BLACKLISTED_EMAILS is set to true<br/><br/><span class="strong strong"><strong>Example:</strong></span> <code class="literal">"example.com", "example.org"</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384244026624">
							<p>
								<span class="strong strong"><strong>BLACKLIST_V2_SPEC</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384244025648">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384244024560">
							<p>
								The Docker CLI versions to which Red Hat Quay will respond that V2 is <span class="strong strong"><strong>unsupported</strong></span><br/><br/><span class="strong strong"><strong>Example</strong></span>: <code class="literal">&lt;1.8.0</code><br/><span class="strong strong"><strong>Default:</strong></span> <code class="literal">&lt;1.6.0</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384244026624">
							<p>
								<span class="strong strong"><strong>DOCUMENTATION_ROOT</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384244025648">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384244024560">
							<p>
								Root URL for documentation links
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384244026624">
							<p>
								<span class="strong strong"><strong>SECURITY_SCANNER_V4_NAMESPACE_WHITELIST</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384244025648">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384244024560">
							<p>
								The namespaces for which the security scanner should be enabled
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384244026624">
							<p>
								<span class="strong strong"><strong>FEATURE_RESTRICTED_V1_PUSH</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384244025648">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45384244024560">
							<p>
								If set to true, only namespaces listed in V1_PUSH_WHITELIST support V1 push<br/> <br/><span class="strong strong"><strong>Default:</strong></span> True
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384244026624">
							<p>
								<span class="strong strong"><strong>V1_PUSH_WHITELIST</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384244025648">
							<p>
								Array of String
							</p>
							</td><td align="left" valign="top" headers="idm45384244024560">
							<p>
								The array of namespace names that support V1 push if FEATURE_RESTRICTED_V1_PUSH is set to true
							</p>
							</td></tr></tbody></table></div></div></section><section class="section" id="config-fields-v2-ui"><div class="titlepage"><div><div><h2 class="title">2.32. User interface v2 configuration field</h2></div></div></div><div class="table" id="idm45384244768288"><p class="title"><strong>Table 2.35. User interface v2 configuration field</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45384246339424" scope="col">Field</th><th align="left" valign="top" id="idm45384246338336" scope="col">Type</th><th align="left" valign="top" id="idm45384246337248" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45384246339424">
							<p>
								<span class="strong strong"><strong>FEATURE_UI_V2</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384246338336">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45384246337248">
							<p>
								When set, allows users to try the beta UI environment.
							</p>
							<p>
								<span class="strong strong"><strong>Default:</strong></span> <code class="literal">False</code>
							</p>
							</td></tr></tbody></table></div></div></section><section class="section" id="config-fields-ipv6"><div class="titlepage"><div><div><h2 class="title">2.33. IPv6 configuration field</h2></div></div></div><div class="table" id="idm45384246325840"><p class="title"><strong>Table 2.36. IPv6 configuration field</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45384246320064" scope="col">Field</th><th align="left" valign="top" id="idm45384246318976" scope="col">Type</th><th align="left" valign="top" id="idm45384246317888" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45384246320064">
							<p>
								<span class="strong strong"><strong>FEATURE_LISTEN_IP_VERSION</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384246318976">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384246317888">
							<p>
								Enables IPv4, IPv6, or dual-stack protocol family. This configuration field must be properly set, otherwise Red Hat Quay fails to start.
							</p>
							<p>
								<span class="strong strong"><strong>Default:</strong></span> <code class="literal">IPv4</code>
							</p>
							<p>
								<span class="strong strong"><strong>Additional configurations:</strong></span> <code class="literal">IPv6</code>, <code class="literal">dual-stack</code>
							</p>
							</td></tr></tbody></table></div></div></section><section class="section" id="config-fields-branding"><div class="titlepage"><div><div><h2 class="title">2.34. Branding configuration fields</h2></div></div></div><div class="table" id="idm45384243094944"><p class="title"><strong>Table 2.37. Branding configuration fields</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45384243089168" scope="col">Field</th><th align="left" valign="top" id="idm45384243088080" scope="col">Type</th><th align="left" valign="top" id="idm45384243086992" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45384243089168">
							<p>
								<span class="strong strong"><strong>BRANDING</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384243088080">
							<p>
								Object
							</p>
							</td><td align="left" valign="top" headers="idm45384243086992">
							<p>
								Custom branding for logos and URLs in the Red Hat Quay UI.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384243089168">
							<p>
								<span class="strong strong"><strong>.logo</strong></span><br/> (Required)
							</p>
							</td><td align="left" valign="top" headers="idm45384243088080">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384243086992">
							<p>
								Main logo image URL.<br/>
							</p>
							<p>
								The header logo defaults to 205x30 PX. The form logo on the Red Hat Quay sign in screen of the web UI defaults to 356.5x39.7 PX. <br/><span class="strong strong"><strong>Example:</strong></span><br/><code class="literal">/static/img/quay-horizontal-color.svg</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384243089168">
							<p>
								<span class="strong strong"><strong>.footer_img</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384243088080">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384243086992">
							<p>
								Logo for UI footer. Defaults to 144x34 PX.<br/><br/><span class="strong strong"><strong>Example:</strong></span><br/><code class="literal">/static/img/RedHat.svg</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384243089168">
							<p>
								<span class="strong strong"><strong>.footer_url</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384243088080">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384243086992">
							<p>
								Link for footer image.<br/><br/><span class="strong strong"><strong>Example:</strong></span><br/><code class="literal"><a class="link" href="https://redhat.com">https://redhat.com</a></code>
							</p>
							</td></tr></tbody></table></div></div><section class="section" id="example-config-fields-branding"><div class="titlepage"><div><div><h3 class="title">2.34.1. Example configuration for Red Hat Quay branding</h3></div></div></div><div class="formalpara"><p class="title"><strong>Branding config.yaml example</strong></p><p>
						
<pre class="programlisting language-yaml">BRANDING:
    logo: https://www.mend.io/wp-content/media/2020/03/5-tips_small.jpg
    footer_img: https://www.mend.io/wp-content/media/2020/03/5-tips_small.jpg
    footer_url: https://opensourceworld.org/</pre>
					</p></div></section></section></section><section class="chapter" id="config-envar-intro"><div class="titlepage"><div><div><h1 class="title">Chapter 3. Environment variables</h1></div></div></div><p>
			Red Hat Quay supports a limited number of environment variables for dynamic configuration.
		</p><section class="section" id="config-envvar-georepl"><div class="titlepage"><div><div><h2 class="title">3.1. Geo-replication</h2></div></div></div><p>
				The exact same configuration should be used across all regions, with exception of the storage backend, which can be configured explicitly using the <code class="literal">QUAY_DISTRIBUTED_STORAGE_PREFERENCE</code> environment variable.
			</p><div class="table" id="idm45384244735872"><p class="title"><strong>Table 3.1. Geo-replication configuration</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45384244730096" scope="col">Variable</th><th align="left" valign="top" id="idm45384244729008" scope="col">Type</th><th align="left" valign="top" id="idm45384244727920" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45384244730096">
							<p>
								<span class="strong strong"><strong>QUAY_DISTRIBUTED_STORAGE_PREFERENCE</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384244729008">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45384244727920">
							<p>
								The preferred storage engine (by ID in DISTRIBUTED_STORAGE_CONFIG) to use.
							</p>
							</td></tr></tbody></table></div></div></section><section class="section" id="config-envvar-dbpool"><div class="titlepage"><div><div><h2 class="title">3.2. Database connection pooling</h2></div></div></div><p>
				Red Hat Quay is composed of many different processes which all run within the same container. Many of these processes interact with the database.
			</p><p>
				If enabled, each process that interacts with the database will contain a connection pool. These per-process connection pools are configured to maintain a maximum of 20 connections. Under heavy load, it is possible to fill the connection pool for every process within a Red Hat Quay container. Under certain deployments and loads, this may require analysis to ensure Red Hat Quay does not exceed the database’s configured maximum connection count.
			</p><p>
				Overtime, the connection pools will release idle connections. To release all connections immediately, Red Hat Quay requires a restart.
			</p><p>
				Database connection pooling may be toggled by setting the environment variable DB_CONNECTION_POOLING={true|false}
			</p><div class="table" id="idm45384244715040"><p class="title"><strong>Table 3.2. Database connection pooling configuration</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45384244709248" scope="col">Variable</th><th align="left" valign="top" id="idm45384243359664" scope="col">Type</th><th align="left" valign="top" id="idm45384243358576" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45384244709248">
							<p>
								<span class="strong strong"><strong>DB_CONNECTION_POOLING</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384243359664">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45384243358576">
							<p>
								Enable or disable database connection pooling
							</p>
							</td></tr></tbody></table></div></div><p>
				If database connection pooling is enabled, it is possible to change the maximum size of the connection pool. This can be done through the following config.yaml option:
			</p><div class="formalpara"><p class="title"><strong>config.yaml</strong></p><p>
					
<pre class="programlisting language-yaml">...
DB_CONNECTION_ARGS:
  max_connections: 10
...</pre>
				</p></div></section><section class="section" id="config-envvar-worker-connection"><div class="titlepage"><div><div><h2 class="title">3.3. HTTP connection counts</h2></div></div></div><p>
				It is possible to specify the quantity of simultaneous HTTP connections using environment variables. These can be specified as a whole, or for a specific component. The default for each is 50 parallel connections per process.
			</p><div class="table" id="idm45384243345024"><p class="title"><strong>Table 3.3. HTTP connection counts configuration</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45384243339296" scope="col">Variable</th><th align="left" valign="top" id="idm45384243338208" scope="col">Type</th><th align="left" valign="top" id="idm45384243337120" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45384243339296">
							<p>
								<span class="strong strong"><strong>WORKER_CONNECTION_COUNT</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384243338208">
							<p>
								Number
							</p>
							</td><td align="left" valign="top" headers="idm45384243337120">
							<p>
								Simultaneous HTTP connections <br/><br/><span class="strong strong"><strong>Default:</strong></span> 50
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384243339296">
							<p>
								<span class="strong strong"><strong>WORKER_CONNECTION_COUNT_REGISTRY</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384243338208">
							<p>
								Number
							</p>
							</td><td align="left" valign="top" headers="idm45384243337120">
							<p>
								Simultaneous HTTP connections for registry<br/><br/><span class="strong strong"><strong>Default:</strong></span> WORKER_CONNECTION_COUNT
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384243339296">
							<p>
								<span class="strong strong"><strong>WORKER_CONNECTION_COUNT_WEB</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384243338208">
							<p>
								Number
							</p>
							</td><td align="left" valign="top" headers="idm45384243337120">
							<p>
								Simultaneous HTTP connections for web UI<br/><br/><span class="strong strong"><strong>Default:</strong></span> WORKER_CONNECTION_COUNT
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384243339296">
							<p>
								<span class="strong strong"><strong>WORKER_CONNECTION_COUNT_SECSCAN</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384243338208">
							<p>
								Number
							</p>
							</td><td align="left" valign="top" headers="idm45384243337120">
							<p>
								Simultaneous HTTP connections for Clair<br/><br/><span class="strong strong"><strong>Default:</strong></span> WORKER_CONNECTION_COUNT
							</p>
							</td></tr></tbody></table></div></div></section><section class="section" id="config-envvar-worker-count"><div class="titlepage"><div><div><h2 class="title">3.4. Worker count variables</h2></div></div></div><div class="table" id="idm45384245229856"><p class="title"><strong>Table 3.4. Worker count variables</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45384245224096" scope="col">Variable</th><th align="left" valign="top" id="idm45384245223008" scope="col">Type</th><th align="left" valign="top" id="idm45384245221920" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45384245224096">
							<p>
								<span class="strong strong"><strong>WORKER_COUNT</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384245223008">
							<p>
								Number
							</p>
							</td><td align="left" valign="top" headers="idm45384245221920">
							<p>
								Generic override for number of processes
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384245224096">
							<p>
								<span class="strong strong"><strong>WORKER_COUNT_REGISTRY</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384245223008">
							<p>
								Number
							</p>
							</td><td align="left" valign="top" headers="idm45384245221920">
							<p>
								Specifies the number of processes to handle Registry requests within the <code class="literal">Quay</code> container<br/><br/><span class="strong strong"><strong>Values:</strong></span> Integer between 8 and 64
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384245224096">
							<p>
								<span class="strong strong"><strong>WORKER_COUNT_WEB</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384245223008">
							<p>
								Number
							</p>
							</td><td align="left" valign="top" headers="idm45384245221920">
							<p>
								Specifies the number of processes to handle UI/Web requests within the container<br/><br/> <span class="strong strong"><strong>Values:</strong></span> Integer between 2 and 32
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45384245224096">
							<p>
								<span class="strong strong"><strong>WORKER_COUNT_SECSCAN</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45384245223008">
							<p>
								Number
							</p>
							</td><td align="left" valign="top" headers="idm45384245221920">
							<p>
								Specifies the number of processes to handle Security Scanning (e.g. Clair) integration within the container<br/><br/><span class="strong strong"><strong>Values:</strong></span> Integer between 2 and 4
							</p>
							</td></tr></tbody></table></div></div></section></section><section class="chapter" id="operator-config-ui"><div class="titlepage"><div><div><h1 class="title">Chapter 4. Using the config tool to reconfigure Quay on OpenShift</h1></div></div></div><section class="section" id="operator-config-ui-access"><div class="titlepage"><div><div><h2 class="title">4.1. Accessing the config editor</h2></div></div></div><p>
				In the Details section of the QuayRegistry screen, the endpoint for the config editor is available, along with a link to the secret containing the credentials for logging into the config editor:
			</p><p>
				<span class="inlinemediaobject"><img src="images/config-editor-details-openshift.png" alt="Config editor details"/></span>
			</p><section class="section" id="retrieving_the_config_editor_credentials"><div class="titlepage"><div><div><h3 class="title">4.1.1. Retrieving the config editor credentials</h3></div></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Click on the link for the config editor secret:
						</p><p class="simpara">
							<span class="inlinemediaobject"><img src="images/config-editor-secret.png" alt="Config editor secret"/></span>
						</p></li><li class="listitem"><p class="simpara">
							In the Data section of the Secret details screen, click <code class="literal">Reveal values</code> to see the credentials for logging in to the config editor:
						</p><p class="simpara">
							<span class="inlinemediaobject"><img src="images/config-editor-secret-reveal.png" alt="Config editor secret reveal"/></span>
						</p></li></ol></div></section><section class="section" id="logging_in_to_the_config_editor"><div class="titlepage"><div><div><h3 class="title">4.1.2. Logging in to the config editor</h3></div></div></div><p>
					Browse to the config editor endpoint and then enter the username, typically <code class="literal">quayconfig</code>, and the corresponding password to access the config tool:
				</p><p>
					<span class="inlinemediaobject"><img src="images/config-editor-ui.png" alt="Config editor user interface"/></span>
				</p></section><section class="section" id="operator-config-ui-change"><div class="titlepage"><div><div><h3 class="title">4.1.3. Changing configuration</h3></div></div></div><p>
					In the following example, you will update your configuration file by changing the default expiration period of deleted tags.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							On the config editor, locate the <span class="strong strong"><strong>Time Machine</strong></span> section.
						</li><li class="listitem"><p class="simpara">
							Add an expiration period to the <span class="strong strong"><strong>Allowed expiration periods</strong></span> box, for example, <code class="literal">4w</code>:
						</p><p class="simpara">
							<span class="inlinemediaobject"><img src="images/ui-time-machine-add.png" alt="Add expiration period"/></span>
						</p></li><li class="listitem">
							Select <span class="strong strong"><strong>Validate Configuration Changes</strong></span> to ensure that the changes are valid.
						</li><li class="listitem"><p class="simpara">
							Apply the changes by pressing <span class="strong strong"><strong>Reconfigure Quay</strong></span>:
						</p><p class="simpara">
							<span class="inlinemediaobject"><img src="images/config-editor-reconfigure.png" alt="Reconfigure"/></span>
						</p></li></ol></div><p>
					After applying the changes, the config tool notifies you that the changes made have been submitted to your Red Hat Quay deployment:
				</p><p>
					+ 
					<span class="inlinemediaobject"><img src="images/config-editor-reconfigured.png" alt="Reconfigured"/></span>
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						Reconfiguring Red Hat Quay using the config tool UI can lead to the registry being unavailable for a short time while the updated configuration is applied.
					</p></div></div></section></section><section class="section" id="operator-config-ui-monitoring"><div class="titlepage"><div><div><h2 class="title">4.2. Monitoring reconfiguration in the UI</h2></div></div></div><section class="section" id="quayregistry_resource"><div class="titlepage"><div><div><h3 class="title">4.2.1. QuayRegistry resource</h3></div></div></div><p>
					After reconfiguring the Operator, you can track the progress of the redeployment in the YAML tab for the specific instance of QuayRegistry, in this case, <code class="literal">example-registry</code>:
				</p><p>
					<span class="inlinemediaobject"><img src="images/ui-monitor-deploy-update.png" alt="ui monitor deploy update"/></span>
				</p><p>
					Each time the status changes, you will be prompted to reload the data to see the updated version. Eventually, the Operator will reconcile the changes, and there will be no unhealthy components reported.
				</p><p>
					<span class="inlinemediaobject"><img src="images/ui-monitor-deploy-done.png" alt="ui monitor deploy done"/></span>
				</p></section><section class="section" id="events"><div class="titlepage"><div><div><h3 class="title">4.2.2. Events</h3></div></div></div><p>
					The Events tab for the QuayRegistry shows some events related to the redeployment:
				</p><p>
					<span class="inlinemediaobject"><img src="images/ui-monitor-deploy-streaming-events.png" alt="ui monitor deploy streaming events"/></span>
				</p><p>
					Streaming events, for all resources in the namespace that are affected by the reconfiguration, are available in the OpenShift console under Home → Events:
				</p><p>
					<span class="inlinemediaobject"><img src="images/ui-monitor-deploy-streaming-events.png" alt="ui monitor deploy streaming events"/></span>
				</p></section></section><section class="section" id="operator-config-ui-updated"><div class="titlepage"><div><div><h2 class="title">4.3. Accessing updated information after reconfiguration</h2></div></div></div><section class="section" id="accessing_the_updated_config_tool_credentials_in_the_ui"><div class="titlepage"><div><div><h3 class="title">4.3.1. Accessing the updated config tool credentials in the UI</h3></div></div></div><p>
					With Red Hat Quay 3.7, reconfiguring Quay through the UI no longer generates a new login password. The password now generates only once, and remains the same after reconciling <code class="literal">QuayRegistry</code> objects.
				</p></section><section class="section" id="accessing_the_updated_config_yaml_in_the_ui"><div class="titlepage"><div><div><h3 class="title">4.3.2. Accessing the updated config.yaml in the UI</h3></div></div></div><p>
					Use the config bundle to access the updated <code class="literal">config.yaml</code> file.
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							On the QuayRegistry details screen, click on the Config Bundle Secret
						</li><li class="listitem">
							In the Data section of the Secret details screen, click Reveal values to see the <code class="literal">config.yaml</code> file
						</li><li class="listitem"><p class="simpara">
							Check that the change has been applied. In this case, <code class="literal">4w</code> should be in the list of <code class="literal">TAG_EXPIRATION_OPTIONS</code>:
						</p><pre class="programlisting language-yaml">...
SERVER_HOSTNAME: example-quay-openshift-operators.apps.docs.quayteam.org
SETUP_COMPLETE: true
SUPER_USERS:
- quayadmin
TAG_EXPIRATION_OPTIONS:
- 2w
- 4w
...</pre></li></ol></div></section></section></section><section class="chapter" id="operator-components-intro"><div class="titlepage"><div><div><h1 class="title">Chapter 5. Quay Operator components</h1></div></div></div><p>
			Quay is a powerful container registry platform and as a result, has a significant number of dependencies. These include a database, object storage, Redis, and others. The Quay Operator manages an opinionated deployment of Quay and its dependencies on Kubernetes. These dependencies are treated as <span class="emphasis"><em>components</em></span> and are configured through the <code class="literal">QuayRegistry</code> API.
		</p><p>
			In the <code class="literal">QuayRegistry</code> custom resource, the <code class="literal">spec.components</code> field configures components. Each component contains two fields: <code class="literal">kind</code> - the name of the component, and <code class="literal">managed</code> - boolean whether the component lifecycle is handled by the Operator. By default (omitting this field), all components are managed and will be autofilled upon reconciliation for visibility:
		</p><pre class="programlisting language-yaml">spec:
  components:
    - kind: quay
      managed: true
    - kind: postgres
      managed: true
    - kind: clair
      managed: true
    - kind: redis
      managed: true
    - kind: horizontalpodautoscaler
      managed: true
    - kind: objectstorage
      managed: true
    - kind: route
      managed: true
    - kind: mirror
      managed: true
    - kind: monitoring
      managed: true
    - kind: tls
      managed: true
    - kind: clairpostgres
      managed: true</pre><section class="section" id="operator-components-managed"><div class="titlepage"><div><div><h2 class="title">5.1. Using managed components</h2></div></div></div><p>
				Unless your <code class="literal">QuayRegistry</code> custom resource specifies otherwise, the Red Hat Quay Operator uses defaults for the following managed components:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<span class="strong strong"><strong>quay:</strong></span> Holds overrides for the Red Hat Quay deployment. For example, environment variables and number of replicas. This component is new in Red Hat Quay 3.7 and cannot be set to unmanaged.
					</li><li class="listitem">
						<span class="strong strong"><strong>postgres:</strong></span> For storing the registry metadata, uses a version of Postgres 10 from the <a class="link" href="https://www.softwarecollections.org/en/">Software Collections</a>
					</li><li class="listitem">
						<span class="strong strong"><strong>clair:</strong></span> Provides image vulnerability scanning
					</li><li class="listitem">
						<span class="strong strong"><strong>redis:</strong></span> Stores live builder logs and the Red Hat Quay tutorial. Also includes the locking mechanism that is required for garbage collection.
					</li><li class="listitem">
						<span class="strong strong"><strong>horizontalpodautoscaler:</strong></span> Adjusts the number of <code class="literal">Quay</code> pods depending on memory/cpu consumption
					</li><li class="listitem">
						<span class="strong strong"><strong>objectstorage:</strong></span> For storing image layer blobs, utilizes the <code class="literal">ObjectBucketClaim</code> Kubernetes API which is provided by Noobaa/RHOCS
					</li><li class="listitem">
						<span class="strong strong"><strong>route:</strong></span> Provides an external entrypoint to the Red Hat Quay registry from outside of OpenShift Container Platform
					</li><li class="listitem">
						<span class="strong strong"><strong>mirror:</strong></span> Configures repository mirror workers to support optional repository mirroring
					</li><li class="listitem">
						<span class="strong strong"><strong>monitoring:</strong></span> Features include a Grafana dashboard, access to individual metrics, and alerting to notify for frequently restarting Quay pods
					</li><li class="listitem">
						<span class="strong strong"><strong>tls:</strong></span> Configures whether Red Hat Quay or OpenShift Container Platform handles SSL/TLS
					</li><li class="listitem">
						<span class="strong strong"><strong>clairpostgres:</strong></span> Configures a managed Clair database
					</li></ul></div><p>
				The Red Hat Quay Operator handles any required configuration and installation work needed for Red Hat Quay to use the managed components. If the opinionated deployment performed by the Red Hat Quay Operator is unsuitable for your environment, you can provide the Red Hat Quay Operator with <code class="literal">unmanaged</code> resources (overrides) as described in the following sections.
			</p></section><section class="section" id="operator-components-unmanaged"><div class="titlepage"><div><div><h2 class="title">5.2. Using unmanaged components for dependencies</h2></div></div></div><p>
				If you have existing components such as Postgres, Redis or object storage that you would like to use with Quay, you first configure them within the Quay configuration bundle (<code class="literal">config.yaml</code>) and then reference the bundle in your <code class="literal">QuayRegistry</code> (as a Kubernetes <code class="literal">Secret</code>) while indicating which components are unmanaged.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					The Quay config editor can also be used to create or modify an existing config bundle and simplifies the process of updating the Kubernetes <code class="literal">Secret</code>, especially for multiple changes. When Quay’s configuration is changed via the config editor and sent to the Operator, the Quay deployment will be updated to reflect the new configuration.
				</p></div></div><section class="section" id="operator-unmanaged-postgres"><div class="titlepage"><div><div><h3 class="title">5.2.1. Using an existing Postgres database</h3></div></div></div><p>
					Requirements:
				</p><p>
					If you are using an externally managed PostgreSQL database, you must manually enable pg_trgm extension for a successful deployment.
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create a configuration file <code class="literal">config.yaml</code> with the necessary database fields:
						</p><div class="formalpara"><p class="title"><strong>config.yaml:</strong></p><p>
								
<pre class="programlisting language-yaml">DB_URI: postgresql://test-quay-database:postgres@test-quay-database:5432/test-quay-database</pre>
							</p></div></li><li class="listitem"><p class="simpara">
							Create a Secret using the configuration file:
						</p><pre class="screen">$ kubectl create secret generic --from-file config.yaml=./config.yaml config-bundle-secret</pre></li><li class="listitem"><p class="simpara">
							Create a QuayRegistry YAML file <code class="literal">quayregistry.yaml</code> which marks the <code class="literal">postgres</code> component as unmanaged and references the created Secret:
						</p><div class="formalpara"><p class="title"><strong>quayregistry.yaml</strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: quay.redhat.com/v1
kind: QuayRegistry
metadata:
  name: example-registry
  namespace: quay-enterprise
spec:
  configBundleSecret: config-bundle-secret
  components:
    - kind: postgres
      managed: false</pre>
							</p></div></li><li class="listitem">
							Deploy the registry as detailed in the following sections.
						</li></ol></div></section><section class="section" id="operator-unmanaged-storage-noobaa"><div class="titlepage"><div><div><h3 class="title">5.2.2. NooBaa unmanaged storage</h3></div></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							Create a NooBaa Object Bucket Claim in the console at Storage → Object Bucket Claims.
						</li><li class="listitem">
							Retrieve the Object Bucket Claim Data details including the Access Key, Bucket Name, Endpoint (hostname) and Secret Key.
						</li><li class="listitem"><p class="simpara">
							Create a <code class="literal">config.yaml</code> configuration file, using the information for the Object Bucket Claim:
						</p><pre class="programlisting language-yaml">DISTRIBUTED_STORAGE_CONFIG:
  default:
    - RHOCSStorage
    - access_key: WmrXtSGk8B3nABCDEFGH
      bucket_name: my-noobaa-bucket-claim-8b844191-dc6c-444e-9ea4-87ece0abcdef
      hostname: s3.openshift-storage.svc.cluster.local
      is_secure: true
      port: "443"
      secret_key: X9P5SDGJtmSuHFCMSLMbdNCMfUABCDEFGH+C5QD
      storage_path: /datastorage/registry
DISTRIBUTED_STORAGE_DEFAULT_LOCATIONS: []
DISTRIBUTED_STORAGE_PREFERENCE:
  - default</pre></li></ol></div></section><section class="section" id="operator-unmanaged-hpa"><div class="titlepage"><div><div><h3 class="title">5.2.3. Disabling the Horizontal Pod Autoscaler</h3></div></div></div><p>
					<code class="literal">HorizontalPodAutoscalers</code> have been added to the Clair, Quay, and Mirror pods, so that they now automatically scale during load spikes.
				</p><p>
					As HPA is configured by default to be <code class="literal">managed</code>, the number of pods for Quay, Clair and repository mirroring is set to two. This facilitates the avoidance of downtime when updating / reconfiguring Quay via the Operator or during rescheduling events.
				</p><p>
					If you wish to disable autoscaling or create your own <code class="literal">HorizontalPodAutoscaler</code>, simply specify the component as unmanaged in the <code class="literal">QuayRegistry</code> instance:
				</p><pre class="programlisting language-yaml">apiVersion: quay.redhat.com/v1
kind: QuayRegistry
metadata:
  name: example-registry
  namespace: quay-enterprise
spec:
  components:
    - kind: horizontalpodautoscaler
      managed: false</pre></section></section><section class="section" id="config-custom-ssl-cert-kubernetes"><div class="titlepage"><div><div><h2 class="title">5.3. Add certs when deployed on Kubernetes</h2></div></div></div><p>
				When deployed on Kubernetes, Red Hat Quay mounts in a secret as a volume to store config assets. Unfortunately, this currently breaks the upload certificate function of the superuser panel.
			</p><p>
				To get around this error, a base64 encoded certificate can be added to the secret <span class="emphasis"><em>after</em></span> Red Hat Quay has been deployed. Here’s how:
			</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Begin by base64 encoding the contents of the certificate:
					</p><pre class="screen">$ cat ca.crt
-----BEGIN CERTIFICATE-----
MIIDljCCAn6gAwIBAgIBATANBgkqhkiG9w0BAQsFADA5MRcwFQYDVQQKDA5MQUIu
TElCQ09SRS5TTzEeMBwGA1UEAwwVQ2VydGlmaWNhdGUgQXV0aG9yaXR5MB4XDTE2
MDExMjA2NTkxMFoXDTM2MDExMjA2NTkxMFowOTEXMBUGA1UECgwOTEFCLkxJQkNP
UkUuU08xHjAcBgNVBAMMFUNlcnRpZmljYXRlIEF1dGhvcml0eTCCASIwDQYJKoZI
[...]
-----END CERTIFICATE-----

$ cat ca.crt | base64 -w 0
[...]
c1psWGpqeGlPQmNEWkJPMjJ5d0pDemVnR2QNCnRsbW9JdEF4YnFSdVd3PT0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=</pre></li><li class="listitem"><p class="simpara">
						Use the <code class="literal">kubectl</code> tool to edit the quay-enterprise-config-secret.
					</p><pre class="screen">$ kubectl --namespace quay-enterprise edit secret/quay-enterprise-config-secret</pre></li><li class="listitem"><p class="simpara">
						Add an entry for the cert and paste the full base64 encoded string under the entry:
					</p><pre class="screen">  custom-cert.crt:
c1psWGpqeGlPQmNEWkJPMjJ5d0pDemVnR2QNCnRsbW9JdEF4YnFSdVd3PT0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=</pre></li><li class="listitem">
						Finally, recycle all Red Hat Quay pods. Use <code class="literal">kubectl delete</code> to remove all Red Hat Quay pods. The Red Hat Quay Deployment will automatically schedule replacement pods with the new certificate data.
					</li></ol></div></section><section class="section" id="operator-helm-oci"><div class="titlepage"><div><div><h2 class="title">5.4. Configuring OCI and Helm with the Operator</h2></div></div></div><p>
				Customizations to the configuration of Quay can be provided in a secret containing the configuration bundle. Execute the following command which will create a new secret called <code class="literal">quay-config-bundle</code>, in the appropriate namespace, containing the necessary properties to enable OCI support.
			</p><div class="formalpara"><p class="title"><strong>quay-config-bundle.yaml</strong></p><p>
					
<pre class="programlisting language-yaml">apiVersion: v1
stringData:
  config.yaml: |
    FEATURE_GENERAL_OCI_SUPPORT: true
    FEATURE_HELM_OCI_SUPPORT: true
kind: Secret
metadata:
  name: quay-config-bundle
  namespace: quay-enterprise
type: Opaque</pre>
				</p></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					As of Red Hat Quay 3.9, <code class="literal">FEATURE_HELM_OCI_SUPPORT</code> has been deprecated and will be removed in a future version of Red Hat Quay. In Red Hat Quay 3.6, Helm artifacts are supported by default and included under the <code class="literal">FEATURE_GENERAL_OCI_SUPPORT</code> property. Users are no longer required to update their config.yaml files to enable support.
				</p></div></div><p>
				Create the secret in the appropriate namespace, in this example <code class="literal">quay-enterprise</code>:
			</p><pre class="screen">$ oc create -n quay-enterprise -f quay-config-bundle.yaml</pre><p>
				Specify the secret for the <code class="literal">spec.configBundleSecret</code> field:
			</p><div class="formalpara"><p class="title"><strong>quay-registry.yaml</strong></p><p>
					
<pre class="programlisting language-yaml">apiVersion: quay.redhat.com/v1
kind: QuayRegistry
metadata:
  name: example-registry
  namespace: quay-enterprise
spec:
  configBundleSecret: quay-config-bundle</pre>
				</p></div><p>
				Create the registry with the specified configuration:
			</p><pre class="screen">$ oc create -n quay-enterprise -f quay-registry.yaml</pre></section><section class="section" id="operator-volume-size-overrides"><div class="titlepage"><div><div><h2 class="title">5.5. Volume size overrides</h2></div></div></div><p>
				As of Red Hat Quay v3.6.2, you can specify the desired size of storage resources provisioned for managed components. The default size for Clair and Quay PostgreSQL databases is <code class="literal">50Gi</code>. You can now choose a large enough capacity upfront, either for performance reasons or in the case where your storage backend does not have resize capability.
			</p><p>
				In the following example, the volume size for the Clair and the Quay PostgreSQL databases has been set to <code class="literal">70Gi</code>:
			</p><pre class="programlisting language-yaml">apiVersion: quay.redhat.com/v1
kind: QuayRegistry
metadata:
  name: quay-example
  namespace: quay-enterprise
spec:
  configBundleSecret: config-bundle-secret
  components:
    - kind: objectstorage
      managed: false
    - kind: route
      managed: true
    - kind: tls
      managed: false
    - kind: clair
      managed: true
      overrides:
        volumeSize: 70Gi
    - kind: postgres
      managed: true
      overrides:
        volumeSize: 70Gi</pre></section></section><section class="chapter" id="clair-vulnerability-scanner"><div class="titlepage"><div><div><h1 class="title">Chapter 6. Clair for Red Hat Quay</h1></div></div></div><p>
			Clair v4 (Clair) is an open source application that leverages static code analyses for parsing image content and reporting vulnerabilities affecting the content. Clair is packaged with Red Hat Quay and can be used in both standalone and Operator deployments. It can be run in highly scalable configurations, where components can be scaled separately as appropriate for enterprise environments.
		</p><section class="section" id="config-fields-overview"><div class="titlepage"><div><div><h2 class="title">6.1. Clair configuration overview</h2></div></div></div><p>
				Clair is configured by a structured YAML file. Each Clair node needs to specify what mode it will run in and a path to a configuration file through CLI flags or environment variables. For example:
			</p><pre class="programlisting language-terminal">$ clair -conf ./path/to/config.yaml -mode indexer</pre><p>
				or
			</p><pre class="programlisting language-terminal">$ clair -conf ./path/to/config.yaml -mode matcher</pre><p>
				The aforementioned commands each start two Clair nodes using the same configuration file. One runs the indexing facilities, while other runs the matching facilities.
			</p><p>
				Environment variables respected by the Go standard library can be specified if needed, for example:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">HTTP_PROXY</code>
					</li><li class="listitem">
						<code class="literal">HTTPS_PROXY</code>
					</li><li class="listitem">
						<code class="literal">SSL_CERT_DIR</code>
					</li></ul></div><p>
				If you are running Clair in <code class="literal">combo</code> mode, you must supply the indexer, matcher, and notifier configuration blocks in the configuration.
			</p><section class="section" id="config-fields-clair-reference"><div class="titlepage"><div><div><h3 class="title">6.1.1. Clair configuration reference</h3></div></div></div><p>
					The following YAML shows an example Clair configuration:
				</p><pre class="programlisting language-yaml">http_listen_addr: ""
introspection_addr: ""
log_level: ""
tls: {}
indexer:
    connstring: ""
    scanlock_retry: 0
    layer_scan_concurrency: 0
    migrations: false
    scanner: {}
    airgap: false
matcher:
    connstring: ""
    indexer_addr: ""
    migrations: false
    period: ""
    disable_updaters: false
    update_retention: 2
matchers:
    names: nil
    config: nil
updaters:
    sets: nil
    config: nil
notifier:
    connstring: ""
    migrations: false
    indexer_addr: ""
    matcher_addr: ""
    poll_interval: ""
    delivery_interval: ""
    disable_summary: false
    webhook: null
    amqp: null
    stomp: null
auth:
  psk: nil
trace:
    name: ""
    probability: null
    jaeger:
        agent:
            endpoint: ""
        collector:
            endpoint: ""
            username: null
            password: null
        service_name: ""
        tags: nil
        buffer_max: 0
metrics:
    name: ""
    prometheus:
        endpoint: null
    dogstatsd:
        url: ""</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						The above YAML file lists every key for completeness. Using this configuration file as-is will result in some options not having their defaults set normally.
					</p></div></div></section><section class="section" id="config-fields-required-clair"><div class="titlepage"><div><div><h3 class="title">6.1.2. Clair general fields</h3></div></div></div><p>
					The following section describes the general configuration fields available for a Clair deployment:
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45384245150496" scope="col">Field</th><th align="left" valign="top" id="idm45384245149408" scope="col">Typhttp_listen_ae</th><th align="left" valign="top" id="idm45384245148320" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45384245150496">
								<p>
									<span class="strong strong"><strong>http_listen_addr</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384245149408">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384245148320">
								<p>
									Configures where the HTTP API is exposed.
								</p>
								<p>
									Default: <code class="literal">:6060</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384245150496">
								<p>
									<span class="strong strong"><strong>introspection_addr</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384245149408">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384245148320">
								<p>
									Configures where Clair’s metrics and health endpoints are exposed.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384245150496">
								<p>
									<span class="strong strong"><strong>log_level</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384245149408">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384245148320">
								<p>
									Sets the logging level. Requires one of the following strings: <span class="strong strong"><strong>debug-color</strong></span>, <span class="strong strong"><strong>debug</strong></span>, <span class="strong strong"><strong>info</strong></span>, <span class="strong strong"><strong>warn</strong></span>, <span class="strong strong"><strong>error</strong></span>, <span class="strong strong"><strong>fatal</strong></span>, <span class="strong strong"><strong>panic</strong></span>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384245150496">
								<p>
									<span class="strong strong"><strong>tls</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384245149408">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384245148320">
								<p>
									A map containing the configuration for serving the HTTP API of TLS/SSL and HTTP/2.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384245150496">
								<p>
									<span class="strong strong"><strong>.cert</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384245149408">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384245148320">
								<p>
									The TLS certificate to be used. Must be a full-chain certificate.
								</p>
								</td></tr></tbody></table></div></section><section class="section" id="config-fields-clair-indexer"><div class="titlepage"><div><div><h3 class="title">6.1.3. Clair indexer configuration fields</h3></div></div></div><p>
					The following indexer configuration fields are available for Clair.
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45384244486576" scope="col">Field</th><th align="left" valign="top" id="idm45384244485488" scope="col">Type</th><th align="left" valign="top" id="idm45384244484400" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45384244486576">
								<p>
									<span class="strong strong"><strong>indexer</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384244485488">
								<p>
									Object
								</p>
								</td><td align="left" valign="top" headers="idm45384244484400">
								<p>
									Provides Clair indexer node configuration.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384244486576">
								<p>
									<span class="strong strong"><strong>.airgap</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384244485488">
								<p>
									Boolean
								</p>
								</td><td align="left" valign="top" headers="idm45384244484400">
								<p>
									Disables HTTP access to the internet for indexers and fetchers. Private IPv4 and IPv6 addresses are allowed. Database connections are unaffected.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384244486576">
								<p>
									<span class="strong strong"><strong>.connstring</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384244485488">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384244484400">
								<p>
									A Postgres connection string. Accepts format as a URL or libpq connection string.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384244486576">
								<p>
									<span class="strong strong"><strong>.index_report_request_concurrency</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384244485488">
								<p>
									Integer
								</p>
								</td><td align="left" valign="top" headers="idm45384244484400">
								<p>
									Rate limits the number of index report creation requests. Setting this to <code class="literal">0</code> attemps to auto-size this value. Setting a negative value means unlimited. The auto-sizing is a multiple of the number of available cores.
								</p>
								<p>
									The API returns a <code class="literal">429</code> status code if concurrency is exceeded.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384244486576">
								<p>
									<span class="strong strong"><strong>.scanlock_retry</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384244485488">
								<p>
									Integer
								</p>
								</td><td align="left" valign="top" headers="idm45384244484400">
								<p>
									A positive integer representing seconds. Concurrent indexers lock on manifest scans to avoid clobbering. This value tunes how often a waiting indexer polls for the lock.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384244486576">
								<p>
									<span class="strong strong"><strong>.layer_scan_concurrency</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384244485488">
								<p>
									Integer
								</p>
								</td><td align="left" valign="top" headers="idm45384244484400">
								<p>
									Positive integer limiting the number of concurrent layer scans. Indexers will match a manifest’s layer concurrently. This value tunes the number of layers an indexer scans in parallel.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384244486576">
								<p>
									<span class="strong strong"><strong>.migrations</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384244485488">
								<p>
									Boolean
								</p>
								</td><td align="left" valign="top" headers="idm45384244484400">
								<p>
									Whether indexer nodes handle migrations to their database.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384244486576">
								<p>
									<span class="strong strong"><strong>.scanner</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384244485488">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384244484400">
								<p>
									Indexer configuration.
								</p>
								<p>
									Scanner allows for passing configuration options to layer scanners. The scanner will have this configuration pass to it on construction if designed to do so.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384244486576">
								<p>
									<span class="strong strong"><strong>.scanner.dist</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384244485488">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384244484400">
								<p>
									A map with the name of a particular scanner and arbitrary YAML as a value.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384244486576">
								<p>
									<span class="strong strong"><strong>.scanner.package</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384244485488">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384244484400">
								<p>
									A map with the name of a particular scanner and arbitrary YAML as a value.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384244486576">
								<p>
									<span class="strong strong"><strong>.scanner.repo</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384244485488">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384244484400">
								<p>
									A map with the name of a particular scanner and arbitrary YAML as a value.
								</p>
								</td></tr></tbody></table></div></section><section class="section" id="config-fields-clair-matcher"><div class="titlepage"><div><div><h3 class="title">6.1.4. Clair matcher configuration fields</h3></div></div></div><p>
					The following matcher configuration fields are available for Clair.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						Differs from <code class="literal">matchers</code> configuration fields.
					</p></div></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45384244987024" scope="col">Field</th><th align="left" valign="top" id="idm45384244985936" scope="col">Type</th><th align="left" valign="top" id="idm45384244984848" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45384244987024">
								<p>
									<span class="strong strong"><strong>matcher</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384244985936">
								<p>
									Object
								</p>
								</td><td align="left" valign="top" headers="idm45384244984848">
								<p>
									Provides Clair matcher node configuration.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384244987024">
								<p>
									<span class="strong strong"><strong>.cache_age</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384244985936">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384244984848">
								<p>
									Controls how long users should be hinted to cache responses for.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384244987024">
								<p>
									<span class="strong strong"><strong>.connstring</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384244985936">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384244984848">
								<p>
									A Postgres connection string. Accepts format as a URL or libpq connection string.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384244987024">
								<p>
									<span class="strong strong"><strong>.max_conn_pool</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384244985936">
								<p>
									Integer
								</p>
								</td><td align="left" valign="top" headers="idm45384244984848">
								<p>
									Limits the database connection pool size.
								</p>
								<p>
									Clair allows for a custom connection pool size. This number directly sets how many active database connections are allowed concurrently.
								</p>
								<p>
									This parameter will be ignored in a future version. Users should configure this through the connection string.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384244987024">
								<p>
									<span class="strong strong"><strong>.indexer_addr</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384244985936">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384244984848">
								<p>
									A matcher contacts an indexer to create a <code class="literal">VulnerabilityReport</code>. The location of this indexer is required.
								</p>
								<p>
									Defaults to <code class="literal">30m</code>.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384244987024">
								<p>
									<span class="strong strong"><strong>.migrations</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384244985936">
								<p>
									Boolean
								</p>
								</td><td align="left" valign="top" headers="idm45384244984848">
								<p>
									Whether matcher nodes handle migrations to their databases.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384244987024">
								<p>
									<span class="strong strong"><strong>.period</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384244985936">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384244984848">
								<p>
									Determines how often updates for new security advisories take place.
								</p>
								<p>
									Defaults to <code class="literal">30m</code>.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384244987024">
								<p>
									<span class="strong strong"><strong>.disable_updaters</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384244985936">
								<p>
									Boolean
								</p>
								</td><td align="left" valign="top" headers="idm45384244984848">
								<p>
									Whether to run background updates or not.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384244987024">
								<p>
									<span class="strong strong"><strong>.update_retention</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384244985936">
								<p>
									Integer
								</p>
								</td><td align="left" valign="top" headers="idm45384244984848">
								<p>
									Sets the number of update operations to retain between garbage collection cycles. This should be set to a safe MAX value based on database size constraints.
								</p>
								<p>
									Defaults to <code class="literal">10m</code>.
								</p>
								<p>
									If a value of less than <code class="literal">0</code> is provided, garbage collection is disabled. <code class="literal">2</code> is the minimum value to ensure updates can be compared to notifications.
								</p>
								</td></tr></tbody></table></div></section><section class="section" id="config-fields-clair-matchers"><div class="titlepage"><div><div><h3 class="title">6.1.5. Clair matchers configuration fields</h3></div></div></div><p>
					The following matchers configuration fields are available for Clair.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						Differs from <code class="literal">matcher</code> configuration fields.
					</p></div></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45384244448992" scope="col">Field</th><th align="left" valign="top" id="idm45384244447904" scope="col">Type</th><th align="left" valign="top" id="idm45384244446816" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45384244448992">
								<p>
									<span class="strong strong"><strong>matchers</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384244447904">
								<p>
									Array of strings
								</p>
								</td><td align="left" valign="top" headers="idm45384244446816">
								<p>
									Provides configuration for the in-tree <code class="literal">matchers</code> and <code class="literal">remotematchers</code>.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384244448992">
								<p>
									<span class="strong strong"><strong>.names</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384244447904">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384244446816">
								<p>
									A list of string values informing the matcher factory about enabled matchers. If value is set to <code class="literal">null</code>, the default list of matchers run: <span class="strong strong"><strong>alpine</strong></span>, <span class="strong strong"><strong>aws</strong></span>, <span class="strong strong"><strong>debian</strong></span>, <span class="strong strong"><strong>oracle</strong></span>, <span class="strong strong"><strong>photon</strong></span>, <span class="strong strong"><strong>python</strong></span>, <span class="strong strong"><strong>python</strong></span>, <span class="strong strong"><strong>rhel</strong></span>, <span class="strong strong"><strong>suse</strong></span>, <span class="strong strong"><strong>ubuntu</strong></span>, <span class="strong strong"><strong>crda</strong></span>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384244448992">
								<p>
									<span class="strong strong"><strong>.config</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384244447904">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384244446816">
								<p>
									Provides configuration to a specific matcher.
								</p>
								<p>
									A map keyed by the name of the matcher containing a sub-object which will be provided to the matchers factory constructor. For example:
								</p>
								
<pre class="programlisting language-yaml">config:
  python:
    ignore_vulns:
      - CVE-XYZ
      - CVE-ABC</pre>
								</td></tr></tbody></table></div></section><section class="section" id="config-fields-clair-updaters"><div class="titlepage"><div><div><h3 class="title">6.1.6. Clair updaters configuration fields</h3></div></div></div><p>
					The following updaters configuration fields are available for Clair.
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45384243020480" scope="col">Field</th><th align="left" valign="top" id="idm45384243019392" scope="col">Type</th><th align="left" valign="top" id="idm45384243018304" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45384243020480">
								<p>
									<span class="strong strong"><strong>updaters</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384243019392">
								<p>
									Object
								</p>
								</td><td align="left" valign="top" headers="idm45384243018304">
								<p>
									Provides configuration for the matcher’s update manager.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384243020480">
								<p>
									<span class="strong strong"><strong>.sets</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384243019392">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384243018304">
								<p>
									A list of values informing the update manager which updaters to run.
								</p>
								<p>
									If value is set to <code class="literal">null</code>, the default set of updaters runs the following: <span class="strong strong"><strong>alpine</strong></span>, <span class="strong strong"><strong>aws</strong></span>, <span class="strong strong"><strong>debian</strong></span>, <span class="strong strong"><strong>oracle</strong></span>, <span class="strong strong"><strong>photon</strong></span>, <span class="strong strong"><strong>pyupio</strong></span>, <span class="strong strong"><strong>rhel</strong></span>, <span class="strong strong"><strong>suse</strong></span>, <span class="strong strong"><strong>ubuntu</strong></span>
								</p>
								<p>
									If left blank, zero updaters run.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384243020480">
								<p>
									<span class="strong strong"><strong>.config</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384243019392">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384243018304">
								<p>
									Provides configuration to specific updater sets.
								</p>
								<p>
									A map keyed by the name of the updater set containing a sub-object which will be provided to the updater set’s constructor. For example:
								</p>
								
<pre class="programlisting language-yaml">config:
  ubuntu:
    security_tracker_url: http://security.url
    ignore_distributions:
      - cosmic</pre>
								</td></tr></tbody></table></div></section><section class="section" id="config-fields-clair-notifiers"><div class="titlepage"><div><div><h3 class="title">6.1.7. Clair notifier configuration fields</h3></div></div></div><p>
					The following notifier configuration fields are available for Clair.
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45384257771616" scope="col">Field</th><th align="left" valign="top" id="idm45384257770528" scope="col">Type</th><th align="left" valign="top" id="idm45384257769440" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45384257771616">
								<p>
									<span class="strong strong"><strong>notifier</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384257770528">
								<p>
									Object
								</p>
								</td><td align="left" valign="top" headers="idm45384257769440">
								<p>
									Provides Clair notifier node configuration.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384257771616">
								<p>
									<span class="strong strong"><strong>.connstring</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384257770528">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384257769440">
								<p>
									Postgres connection string. Accepts format as URL, or libpq connection string.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384257771616">
								<p>
									<span class="strong strong"><strong>.migrations</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384257770528">
								<p>
									Boolean
								</p>
								</td><td align="left" valign="top" headers="idm45384257769440">
								<p>
									Whether notifier nodes handle migrations to their database.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384257771616">
								<p>
									<span class="strong strong"><strong>.indexer_addr</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384257770528">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384257769440">
								<p>
									A notifier contacts an indexer to create or obtain manifests affected by vulnerabilities. The location of this indexer is required.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384257771616">
								<p>
									<span class="strong strong"><strong>.matcher_addr</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384257770528">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384257769440">
								<p>
									A notifier contacts a matcher to list update operations and acquire diffs. The location of this matcher is required.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384257771616">
								<p>
									<span class="strong strong"><strong>.poll_interval</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384257770528">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384257769440">
								<p>
									The frequency at which the notifier will query a matcher for update operations.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384257771616">
								<p>
									<span class="strong strong"><strong>.delivery_interval</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384257770528">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384257769440">
								<p>
									The frequency at which the notifier attempts delivery of created, or previously failed, notifications.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384257771616">
								<p>
									<span class="strong strong"><strong>.disable_summary</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384257770528">
								<p>
									Boolean
								</p>
								</td><td align="left" valign="top" headers="idm45384257769440">
								<p>
									Controls whether notifications should be summarized to one per manifest.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384257771616">
								<p>
									<span class="strong strong"><strong>.webhook</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384257770528">
								<p>
									Object
								</p>
								</td><td align="left" valign="top" headers="idm45384257769440">
								<p>
									Configures the notifier for webhook delivery.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384257771616">
								<p>
									<span class="strong strong"><strong>.webhook.target</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384257770528">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384257769440">
								<p>
									URL where the webhook will be delivered.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384257771616">
								<p>
									<span class="strong strong"><strong>.webhook.callback</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384257770528">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384257769440">
								<p>
									The callback URL where notifications can be retrieved. The notification ID will be appended to this URL.
								</p>
								<p>
									This will typically be where the Clair notifier is hosted.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384257771616">
								<p>
									<span class="strong strong"><strong>.webhook.headers</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384257770528">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384257769440">
								<p>
									A map associating a header name to a list of values.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384257771616">
								<p>
									<span class="strong strong"><strong>.amqp</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384257770528">
								<p>
									Object
								</p>
								</td><td align="left" valign="top" headers="idm45384257769440">
								<p>
									Configures the notifier for AMQP delivery.
								</p>
								<div class="admonition note"><div class="admonition_header">Note</div><div><p>
										Clair does not declare any AMQP components on its own. All attempts to use an exchange or queue are passive only and will fail. Broker administrators should setup exchanges and queues ahead of time.
									</p></div></div>
								</td></tr><tr><td align="left" valign="top" headers="idm45384257771616">
								<p>
									<span class="strong strong"><strong>.amqp.direct</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384257770528">
								<p>
									Boolean
								</p>
								</td><td align="left" valign="top" headers="idm45384257769440">
								<p>
									If <code class="literal">true</code>, the notifier will deliver individual notifications (not a callback) to the configured AMQP broker.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384257771616">
								<p>
									<span class="strong strong"><strong>.amqp.rollup</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384257770528">
								<p>
									Integer
								</p>
								</td><td align="left" valign="top" headers="idm45384257769440">
								<p>
									When <code class="literal">amqp.direct</code> is set to <code class="literal">true</code>, this value informs the notifier of how many notifications to send in a direct delivery. For example, if <code class="literal">direct</code> is set to <code class="literal">true</code>, and <code class="literal">amqp.rollup</code> is set to <code class="literal">5</code>, the notifier delivers no more than 5 notifications in a single JSON payload to the broker. Setting the value to <code class="literal">0</code> effectively sets it to <code class="literal">1</code>.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384257771616">
								<p>
									<span class="strong strong"><strong>.amqp.exchange</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384257770528">
								<p>
									Object
								</p>
								</td><td align="left" valign="top" headers="idm45384257769440">
								<p>
									The AMQP exchange to connect to.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384257771616">
								<p>
									<span class="strong strong"><strong>.amqp.exchange.name</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384257770528">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384257769440">
								<p>
									The name of the exchange to connect to.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384257771616">
								<p>
									<span class="strong strong"><strong>.amqp.exchange.type</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384257770528">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384257769440">
								<p>
									The type of the exchange. Typically one of the following: <span class="strong strong"><strong>direct</strong></span>, <span class="strong strong"><strong>fanout</strong></span>, <span class="strong strong"><strong>topic</strong></span>, <span class="strong strong"><strong>headers</strong></span>.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384257771616">
								<p>
									<span class="strong strong"><strong>.amqp.exchange.durability</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384257770528">
								<p>
									Boolean
								</p>
								</td><td align="left" valign="top" headers="idm45384257769440">
								<p>
									Whether the configured queue is durable.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384257771616">
								<p>
									<span class="strong strong"><strong>.amqp.exchange.auto_delete</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384257770528">
								<p>
									Boolean
								</p>
								</td><td align="left" valign="top" headers="idm45384257769440">
								<p>
									Whether the configured queue uses an <code class="literal">auto_delete_policy</code>.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384257771616">
								<p>
									<span class="strong strong"><strong>.amqp.routing_key</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384257770528">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384257769440">
								<p>
									The name of the routing key each notification is sent with.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384257771616">
								<p>
									<span class="strong strong"><strong>.amqp.callback</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384257770528">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384257769440">
								<p>
									If <code class="literal">amqp.direct</code> is set to <code class="literal">false</code>, this URL is provided in the notification callback sent to the broker. This URL should point to Clair’s notification API endpoint.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384257771616">
								<p>
									<span class="strong strong"><strong>.amqp.uris</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384257770528">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384257769440">
								<p>
									A list of one or more AMQP brokers to connect to, in priority order.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384257771616">
								<p>
									<span class="strong strong"><strong>.amqp.tls</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384257770528">
								<p>
									Object
								</p>
								</td><td align="left" valign="top" headers="idm45384257769440">
								<p>
									Configures TLS/SSL connection to an AMQP broker.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384257771616">
								<p>
									<span class="strong strong"><strong>.amqp.tls.root_ca</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384257770528">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384257769440">
								<p>
									The filesystem path where a root CA can be read.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384257771616">
								<p>
									<span class="strong strong"><strong>.amqp.tls.cert</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384257770528">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384257769440">
								<p>
									The filesystem path where a TLS/SSL certificate can be read.
								</p>
								<div class="admonition note"><div class="admonition_header">Note</div><div><p>
										Clair also allows <code class="literal">SSL_CERT_DIR</code>, as documented for the Go <code class="literal">crypto/x509</code> package.
									</p></div></div>
								</td></tr><tr><td align="left" valign="top" headers="idm45384257771616">
								<p>
									<span class="strong strong"><strong>.amqp.tls.key</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384257770528">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384257769440">
								<p>
									The filesystem path where a TLS/SSL private key can be read.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384257771616">
								<p>
									<span class="strong strong"><strong>.stomp</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384257770528">
								<p>
									Object
								</p>
								</td><td align="left" valign="top" headers="idm45384257769440">
								<p>
									Configures the notifier for STOMP delivery.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384257771616">
								<p>
									<span class="strong strong"><strong>.stomp.direct</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384257770528">
								<p>
									Boolean
								</p>
								</td><td align="left" valign="top" headers="idm45384257769440">
								<p>
									If <code class="literal">true</code>, the notifier delivers individual notifications (not a callback) to the configured STOMP broker.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384257771616">
								<p>
									<span class="strong strong"><strong>.stomp.rollup</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384257770528">
								<p>
									Integer
								</p>
								</td><td align="left" valign="top" headers="idm45384257769440">
								<p>
									If <code class="literal">stomp.direct</code> is set to <code class="literal">true</code>, this value limits the number of notifications sent in a single direct delivery. For example, if <code class="literal">direct</code> is set to <code class="literal">true</code>, and <code class="literal">rollup</code> is set to <code class="literal">5</code>, the notifier delivers no more than 5 notifications in a single JSON payload to the broker. Setting the value to <code class="literal">0</code> effectively sets it to <code class="literal">1</code>.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384257771616">
								<p>
									<span class="strong strong"><strong>.stomp.callback</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384257770528">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384257769440">
								<p>
									If <code class="literal">stomp.callback</code> is set to <code class="literal">false</code>, the provided URL in the notification callback is sent to the broker. This URL should point to Clair’s notification API endpoint.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384257771616">
								<p>
									<span class="strong strong"><strong>.stomp.destination</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384257770528">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384257769440">
								<p>
									The STOMP destination to deliver notifications to.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384257771616">
								<p>
									<span class="strong strong"><strong>.stomp.uris</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384257770528">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384257769440">
								<p>
									A list of one or more STOMP brokers to connect to in priority order.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384257771616">
								<p>
									<span class="strong strong"><strong>.stomp.tls</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384257770528">
								<p>
									Object
								</p>
								</td><td align="left" valign="top" headers="idm45384257769440">
								<p>
									Configured TLS/SSL connection to STOMP broker.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384257771616">
								<p>
									<span class="strong strong"><strong>.stomp.tls.root_ca</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384257770528">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384257769440">
								<p>
									The filesystem path where a root CA can be read.
								</p>
								<div class="admonition note"><div class="admonition_header">Note</div><div><p>
										Clair also respects <code class="literal">SSL_CERT_DIR</code>, as documented for the Go <code class="literal">crypto/x509</code> package.
									</p></div></div>
								</td></tr><tr><td align="left" valign="top" headers="idm45384257771616">
								<p>
									<span class="strong strong"><strong>.stomp.tls.cert</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384257770528">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384257769440">
								<p>
									The filesystem path where a TLS/SSL certificate can be read.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384257771616">
								<p>
									<span class="strong strong"><strong>.stomp.tls.key</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384257770528">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384257769440">
								<p>
									The filesystem path where a TLS/SSL private key can be read.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384257771616">
								<p>
									<span class="strong strong"><strong>.stomp.user</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384257770528">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384257769440">
								<p>
									Configures login details for the STOMP broker.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384257771616">
								<p>
									<span class="strong strong"><strong>.stomp.user.login</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384257770528">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384257769440">
								<p>
									The STOMP login to connect with.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384257771616">
								<p>
									<span class="strong strong"><strong>.stomp.user.passcode</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384257770528">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384257769440">
								<p>
									The STOMP passcode to connect with.
								</p>
								</td></tr></tbody></table></div></section><section class="section" id="config-fields-clair-auth"><div class="titlepage"><div><div><h3 class="title">6.1.8. Clair authorization configuration fields</h3></div></div></div><p>
					The following authorization configuration fields are available for Clair.
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45384244066016" scope="col">Field</th><th align="left" valign="top" id="idm45384244064928" scope="col">Type</th><th align="left" valign="top" id="idm45384244063840" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45384244066016">
								<p>
									<span class="strong strong"><strong>auth</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384244064928">
								<p>
									Object
								</p>
								</td><td align="left" valign="top" headers="idm45384244063840">
								<p>
									Defines Clair’s external and intra-service JWT based authentication. If multiple <code class="literal">auth</code> mechanisms are defined, Clair picks one. Currently, multiple mechanisms are unsupported.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384244066016">
								<p>
									<span class="strong strong"><strong>.psk</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384244064928">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384244063840">
								<p>
									Defines pre-shared key authentication.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384244066016">
								<p>
									<span class="strong strong"><strong>.psk.key</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384244064928">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384244063840">
								<p>
									A shared base64 encoded key distributed between all parties signing and verifying JWTs.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384244066016">
								<p>
									<span class="strong strong"><strong>.psk.iss</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384244064928">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384244063840">
								<p>
									A list of JWT issuers to verify. An empty list accepts any issuer in a JWT claim.
								</p>
								</td></tr></tbody></table></div></section><section class="section" id="config-fields-clair-trace"><div class="titlepage"><div><div><h3 class="title">6.1.9. Clair trace configuration fields</h3></div></div></div><p>
					The following trace configuration fields are available for Clair.
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45384243615440" scope="col">Field</th><th align="left" valign="top" id="idm45384243614352" scope="col">Type</th><th align="left" valign="top" id="idm45384243613264" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45384243615440">
								<p>
									<span class="strong strong"><strong>trace</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384243614352">
								<p>
									Object
								</p>
								</td><td align="left" valign="top" headers="idm45384243613264">
								<p>
									Defines distributed tracing configuration based on OpenTelemetry.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384243615440">
								<p>
									<span class="strong strong"><strong>.name</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384243614352">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384243613264">
								<p>
									The name of the application traces will belong to.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384243615440">
								<p>
									<span class="strong strong"><strong>.probability</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384243614352">
								<p>
									Integer
								</p>
								</td><td align="left" valign="top" headers="idm45384243613264">
								<p>
									The probability a trace will occur.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384243615440">
								<p>
									<span class="strong strong"><strong>.jaeger</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384243614352">
								<p>
									Object
								</p>
								</td><td align="left" valign="top" headers="idm45384243613264">
								<p>
									Defines values for Jaeger tracing.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384243615440">
								<p>
									<span class="strong strong"><strong>.jaeger.agent</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384243614352">
								<p>
									Object
								</p>
								</td><td align="left" valign="top" headers="idm45384243613264">
								<p>
									Defines values for configuring delivery to a Jaeger agent.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384243615440">
								<p>
									<span class="strong strong"><strong>.jaeger.agent.endpoint</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384243614352">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384243613264">
								<p>
									An address in the <code class="literal">&lt;host&gt;:&lt;post&gt;</code> syntax where traces can be submitted.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384243615440">
								<p>
									<span class="strong strong"><strong>.jaeger.collector</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384243614352">
								<p>
									Object
								</p>
								</td><td align="left" valign="top" headers="idm45384243613264">
								<p>
									Defines values for configuring delivery to a Jaeger collector.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384243615440">
								<p>
									<span class="strong strong"><strong>.jaeger.collector.endpoint</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384243614352">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384243613264">
								<p>
									An address in the <code class="literal">&lt;host&gt;:&lt;post&gt;</code> syntax where traces can be submitted.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384243615440">
								<p>
									<span class="strong strong"><strong>.jaeger.collector.username</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384243614352">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384243613264">
								<p>
									A Jaeger username.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384243615440">
								<p>
									<span class="strong strong"><strong>.jaeger.collector.password</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384243614352">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384243613264">
								<p>
									A Jaeger password.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384243615440">
								<p>
									<span class="strong strong"><strong>.jaeger.service_name</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384243614352">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384243613264">
								<p>
									The service name registered in Jaeger.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384243615440">
								<p>
									<span class="strong strong"><strong>.jaeger.tags</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384243614352">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384243613264">
								<p>
									Key-value pairs to provide additional metadata.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384243615440">
								<p>
									<span class="strong strong"><strong>.jaeger.buffer_max</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384243614352">
								<p>
									Integer
								</p>
								</td><td align="left" valign="top" headers="idm45384243613264">
								<p>
									The maximum number of spans that can be buffered in memory before they are sent to the Jaeger backend for storage and analysis.
								</p>
								</td></tr></tbody></table></div></section><section class="section" id="config-fields-clair-metrics"><div class="titlepage"><div><div><h3 class="title">6.1.10. Clair metrics configuration fields</h3></div></div></div><p>
					The following metrics configuration fields are available for Clair.
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45384243150272" scope="col">Field</th><th align="left" valign="top" id="idm45384243149184" scope="col">Type</th><th align="left" valign="top" id="idm45384243148096" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45384243150272">
								<p>
									<span class="strong strong"><strong>metrics</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384243149184">
								<p>
									Object
								</p>
								</td><td align="left" valign="top" headers="idm45384243148096">
								<p>
									Defines distributed tracing configuration based on OpenTelemetry.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384243150272">
								<p>
									<span class="strong strong"><strong>.name</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384243149184">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384243148096">
								<p>
									The name of the metrics in use.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384243150272">
								<p>
									<span class="strong strong"><strong>.prometheus</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384243149184">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384243148096">
								<p>
									Configuration for a Prometheus metrics exporter.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45384243150272">
								<p>
									<span class="strong strong"><strong>.prometheus.endpoint</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45384243149184">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45384243148096">
								<p>
									Defines the path where metrics are served.
								</p>
								</td></tr></tbody></table></div></section></section></section><section class="chapter" id="container-security-operator-setup"><div class="titlepage"><div><div><h1 class="title">Chapter 7. Scanning pod images with the Container Security Operator</h1></div></div></div><p>
			The <a class="link" href="https://operatorhub.io/operator/container-security-operator">Container Security Operator</a> (CSO) is an addon for the Clair security scanner available on OpenShift Container Platform and other Kubernetes platforms. With the CSO, users can scan container images associated with active pods for known vulnerabilities.
		</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
				The CSO does not work without Red Hat Quay and Clair.
			</p></div></div><p>
			The Container Security Operator (CSO) performs the following features:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					Watches containers associated with pods on either specified or all namespaces.
				</li><li class="listitem">
					Queries the container registry where the containers came from for vulnerability information (provided that an image’s registry supports image scanning, such a a Red Hat Quay registry with Clair scanning).
				</li><li class="listitem">
					Exposes vulnerabilities via the <code class="literal">ImageManifestVuln</code> object in the Kubernetes API.
				</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
				To see instructions on installing the CSO on Kubernetes, select the Install button from the <a class="link" href="https://operatorhub.io/operator/container-security-operator">Container Security OperatorHub.io</a> page.
			</p></div></div><section class="section" id="running-cso-openshift"><div class="titlepage"><div><div><h2 class="title">7.1. Downloading and running the Container Security Operator in OpenShift Container Platform</h2></div></div></div><p>
				Use the following procedure to download the Container Security Operator.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					In the following procedure, the CSO is installed in the <code class="literal">marketplace-operators</code> namespace. This allows the CSO to be used in all namespaces of your OpenShift Container Platform cluster.
				</p></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
						Go to Operators → OperatorHub (select Security) to see the available <code class="literal">Container Security</code> Operator.
					</li><li class="listitem">
						Select the <code class="literal">Container Security</code> Operator, then select <code class="literal">Install</code> to go to the Create Operator Subscription page.
					</li><li class="listitem">
						Check the settings (all namespaces and automatic approval strategy, by default), and select <code class="literal">Subscribe</code>. The <code class="literal">Container Security</code> appears after a few moments on the <code class="literal">Installed Operators</code> screen.
					</li><li class="listitem"><p class="simpara">
						Optionally, you can add custom certificates to the CSO. In this example, create a certificate named quay.crt in the current directory. Then run the following command to add the cert to the CSO (restart the Operator pod for the new certs to take effect):
					</p><pre class="screen">$ oc create secret generic container-security-operator-extra-certs --from-file=quay.crt -n openshift-operators</pre></li><li class="listitem"><p class="simpara">
						Open the OpenShift Dashboard (Home → Dashboards). A link to Image Security appears under the status section, with a listing of the number of vulnerabilities found so far. Select the link to see a Security breakdown, as shown in the following figure:
					</p><p class="simpara">
						<span class="inlinemediaobject"><img src="images/cso-dashboard.png" alt="Access SCO scanning data from OpenShift dashboard"/></span>
					</p></li><li class="listitem"><p class="simpara">
						You can do one of two things at this point to follow up on any detected vulnerabilities:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Select the link to the vulnerability. You are taken to the container registry, Red Hat Quay or other registry where the container came from, where you can see information about the vulnerability. The following figure shows an example of detected vulnerabilities from a Quay.io registry:
							</p><p class="simpara">
								<span class="inlinemediaobject"><img src="images/cso-registry-vulnerable.png" alt="The CSO points you to a registry containing the vulnerable image"/></span>
							</p></li><li class="listitem"><p class="simpara">
								Select the namespaces link to go to the ImageManifestVuln screen, where you can see the name of the selected image and all namespaces where that image is running. The following figure indicates that a particular vulnerable image is running in two namespaces:
							</p><p class="simpara">
								<span class="inlinemediaobject"><img src="images/cso-namespace-vulnerable.png" alt="View namespaces a vulnerable image is running in"/></span>
							</p></li></ul></div></li></ol></div><p>
				At this point, you know what images are vulnerable, what you need to do to fix those vulnerabilities, and every namespace that the image was run in. So you can:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Alert anyone running the image that they need to correct the vulnerability
					</li><li class="listitem">
						Stop the images from running (by deleting the deployment or other object that started the pod the image is in)
					</li></ul></div><p>
				Note that if you do delete the pod, it may take a few minutes for the vulnerability to reset on the dashboard.
			</p></section><section class="section" id="query_image_vulnerabilities_from_the_cli"><div class="titlepage"><div><div><h2 class="title">7.2. Query image vulnerabilities from the CLI</h2></div></div></div><p>
				You can query information on security from the command line. To query for detected vulnerabilities, type:
			</p><pre class="screen">$ oc get vuln --all-namespaces
NAMESPACE     NAME              AGE
default       sha256.ca90...    6m56s
skynet        sha256.ca90...    9m37s</pre><p>
				To display details for a particular vulnerability, identify one of the vulnerabilities, along with its namespace and the <code class="literal">describe</code> option. This example shows an active container whose image includes an RPM package with a vulnerability:
			</p><pre class="screen">$ oc describe vuln --namespace mynamespace sha256.ac50e3752...
Name:         sha256.ac50e3752...
Namespace:    quay-enterprise
...
Spec:
  Features:
    Name:            nss-util
    Namespace Name:  centos:7
    Version:         3.44.0-3.el7
    Versionformat:   rpm
    Vulnerabilities:
      Description: Network Security Services (NSS) is a set of libraries...</pre></section></section><div><div xml:lang="en-US" class="legalnotice" id="idm45384242138000"><h1 class="legalnotice">Legal Notice</h1><div class="para">
		Copyright <span class="trademark"/>© 2023 Red Hat, Inc.
	</div><div class="para">
		The text of and illustrations in this document are licensed by Red Hat under a Creative Commons Attribution–Share Alike 3.0 Unported license ("CC-BY-SA"). An explanation of CC-BY-SA is available at <a class="uri" href="http://creativecommons.org/licenses/by-sa/3.0/">http://creativecommons.org/licenses/by-sa/3.0/</a>. In accordance with CC-BY-SA, if you distribute this document or an adaptation of it, you must provide the URL for the original version.
	</div><div class="para">
		Red Hat, as the licensor of this document, waives the right to enforce, and agrees not to assert, Section 4d of CC-BY-SA to the fullest extent permitted by applicable law.
	</div><div class="para">
		Red Hat, Red Hat Enterprise Linux, the Shadowman logo, the Red Hat logo, JBoss, OpenShift, Fedora, the Infinity logo, and RHCE are trademarks of Red Hat, Inc., registered in the United States and other countries.
	</div><div class="para">
		<span class="trademark">Linux</span>® is the registered trademark of Linus Torvalds in the United States and other countries.
	</div><div class="para">
		<span class="trademark">Java</span>® is a registered trademark of Oracle and/or its affiliates.
	</div><div class="para">
		<span class="trademark">XFS</span>® is a trademark of Silicon Graphics International Corp. or its subsidiaries in the United States and/or other countries.
	</div><div class="para">
		<span class="trademark">MySQL</span>® is a registered trademark of MySQL AB in the United States, the European Union and other countries.
	</div><div class="para">
		<span class="trademark">Node.js</span>® is an official trademark of Joyent. Red Hat is not formally related to or endorsed by the official Joyent Node.js open source or commercial project.
	</div><div class="para">
		The <span class="trademark">OpenStack</span>® Word Mark and OpenStack logo are either registered trademarks/service marks or trademarks/service marks of the OpenStack Foundation, in the United States and other countries and are used with the OpenStack Foundation's permission. We are not affiliated with, endorsed or sponsored by the OpenStack Foundation, or the OpenStack community.
	</div><div class="para">
		All other trademarks are the property of their respective owners.
	</div></div></div></div></div></div><script type="text/javascript">
                        jQuery(document).ready(function() {
                            initSwitchery();
                            jQuery('pre[class*="language-"]').each(function(i, block){hljs.highlightBlock(block);});
                        });
                    </script></body></html>